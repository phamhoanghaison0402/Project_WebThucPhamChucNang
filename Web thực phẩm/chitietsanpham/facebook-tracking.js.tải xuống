(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
;(function (window) {

  function defaults (target, obj) {
    for (var prop in obj) target[prop] = target[prop] || obj[prop]
  }

  function getQuery (queryParams) {
    var arr = Object.keys(queryParams).map(function (k) {
      return [k, encodeURIComponent(queryParams[k])].join('=')
    })
    return '?' + arr.join('&')
  }

  function _fetch (method, url, opts, data, queryParams) {
    opts.method = method
    opts.headers = opts.headers || {}
    opts.responseAs = (opts.responseAs && ['json', 'text', 'response'].indexOf(opts.responseAs) >= 0) ? opts.responseAs : 'json'

    defaults(opts.headers, {
      'Accept': 'application/json',
      'Content-Type': 'application/json'
    })

    if (queryParams) {
      url += getQuery(queryParams)
    }

    if (data) {
        opts.body = JSON.stringify(data);
    } else {
        delete opts.body;
    }

    return fetchival.fetch(url, opts)
      .then(function (response) {
        if (response.status >= 200 && response.status < 300) {
          if(opts.responseAs=="response")
            return response
          if (response.status == 204)
            return null;
          return response[opts.responseAs]();
        }
        var err = new Error(response.statusText)
        err.response = response
        throw err
      })
  }

  function fetchival (url, opts) {
    opts = opts || {}

    var _ = function (u, o) {
      // Extend parameters with previous ones
      u = url + '/' + u
      o = o || {}
      defaults(o, opts)
      return fetchival(u, o)
    }

    _.get = function (queryParams) {
      return _fetch('GET', url, opts, null, queryParams)
    }

    _.post = function (data) {
      return _fetch('POST', url, opts, data)
    }

    _.put = function (data) {
      return _fetch('PUT', url, opts, data)
    }

    _.patch = function (data) {
      return _fetch('PATCH', url, opts, data)
    }

    _.delete = function () {
      return _fetch('DELETE', url, opts)
    }

    return _
  }

  // Expose fetch so that other polyfills can be used
  // Bind fetch to window to avoid TypeError: Illegal invocation
  fetchival.fetch = typeof fetch !== 'undefined' ? fetch.bind(window) : null

  // Support CommonJS, AMD & browser
  if (typeof exports === 'object')
    module.exports = fetchival
  else if (typeof define === 'function' && define.amd)
    define(function() { return fetchival })
  else
    window.fetchival = fetchival

})(typeof window != 'undefined' ? window : undefined);

},{}],2:[function(require,module,exports){
/*!
 * JavaScript Cookie v2.0.3
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */
(function (factory) {
	if (typeof define === 'function' && define.amd) {
		define(factory);
	} else if (typeof exports === 'object') {
		module.exports = factory();
	} else {
		var _OldCookies = window.Cookies;
		var api = window.Cookies = factory(window.jQuery);
		api.noConflict = function () {
			window.Cookies = _OldCookies;
			return api;
		};
	}
}(function () {
	function extend () {
		var i = 0;
		var result = {};
		for (; i < arguments.length; i++) {
			var attributes = arguments[ i ];
			for (var key in attributes) {
				result[key] = attributes[key];
			}
		}
		return result;
	}

	function init (converter) {
		function api (key, value, attributes) {
			var result;

			// Write

			if (arguments.length > 1) {
				attributes = extend({
					path: '/'
				}, api.defaults, attributes);

				if (typeof attributes.expires === 'number') {
					var expires = new Date();
					expires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);
					attributes.expires = expires;
				}

				try {
					result = JSON.stringify(value);
					if (/^[\{\[]/.test(result)) {
						value = result;
					}
				} catch (e) {}

				value = encodeURIComponent(String(value));
				value = value.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);

				key = encodeURIComponent(String(key));
				key = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);
				key = key.replace(/[\(\)]/g, escape);

				return (document.cookie = [
					key, '=', value,
					attributes.expires && '; expires=' + attributes.expires.toUTCString(), // use expires attribute, max-age is not supported by IE
					attributes.path    && '; path=' + attributes.path,
					attributes.domain  && '; domain=' + attributes.domain,
					attributes.secure ? '; secure' : ''
				].join(''));
			}

			// Read

			if (!key) {
				result = {};
			}

			// To prevent the for loop in the first place assign an empty array
			// in case there are no cookies at all. Also prevents odd result when
			// calling "get()"
			var cookies = document.cookie ? document.cookie.split('; ') : [];
			var rdecode = /(%[0-9A-Z]{2})+/g;
			var i = 0;

			for (; i < cookies.length; i++) {
				var parts = cookies[i].split('=');
				var name = parts[0].replace(rdecode, decodeURIComponent);
				var cookie = parts.slice(1).join('=');

				if (cookie.charAt(0) === '"') {
					cookie = cookie.slice(1, -1);
				}

				try {
					cookie = converter && converter(cookie, name) || cookie.replace(rdecode, decodeURIComponent);

					if (this.json) {
						try {
							cookie = JSON.parse(cookie);
						} catch (e) {}
					}

					if (key === name) {
						result = cookie;
						break;
					}

					if (!key) {
						result[name] = cookie;
					}
				} catch (e) {}
			}

			return result;
		}

		api.get = api.set = api;
		api.getJSON = function () {
			return api.apply({
				json: true
			}, [].slice.call(arguments));
		};
		api.defaults = {};

		api.remove = function (key, attributes) {
			api(key, '', extend(attributes, {
				expires: -1
			}));
		};

		api.withConverter = init;

		return api;
	}

	return init();
}));

},{}],3:[function(require,module,exports){
/**
 * Retrieve the Facebook Pixel ID defined by SidecarJS
 *
 * @return {undefined}
 */
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});
function getPixelId() {
  try {
    return window.sidecar.config.facebook_pixel_id;
  } catch (e) {
    return false;
  }
}

/**
 * Retrieve the Site ID defined by SidecarJS
 *
 * @return {undefined}
 */
function getSiteId() {
  try {
    return window.sidecar.config.site_id;
  } catch (e) {
    return undefined;
  }
}

/**
 * Determine if this tracking solution should fire the basic Facebook
 * events.  Eg, `Init`, `PageView`, `ViewContent`
 *
 * @return {boolean}
 */
function shouldIgnoreEvents() {
  var config = undefined;

  try {
    config = window.sidecar.config;
  } catch (e) {
    return [];
  }

  if (!!config.facebook_ignore_basic_events) {
    return ['init', 'PageView', 'ViewContent', 'Purchase'];
  }

  if (Array.isArray(config.facebook_ignore_events)) {
    return config.facebook_ignore_events;
  }

  return [];
}

/**
 * Facebook-specific configuration.  Wraps pixel ID from main config.
 *
 * NOTE: Client-specific configuration should still go in the SidecarJS config file.
 * @type {Object}
 */
var Config = {
  version: 0.3,
  expires: 90,
  siteId: getSiteId(),
  pixelId: getPixelId(),
  ignoreEvents: shouldIgnoreEvents(),
  endpoints: {
    calc: 'https://facebook.getsidecar.com/aggregate-rule',
    firehose: 'https://facebook.getsidecar.com/track.gif',
    hermes: 'https://facebook.getsidecar.com/hermes/rules'
  }
};

exports.Config = Config;
exports['default'] = Config;

},{}],4:[function(require,module,exports){
/* eslint no-shadow-restricted-names: 0, no-unused-vars: 0 */

/**
 * Main
 */
'use strict';

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _servicesEventManager = require('./services/event-manager');

var _servicesEventManager2 = _interopRequireDefault(_servicesEventManager);

var _servicesCookieMain = require('./services/cookie/main');

var _servicesCookieMain2 = _interopRequireDefault(_servicesCookieMain);

var _servicesFacebook = require('./services/facebook');

var _servicesFacebook2 = _interopRequireDefault(_servicesFacebook);

var _config = require('./config');

var _config2 = _interopRequireDefault(_config);

(function main(window, document, undefined) {
  var FB = new _servicesFacebook2['default'](window);
  window.scFBCookie = _servicesCookieMain2['default'];

  FB.init();

  _servicesEventManager2['default'].listenOnce('rules', 'loaded', function () {
    require('./observers')(window);
  });

  require('./rules')(window);
})(window, document);

},{"./config":3,"./observers":7,"./rules":16,"./services/cookie/main":23,"./services/event-manager":27,"./services/facebook":29}],5:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _baseObserver = require('./base-observer');

var _baseObserver2 = _interopRequireDefault(_baseObserver);

var _servicesCookieMain = require('../services/cookie/main');

var _servicesCookieMain2 = _interopRequireDefault(_servicesCookieMain);

var _servicesPageUtils = require('../services/page-utils');

var _servicesPageUtils2 = _interopRequireDefault(_servicesPageUtils);

/**
 * Monitors user's active time on page and increments a counter in main cookie
 */

var ActivityObserver = (function (_BaseObserver) {
  _inherits(ActivityObserver, _BaseObserver);

  /**
   * @return {undefined}
   */

  function ActivityObserver() {
    _classCallCheck(this, ActivityObserver);

    _get(Object.getPrototypeOf(ActivityObserver.prototype), 'constructor', this).call(this);
  }

  /**
   * @param {window} window - Window object
   *
   * @return {undefined}
   */

  _createClass(ActivityObserver, [{
    key: 'init',
    value: function init(window) {
      var _this = this;

      window.setInterval(function () {
        if (_servicesPageUtils2['default'].isVisible()) {
          _this.updateActiveTime();
        }
      }, 1000);
    }

    /**
     * @return {undefined}
     */
  }, {
    key: 'updateActiveTime',
    value: function updateActiveTime() {
      var _this2 = this;

      this.field = _servicesCookieMain.Fields.timeOnSite;
      this.max = _servicesCookieMain.Fields.maxTimeOnSite;

      // Incriment the cookie value if less than max setting
      if (_servicesCookieMain2['default'].getField(this.field) < this.max) {
        _servicesCookieMain2['default'].setField(this.field, function (value) {
          return ++value;
        });
      }

      // Reset cookie value to max if they have already exceeded it
      if (_servicesCookieMain2['default'].getField(this.field) > this.max) {
        _servicesCookieMain2['default'].setField(this.field, function () {
          return _this2.max;
        });
      }
    }
  }]);

  return ActivityObserver;
})(_baseObserver2['default']);

exports['default'] = ActivityObserver;
module.exports = exports['default'];

},{"../services/cookie/main":23,"../services/page-utils":30,"./base-observer":6}],6:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

var _servicesEventManager = require('../services/event-manager');

var _servicesEventManager2 = _interopRequireDefault(_servicesEventManager);

/**
 * @class
 */

var BaseObserver = (function () {

  /**
   * @return {undefined}
   *
   * @throws {TypeError} BaseObserver must be extended by another observer
   */

  function BaseObserver() {
    _classCallCheck(this, BaseObserver);

    /**
     * @type {String}
     */
    this.namespace = 'observers';

    // Fake abstract
    if (this.constructor === BaseObserver) {
      throw new TypeError('Cannot construct BaseObserver instances directly.');
    }
  }

  /**
   * @abstract
   *
   * @return {undefined}
   */

  _createClass(BaseObserver, [{
    key: 'init',
    value: function init() {}

    /**
     * @param {String} route   - Route of event
     * @param {*}      context - Data to be passed to event listener
     *
     * @return {undefined}
     */
  }, {
    key: 'trigger',
    value: function trigger(route, context) {
      _servicesEventManager2['default'].trigger(this.namespace, route, context);
    }
  }]);

  return BaseObserver;
})();

exports['default'] = BaseObserver;
module.exports = exports['default'];

},{"../services/event-manager":27}],7:[function(require,module,exports){
'use strict';

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _pageObserver = require('./page-observer');

var _pageObserver2 = _interopRequireDefault(_pageObserver);

var _productViewObserver = require('./product-view-observer');

var _productViewObserver2 = _interopRequireDefault(_productViewObserver);

var _transactionObserver = require('./transaction-observer');

var _transactionObserver2 = _interopRequireDefault(_transactionObserver);

var _sessionObserver = require('./session-observer');

var _sessionObserver2 = _interopRequireDefault(_sessionObserver);

var _activityObserver = require('./activity-observer');

var _activityObserver2 = _interopRequireDefault(_activityObserver);

var _interactionObserver = require('./interaction-observer');

var _interactionObserver2 = _interopRequireDefault(_interactionObserver);

var _servicesEventManager = require('../services/event-manager');

var _servicesEventManager2 = _interopRequireDefault(_servicesEventManager);

module.exports = function loadObservers(window) {
  var observers = [new _pageObserver2['default'](), new _sessionObserver2['default'](), new _productViewObserver2['default'](), new _transactionObserver2['default'](), new _activityObserver2['default'](), new _interactionObserver2['default']()];

  for (var i = 0, l = observers.length; i < l; i++) {
    observers[i].init(window);
  }

  _servicesEventManager2['default'].trigger('observers', 'loaded');
};

},{"../services/event-manager":27,"./activity-observer":5,"./interaction-observer":8,"./page-observer":9,"./product-view-observer":10,"./session-observer":11,"./transaction-observer":12}],8:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _baseObserver = require('./base-observer');

var _baseObserver2 = _interopRequireDefault(_baseObserver);

/**
 * Monitors user's interations with the page.  Eg. Scrolling, Clicking, etc.
 */

var InteractionObserver = (function (_BaseObserver) {
  _inherits(InteractionObserver, _BaseObserver);

  /**
   * @return {undefined}
   */

  function InteractionObserver() {
    _classCallCheck(this, InteractionObserver);

    _get(Object.getPrototypeOf(InteractionObserver.prototype), 'constructor', this).call(this);
  }

  /**
   * @param {window} window - Window object
   *
   * @return {undefined}
   */

  _createClass(InteractionObserver, [{
    key: 'init',
    value: function init(window) {
      var _this = this;

      /** @type {window} - Browser window object **/
      this.window = window;

      this.addEvent('click', function (e) {
        _this.handleClick(e);
      });
      this.addEvent('scroll', function (e) {
        _this.handleScroll(e);
      });
    }

    /**
     * @param {Event} ev - Browser event
     *
     * @return {undefined}
     */
  }, {
    key: 'handleClick',
    value: function handleClick(ev) {
      this.trigger('click', ev.target);
    }

    /**
     * @return {undefined}
     */
  }, {
    key: 'handleScroll',
    value: function handleScroll() {}

    /**
     * @param {String} type - Event descripter
     * @param {Function} fn - Callback
     *
     * @return {undefined}
     */
  }, {
    key: 'addEvent',
    value: function addEvent(type, fn) {
      try {
        this.window.addEventListener(type, fn);
      } catch (e) {
        this.window.attachEvent(type, fn);
      }
    }
  }]);

  return InteractionObserver;
})(_baseObserver2['default']);

exports['default'] = InteractionObserver;
module.exports = exports['default'];

},{"./base-observer":6}],9:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _baseObserver = require('./base-observer');

var _baseObserver2 = _interopRequireDefault(_baseObserver);

var _servicesCookieMain = require('../services/cookie/main');

var _servicesCookieMain2 = _interopRequireDefault(_servicesCookieMain);

/**
 * @class
 */

var PageObserver = (function (_BaseObserver) {
  _inherits(PageObserver, _BaseObserver);

  /**
   * @return {undefined}
   */

  function PageObserver() {
    _classCallCheck(this, PageObserver);

    _get(Object.getPrototypeOf(PageObserver.prototype), 'constructor', this).call(this);
  }

  /**
   * Increment pageview count in main cookie
   *
   * @param {window} window - Browser window object
   *
   * @return {undefined}
   */

  _createClass(PageObserver, [{
    key: 'init',
    value: function init(window) {
      this.incrementPageviews();
      this.checkReferrer(window.document);
      this.trigger('pageview');
    }

    /**
     * @return {undefined}
     */
  }, {
    key: 'incrementPageviews',
    value: function incrementPageviews() {
      var _this = this;

      this.field = _servicesCookieMain.Fields.pageviews;
      this.max = _servicesCookieMain.Fields.maxPageViews;

      // Incriment the cookie value if less than max setting
      if (_servicesCookieMain2['default'].getField(this.field) < this.max) {
        _servicesCookieMain2['default'].setField(this.field, function (value) {
          return ++value;
        });
      }

      // Reset cookie value to max if they have already exceeded it
      if (_servicesCookieMain2['default'].getField(this.field) > this.max) {
        _servicesCookieMain2['default'].setField(this.field, function () {
          return _this.max;
        });
      }

      this.trigger('update');
    }

    /**
     * @param {document} document - Browser document object
     *
     * @return {undefined}
     */
  }, {
    key: 'checkReferrer',
    value: function checkReferrer(document) {
      var ref = document.referrer;
      var hostname = document.location.hostname;

      if (!ref || ref === '') {
        return;
      }

      if (ref.indexOf(hostname) === -1) {
        this.trigger('outside-referrer', { visit: 'True' });
      }
    }
  }]);

  return PageObserver;
})(_baseObserver2['default']);

exports['default'] = PageObserver;
module.exports = exports['default'];

},{"../services/cookie/main":23,"./base-observer":6}],10:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _baseObserver = require('./base-observer');

var _baseObserver2 = _interopRequireDefault(_baseObserver);

var _servicesCookieMain = require('../services/cookie/main');

var _servicesCookieMain2 = _interopRequireDefault(_servicesCookieMain);

/**
 * @class
 */

var ProductViewObserver = (function (_BaseObserver) {
  _inherits(ProductViewObserver, _BaseObserver);

  /**
   * @return {undefined}
   */

  function ProductViewObserver() {
    _classCallCheck(this, ProductViewObserver);

    _get(Object.getPrototypeOf(ProductViewObserver.prototype), 'constructor', this).call(this);

    /**
     * Sidecar page information
     * @type {Object}
     */
    this.Sidecar = window.sidecar;
  }

  /**
   * @return {undefined}
   */

  _createClass(ProductViewObserver, [{
    key: 'init',
    value: function init() {
      var productId = this.getGroupId() || this.getProductId();
      var productType = this.getGroupId() !== undefined ? 'product_group' : 'product';

      if (productId) {
        this.updateProductViews(productId);
        this.trigger('view-content', { type: productType, id: productId });
      }
    }

    /**
     * @return {String|undefined}
     */
  }, {
    key: 'getGroupId',
    value: function getGroupId() {
      try {
        return this.Sidecar.product_info.group_id;
      } catch (e) {
        return;
      }
    }

    /**
     * @return {String|undefined}
     */
  }, {
    key: 'getProductId',
    value: function getProductId() {
      try {
        return this.Sidecar.product_info.product_id;
      } catch (e) {
        return;
      }
    }

    /**
     * @param {String} productId - Product Id from main Sidecar tracking script
     *
     * @return {undefined}
     */
  }, {
    key: 'updateProductViews',
    value: function updateProductViews(productId) {

      this.maxProducts = _servicesCookieMain.Fields.maxProducts;
      this.maxViews = _servicesCookieMain.Fields.maxProductViews;

      var productViews = _servicesCookieMain2['default'].getField(_servicesCookieMain.Fields.products) || [];
      var found = false;

      for (var i = 0, l = productViews.length; i < l; i++) {
        if (productViews[i][_servicesCookieMain.Fields.productId] === productId) {

          // Incriment the cookie value if less than max setting
          if (productViews[i][_servicesCookieMain.Fields.productViews] < this.maxViews) {
            productViews[i][_servicesCookieMain.Fields.productViews]++;
          }

          // Reset cookie value to max if they have already exceeded it
          if (productViews[i][_servicesCookieMain.Fields.productViews] > this.maxViews) {
            productViews[i][_servicesCookieMain.Fields.productViews] = this.maxViews;
          }

          found = true;
        }
      }

      if (!found && productViews.length < this.maxProducts) {
        var newProduct = {};
        newProduct[_servicesCookieMain.Fields.productId] = productId;
        newProduct[_servicesCookieMain.Fields.productViews] = 1;
        productViews.push(newProduct);
      }

      _servicesCookieMain2['default'].setField(_servicesCookieMain.Fields.products, productViews);
    }
  }]);

  return ProductViewObserver;
})(_baseObserver2['default']);

exports['default'] = ProductViewObserver;
module.exports = exports['default'];

},{"../services/cookie/main":23,"./base-observer":6}],11:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _baseObserver = require('./base-observer');

var _baseObserver2 = _interopRequireDefault(_baseObserver);

var _servicesCookieMain = require('../services/cookie/main');

var _servicesCookieMain2 = _interopRequireDefault(_servicesCookieMain);

var _servicesCookieSession = require('../services/cookie/session');

var _servicesCookieSession2 = _interopRequireDefault(_servicesCookieSession);

/**
 * @class
 */

var SessionObserver = (function (_BaseObserver) {
  _inherits(SessionObserver, _BaseObserver);

  /**
   * @return {undefined}
   */

  function SessionObserver() {
    _classCallCheck(this, SessionObserver);

    _get(Object.getPrototypeOf(SessionObserver.prototype), 'constructor', this).call(this);
  }

  /**
   * Determine if this is a new session
   * If so increment count in main cookie and create new session cookie
   *
   * @return {undefined}
   */

  _createClass(SessionObserver, [{
    key: 'init',
    value: function init() {
      var _this = this;

      if (!_servicesCookieSession2['default'].get()) {
        this.field = _servicesCookieMain.Fields.sessions;
        this.max = _servicesCookieMain.Fields.maxSessions;

        var content = {};
        content.start = Date.now();
        content[_servicesCookieMain.Fields.pageviews] = 1;
        _servicesCookieSession2['default'].set(content);

        // Incriment the cookie value if less than max setting
        if (_servicesCookieMain2['default'].getField(this.field) < this.max) {
          _servicesCookieMain2['default'].setField(this.field, function (value) {
            return ++value;
          });
        }

        // Reset cookie value to max if they have already exceeded it
        if (_servicesCookieMain2['default'].getField(this.field) > this.max) {
          _servicesCookieMain2['default'].setField(this.field, function () {
            return _this.max;
          });
        }
      } else {
        this.field = _servicesCookieMain.Fields.pageviews;
        this.max = _servicesCookieMain.Fields.maxPageViews;

        // Incriment the cookie value if less than max setting
        if (_servicesCookieSession2['default'].getField(this.field) < this.max) {
          _servicesCookieSession2['default'].setField(this.field, function (value) {
            return ++value;
          });
        }

        // Reset cookie value to max if they have already exceeded it
        if (_servicesCookieSession2['default'].getField(this.field) > this.max) {
          _servicesCookieSession2['default'].setField(this.field, function () {
            return _this.max;
          });
        }
      }
    }
  }]);

  return SessionObserver;
})(_baseObserver2['default']);

exports['default'] = SessionObserver;
module.exports = exports['default'];

},{"../services/cookie/main":23,"../services/cookie/session":24,"./base-observer":6}],12:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _baseObserver = require('./base-observer');

var _baseObserver2 = _interopRequireDefault(_baseObserver);

var _servicesCookieMain = require('../services/cookie/main');

var _servicesCookieMain2 = _interopRequireDefault(_servicesCookieMain);

/**
 * @class
 */

var TransactionObserver = (function (_BaseObserver) {
  _inherits(TransactionObserver, _BaseObserver);

  /**
   * @return {undefined}
   */

  function TransactionObserver() {
    _classCallCheck(this, TransactionObserver);

    _get(Object.getPrototypeOf(TransactionObserver.prototype), 'constructor', this).call(this);
  }

  /**
   * Determine if the user is on a transaction page
   *
   * @param {window} window - Browser window object
   *
   * @return {undefined}
   */

  _createClass(TransactionObserver, [{
    key: 'init',
    value: function init(window) {
      var Sidecar = window.sidecar;

      if (!Sidecar || !Sidecar.transactions || !Sidecar.transactions.data || !Sidecar.transactions.items) {
        return;
      }

      this.updateTransactions();
      this.trigger('purchase', Sidecar.transactions);
    }

    /**
     * @return {undefined}
     */
  }, {
    key: 'updateTransactions',
    value: function updateTransactions() {
      var _this = this;

      this.field = _servicesCookieMain.Fields.transactions;
      this.max = _servicesCookieMain.Fields.maxTransactions;

      // Incriment the cookie value if less than max setting
      if (_servicesCookieMain2['default'].getField(this.field) < this.max) {
        _servicesCookieMain2['default'].setField(this.field, function (value) {
          return ++value;
        });
      }

      // Reset cookie value to max if they have already exceeded it
      if (_servicesCookieMain2['default'].getField(this.field) > this.max) {
        _servicesCookieMain2['default'].setField(this.field, function () {
          return _this.max;
        });
      }
    }
  }]);

  return TransactionObserver;
})(_baseObserver2['default']);

exports['default'] = TransactionObserver;
module.exports = exports['default'];

},{"../services/cookie/main":23,"./base-observer":6}],13:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _baseRuleJs = require('./base-rule.js');

var _baseRuleJs2 = _interopRequireDefault(_baseRuleJs);

var _servicesCookieMain = require('../services/cookie/main');

var _servicesCookieMain2 = _interopRequireDefault(_servicesCookieMain);

/**
 * @class
 */

var AggregateRule = (function (_BaseRule) {
  _inherits(AggregateRule, _BaseRule);

  /**
   * @param {window} window - Browser window object
   *
   * @return {undefined}
   */

  function AggregateRule(window) {
    _classCallCheck(this, AggregateRule);

    _get(Object.getPrototypeOf(AggregateRule.prototype), 'constructor', this).call(this, window);

    /**
     * Threshold levels for initial model
     */
    this.thresholds = {
      low: 0.1,
      med: 0.2,
      high: 0.5
    };
  }

  /**
   * @return {undefined}
   */

  _createClass(AggregateRule, [{
    key: 'init',
    value: function init(facebook) {
      var _this = this;

      _get(Object.getPrototypeOf(AggregateRule.prototype), 'init', this).call(this, facebook);

      this.listen('update', function () {
        _this.check();
      });
    }

    /**
     * Determine if the conditions for a rule have been met
     *
     * @return {undefined}
     */
  }, {
    key: 'check',
    value: function check() {
      var _this2 = this;

      var data = _servicesCookieMain2['default'].get();

      // Temp service request
      this.calcFirehose({
        views: data[_servicesCookieMain.Fields.pageviews],
        sessions: data[_servicesCookieMain.Fields.sessions],
        transactions: data[_servicesCookieMain.Fields.transactions]
      }, function (score) {
        if (score >= _this2.thresholds.low && score <= _this2.thresholds.med) {
          _this2.track('sc_low', { trackOnce: true });
        }

        if (score > _this2.thresholds.med && score <= _this2.thresholds.high) {
          _this2.track('sc_med', { trackOnce: true });
        }

        if (score > _this2.thresholds.high) {
          _this2.track('sc_high', { trackOnce: true });
        }
      });

      // Hermes request
      this.calculateEvents({
        views: data[_servicesCookieMain.Fields.pageviews],
        sessions: data[_servicesCookieMain.Fields.sessions],
        transactions: data[_servicesCookieMain.Fields.transactions]
      }, function (response) {
        console.log(response);
        if (!response.fbEvents) {
          return;
        }

        for (var i = 0; i < response.fbEvents.length; i++) {
          if (Config.debug) {
            Console.log(response.fbEvents[i].name, ':', response.fbEvents[i].context);
          }
        }
      });
    }

    /**
     * Send custom event to Facebook and register the event as fired in the main cookie
     *
     * @param {String} eventName - Name of custom Facebook event to fire
     * @param {Object} context - Context to run the rule with
     *
     * @return {undefined}
     */
  }, {
    key: 'track',
    value: function track(eventName, context) {
      var alreadyTracked = _servicesCookieMain2['default'].getField(_servicesCookieMain.Fields.trackedEvents) || [];
      if (context.trackOnce === true && alreadyTracked.indexOf(eventName) !== -1) {
        return;
      }

      if (!this.window.fbq) {
        return;
      }

      this.window.fbq('trackCustom', eventName, context);
      alreadyTracked.push(eventName);
      _servicesCookieMain2['default'].setField(_servicesCookieMain.Fields.trackedEvents, alreadyTracked);
    }
  }]);

  return AggregateRule;
})(_baseRuleJs2['default']);

exports['default'] = AggregateRule;
module.exports = exports['default'];

},{"../services/cookie/main":23,"./base-rule.js":14}],14:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

var _servicesEventManager = require('../services/event-manager');

var _servicesEventManager2 = _interopRequireDefault(_servicesEventManager);

var _servicesCookieSidecarKey = require('../services/cookie/sidecar-key');

var _servicesCookieSidecarKey2 = _interopRequireDefault(_servicesCookieSidecarKey);

var _servicesCookieMain = require('../services/cookie/main');

var _servicesCookieMain2 = _interopRequireDefault(_servicesCookieMain);

var _servicesFacebook = require('../services/facebook');

var _servicesFacebook2 = _interopRequireDefault(_servicesFacebook);

var _config = require('../config');

var _config2 = _interopRequireDefault(_config);

var _servicesDebug = require('../services/debug');

var _servicesDebug2 = _interopRequireDefault(_servicesDebug);

var fetchival = require('fetchival');

/**
 * Extendable base class for rules.
 *
 * @class
 */

var BaseRule = (function () {

  /**
   * @param {window} window - Browser window object
   *
   * @return {undefined}
   *
   * @throws {TypeError}
   */

  function BaseRule(window) {
    _classCallCheck(this, BaseRule);

    /** @type {Object} */
    this.window = window;

    this.debug = _servicesDebug2['default'];

    /** @type {String} */
    this.namespace = 'rules';

    /** @type {String} */
    this.producerNamespace = 'observers';

    /** @type {Fetchival} */
    this.calc = fetchival(_config2['default'].endpoints.calc, { mode: 'cors' });

    /** @type {Fetchival} */
    this.firehose = fetchival(_config2['default'].endpoints.firehose, { mode: 'cors' });

    /** @type {Fetchival} */
    this.hermes = fetchival(_config2['default'].endpoints.hermes, { mode: 'cors' });

    // Fake abstract
    // Fake abstract
    if (this.constructor === BaseRule) {
      throw new TypeError('Cannot construct BaseRule instances directly.');
    }
  }

  /**
   * @return {undefined}
   */

  _createClass(BaseRule, [{
    key: 'init',
    value: function init(facebook) {
      this.facebook = facebook;

      var className = this.constructor.toString().match(/function (\w*)/)[1];

      this.debug('Initialized: ' + className);
    }

    /**
     * Register a callback to fire on a listener every time it is emitted
     *
     * @param {String} route - Route identifier
     * @param {Function} callback - Function to be called
     *
     * @return {undefined}
     */
  }, {
    key: 'listen',
    value: function listen(route, callback) {
      _servicesEventManager2['default'].listen(this.producerNamespace, route, callback);
    }

    /**
     * Register a callback to fire on a listener once
     *
     * @param {String} route - Route identifier
     * @param {Function} callback - Function to be called
     *
     * @return {undefined}
     */
  }, {
    key: 'listenOnce',
    value: function listenOnce(route, callback) {
      _servicesEventManager2['default'].listenOnce(this.producerNamespace, route, callback);
    }
  }, {
    key: 'calculateEvents',
    value: function calculateEvents(data) {
      if (!_config2['default'].siteId) {
        return;
      }

      data.siteId = _config2['default'].siteId;
      data.scSessionId = _servicesCookieSidecarKey2['default'].get();
      data.views = _servicesCookieMain2['default'].getField('p');
      data.transactions = _servicesCookieMain2['default'].getField('tr');
      data.sessions = _servicesCookieMain2['default'].getField('s');
      this.hermes.get(data).then(function (response) {
        if (!response.events) {
          return;
        }

        response.events.map(function (ev) {
          if (!ev.type === 'facebook') {
            return;
          }

          _servicesFacebook2['default'].track(ev.value, true, ev.context);
        });
      })['catch'](function () {});
    }

    /**
     * Send tracking information back to Sidecar firehose
     *
     * @param {*} data - Data to be sent to the firehose server
     *
     * @return {undefined}
     */
  }, {
    key: 'trackFirehose',
    value: function trackFirehose(data) {
      if (_config2['default'].siteId) {
        data.siteId = _config2['default'].siteId;
        data.scSessionId = _servicesCookieSidecarKey2['default'].get();

        return data;
      }
    }

    /**
     * Send user state to firehose and handle the response
     *
     * @param {Object} data - Data to be sent to the firehose server
     * @param {Function} cb - Callback
     *
     * @return {Number|String}
     */
  }, {
    key: 'calcFirehose',
    value: function calcFirehose(data, cb) {
      if (_config2['default'].siteId) {
        data.siteId = _config2['default'].siteId;
        this.calc.get(data).then(function (response) {
          cb(response);
        })['catch'](function () {});
      }
    }
  }]);

  return BaseRule;
})();

exports['default'] = BaseRule;
module.exports = exports['default'];

},{"../config":3,"../services/cookie/main":23,"../services/cookie/sidecar-key":25,"../services/debug":26,"../services/event-manager":27,"../services/facebook":29,"fetchival":1}],15:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _baseRule = require('./base-rule');

var _baseRule2 = _interopRequireDefault(_baseRule);

/**
 * Sends information about click events to Sidecar firehose service.
 *
 * @class
 */

var ClickRule = (function (_BaseRule) {
  _inherits(ClickRule, _BaseRule);

  /**
   * @param {window} window - Browser window object
   *
   * @return {undefined}
   */

  function ClickRule(window) {
    _classCallCheck(this, ClickRule);

    _get(Object.getPrototypeOf(ClickRule.prototype), 'constructor', this).call(this, window);
  }

  /**
   * @return {undefined}
   */

  _createClass(ClickRule, [{
    key: 'init',
    value: function init(facebook) {
      var _this = this;

      _get(Object.getPrototypeOf(ClickRule.prototype), 'init', this).call(this, facebook);

      this.listen('click', function (context) {
        var target = context.tagName;
        target = _this.addTargetDetails(target, context.id, '#');
        target = _this.addTargetDetails(target, context.className, '.');
        _this.trackFirehose({
          event: 'click',
          details: target
        });
      });
    }

    /**
     * @param {String} target - Current target string
     * @param {String} detail - Class or Id name of target.  If any
     * @param {String} prefix - Descriptive prefix for detail.  Eg # or .
     *
     * @return {String}
     */
  }, {
    key: 'addTargetDetails',
    value: function addTargetDetails(target, detail, prefix) {
      if (!detail) {
        return target;
      }
      return target + prefix + detail;
    }
  }]);

  return ClickRule;
})(_baseRule2['default']);

exports['default'] = ClickRule;
module.exports = exports['default'];

},{"./base-rule":14}],16:[function(require,module,exports){
'use strict';

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _servicesFacebook = require('../services/facebook');

var _servicesFacebook2 = _interopRequireDefault(_servicesFacebook);

var _aggregateRuleJs = require('./aggregate-rule.js');

var _aggregateRuleJs2 = _interopRequireDefault(_aggregateRuleJs);

var _outsideReferrerRuleJs = require('./outside-referrer-rule.js');

var _outsideReferrerRuleJs2 = _interopRequireDefault(_outsideReferrerRuleJs);

var _pageviewRuleJs = require('./pageview-rule.js');

var _pageviewRuleJs2 = _interopRequireDefault(_pageviewRuleJs);

var _viewContentRuleJs = require('./view-content-rule.js');

var _viewContentRuleJs2 = _interopRequireDefault(_viewContentRuleJs);

var _purchaseRuleJs = require('./purchase-rule.js');

var _purchaseRuleJs2 = _interopRequireDefault(_purchaseRuleJs);

var _productRepurchaserRuleJs = require('./product-repurchaser-rule.js');

var _productRepurchaserRuleJs2 = _interopRequireDefault(_productRepurchaserRuleJs);

var _clickRuleJs = require('./click-rule.js');

var _clickRuleJs2 = _interopRequireDefault(_clickRuleJs);

var _servicesEventManager = require('../services/event-manager');

var _servicesEventManager2 = _interopRequireDefault(_servicesEventManager);

module.exports = function loadRules(window) {
  var facebook = new _servicesFacebook2['default'](window);

  var rules = [new _aggregateRuleJs2['default'](window), new _outsideReferrerRuleJs2['default'](window), new _viewContentRuleJs2['default'](window), new _pageviewRuleJs2['default'](window), new _purchaseRuleJs2['default'](window), new _productRepurchaserRuleJs2['default'](window), new _clickRuleJs2['default'](window)];

  for (var i = 0, l = rules.length; i < l; i++) {
    rules[i].init(facebook);
  }

  _servicesEventManager2['default'].trigger('rules', 'loaded');
};

},{"../services/event-manager":27,"../services/facebook":29,"./aggregate-rule.js":13,"./click-rule.js":15,"./outside-referrer-rule.js":17,"./pageview-rule.js":18,"./product-repurchaser-rule.js":19,"./purchase-rule.js":20,"./view-content-rule.js":21}],17:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _baseRuleJs = require('./base-rule.js');

var _baseRuleJs2 = _interopRequireDefault(_baseRuleJs);

var _config = require('../config');

var _config2 = _interopRequireDefault(_config);

/**
 * @class
 */

var OutsideReferrerRule = (function (_BaseRule) {
  _inherits(OutsideReferrerRule, _BaseRule);

  /**
   * @param {window} window - Browser window object
   *
   * @return {undefined}
   */

  function OutsideReferrerRule(window) {
    _classCallCheck(this, OutsideReferrerRule);

    _get(Object.getPrototypeOf(OutsideReferrerRule.prototype), 'constructor', this).call(this, window);
  }

  /**
   * @return {undefined}
   */

  _createClass(OutsideReferrerRule, [{
    key: 'init',
    value: function init(facebook) {
      var _this = this;

      _get(Object.getPrototypeOf(OutsideReferrerRule.prototype), 'init', this).call(this, facebook);

      this.listen('outside-referrer', function (context) {
        _this.facebook.track('OutsideReferrer', true, context);
      });
    }
  }]);

  return OutsideReferrerRule;
})(_baseRuleJs2['default']);

exports['default'] = OutsideReferrerRule;
module.exports = exports['default'];

},{"../config":3,"./base-rule.js":14}],18:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _baseRuleJs = require('./base-rule.js');

var _baseRuleJs2 = _interopRequireDefault(_baseRuleJs);

/**
 * @class
 */

var PageviewRule = (function (_BaseRule) {
  _inherits(PageviewRule, _BaseRule);

  /**
   * @param {window} window - Browser window object
   * @return {undefined}
   */

  function PageviewRule(window) {
    _classCallCheck(this, PageviewRule);

    _get(Object.getPrototypeOf(PageviewRule.prototype), 'constructor', this).call(this, window);
  }

  /**
   * @return {undefined}
   */

  _createClass(PageviewRule, [{
    key: 'init',
    value: function init(facebook) {
      var _this = this;

      _get(Object.getPrototypeOf(PageviewRule.prototype), 'init', this).call(this, facebook);

      this.listen('pageview', function (context) {
        _this.facebook.track('PageView');
      });
    }
  }]);

  return PageviewRule;
})(_baseRuleJs2['default']);

exports['default'] = PageviewRule;
module.exports = exports['default'];

},{"./base-rule.js":14}],19:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _baseRuleJs = require('./base-rule.js');

var _baseRuleJs2 = _interopRequireDefault(_baseRuleJs);

var _config = require('../config');

var _config2 = _interopRequireDefault(_config);

var _servicesCookieSession = require('../services/cookie/session');

var _servicesCookieSession2 = _interopRequireDefault(_servicesCookieSession);

/**
 * @class
 */

var ProductRepurchaserRule = (function (_BaseRule) {
  _inherits(ProductRepurchaserRule, _BaseRule);

  /**
   * @param {window} window - Browser window object
   *
   * @return {undefined}
   */

  function ProductRepurchaserRule(window) {
    _classCallCheck(this, ProductRepurchaserRule);

    _get(Object.getPrototypeOf(ProductRepurchaserRule.prototype), 'constructor', this).call(this, window);
  }

  /**
   * @return {undefined}
   */

  _createClass(ProductRepurchaserRule, [{
    key: 'init',
    value: function init(facebook) {
      var _this = this;

      _get(Object.getPrototypeOf(ProductRepurchaserRule.prototype), 'init', this).call(this, facebook);

      this.listen('purchase', function (context) {
        if (_config2['default'].pixelId) {
          var products = context.items.map(function (p) {
            return p.product_id + '|' + p.unit_price + '|' + p.quantity;
          }).join('||');
          var sessionInfo = _servicesCookieSession2['default'].get();
          _this.calculateEvents(_extends({ products: products }, sessionInfo));
        }
      });
    }
  }]);

  return ProductRepurchaserRule;
})(_baseRuleJs2['default']);

exports['default'] = ProductRepurchaserRule;
module.exports = exports['default'];

},{"../config":3,"../services/cookie/session":24,"./base-rule.js":14}],20:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _baseRuleJs = require('./base-rule.js');

var _baseRuleJs2 = _interopRequireDefault(_baseRuleJs);

var _config = require('../config');

var _config2 = _interopRequireDefault(_config);

/**
 * @class
 */

var PurchaseRule = (function (_BaseRule) {
  _inherits(PurchaseRule, _BaseRule);

  /**
   * @param {window} window - Browser window object
   *
   * @return {undefined}
   */

  function PurchaseRule(window) {
    _classCallCheck(this, PurchaseRule);

    _get(Object.getPrototypeOf(PurchaseRule.prototype), 'constructor', this).call(this, window);
  }

  /**
   * @return {undefined}
   */

  _createClass(PurchaseRule, [{
    key: 'init',
    value: function init(facebook) {
      var _this = this;

      _get(Object.getPrototypeOf(PurchaseRule.prototype), 'init', this).call(this, facebook);

      this.listen('purchase', function (context) {
        if (!context.items || !context.data) {
          return;
        }

        var productIds = [];

        for (var i = 0, l = context.items.length; i < l; i++) {
          productIds.push(context.items[i].product_id);
        }

        var total = context.data.total || 0;
        var shipping = context.data.shipping || 0;

        _this.facebook.track('Purchase', false, {
          value: parseFloat(total) - parseFloat(shipping),
          currency: 'USD',
          content_ids: productIds,
          content_type: 'product'
        });
      });
    }
  }]);

  return PurchaseRule;
})(_baseRuleJs2['default']);

exports['default'] = PurchaseRule;
module.exports = exports['default'];

},{"../config":3,"./base-rule.js":14}],21:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _baseRuleJs = require('./base-rule.js');

var _baseRuleJs2 = _interopRequireDefault(_baseRuleJs);

var _servicesFacebook = require('../services/facebook');

var _servicesFacebook2 = _interopRequireDefault(_servicesFacebook);

/**
 * @class
 */

var ViewContentRule = (function (_BaseRule) {
  _inherits(ViewContentRule, _BaseRule);

  /**
   * @param {window} window - Browser window object
   * @return {undefined}
   */

  function ViewContentRule(window) {
    _classCallCheck(this, ViewContentRule);

    _get(Object.getPrototypeOf(ViewContentRule.prototype), 'constructor', this).call(this, window);
  }

  /**
   * @return {undefined}
   */

  _createClass(ViewContentRule, [{
    key: 'init',
    value: function init(facebook) {
      var _this = this;

      _get(Object.getPrototypeOf(ViewContentRule.prototype), 'init', this).call(this, facebook);

      this.listen('view-content', function (context) {
        _this.facebook.track('ViewContent', false, {
          content_ids: context.id,
          content_type: context.type
        });
      });
    }
  }]);

  return ViewContentRule;
})(_baseRuleJs2['default']);

exports['default'] = ViewContentRule;
module.exports = exports['default'];

},{"../services/facebook":29,"./base-rule.js":14}],22:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

var _jsCookie = require('js-cookie');

var jsCookie = _interopRequireWildcard(_jsCookie);

/**
 * Abstract Cookie object
 * @class BaseCookie
 * @author Rob Kaufmann <rob@getsidecar.com>
 */

var BaseCookie = (function () {
  /**
   * @param {String} name - Cookie name
   *
   * @return {undefined}
   */

  function BaseCookie(name) {
    _classCallCheck(this, BaseCookie);

    // Fake abstract
    if (this.constructor === BaseCookie) {
      throw new TypeError('Cannot construct BaseCookie instances directly.');
    }

    /**
     * Machine name for cookie
     * @type {String}
     */
    this.name = name;
  }

  /**
   * Return the contents of the cookie in JSON
   *
   * @returns {Object}
   */

  _createClass(BaseCookie, [{
    key: 'get',
    value: function get() {
      return jsCookie.getJSON(this.name);
    }

    /**
     * Return the value of a field in the cookie
     *
     * @param {Array} fields - Array of desired fields in hierarchical order
     *
     * @return {*}
     */
  }, {
    key: 'getField',
    value: function getField(fields) {
      if (fields.constructor !== Array) {
        fields = [fields];
      }
      return this._getField(fields, this.get());
    }

    /**
     * Recurse through provided data and return requested value.
     *
     * @param {Array} fields - Array of desired fields in hierarchical order
     * @param {*}     data   - Object to be searched or value to be returned
     * if fields is empty
     *
     * @return {*}
     *
     * @private
     */
  }, {
    key: '_getField',
    value: function _getField(fields, data) {
      if (!fields || fields.length === 0) {
        return data;
      }

      if (typeof data !== 'object') {
        return false;
      }
      var field = fields.shift();
      return this._getField(fields, data[field]);
    }

    /**
     * Content of cookie
     *
     * @param {*} value - Value to be assigned to cookie
     *
     * @return {String} - Serialized cookie
     */
  }, {
    key: 'set',
    value: function set(value) {
      return jsCookie.set(this.name, value, this.options);
    }

    /**
     * Updates a field in the cookie.
     * The modifier can either be a function to be applied to the
     * field or a value.
     *
     * @param {Array} fields   - Array of desired fields in heirarchical order
     * @param {*}     modifier - New value for given field.  If a function is
     * passed then it is applied to the current value and the result is saved
     *
     * @return {undefined}
     */
  }, {
    key: 'setField',
    value: function setField(fields, modifier) {
      if (!this.get()) {
        this.init();
      }

      if (fields.constructor !== Array) {
        fields = [fields];
      }

      var result = this._setField(fields, modifier, jsCookie.getJSON(this.name));
      this.set(result);
    }

    /**
     * Recurse through data and update the field
     *
     * @param {Array} fields   - Array of desired fields in heirarchical order
     * @param {*}     modifier - New value for given field.  If a function is
     * passed then it is applied to the current value and the result is saved
     * @param {Object} data    - Data object to be walked for requested fields
     *
     * @return {*}
     *
     * @private
     */
  }, {
    key: '_setField',
    value: function _setField(fields, modifier, data) {
      if (!fields || fields.length === 0) {
        return this._updateValue(data, modifier);
      }

      if (typeof data === 'undefined') {
        data = {};
      }

      var field = fields.shift();
      data[field] = this._setField(fields, modifier, data[field]);
      return data;
    }

    /**
     * Returns new value for a field in the cookie.
     * If modifier is a function it applied it to data.
     * Otherwise it returns the modifier.
     *
     * @param {*} value    - Current value from cookie
     * @param {*} modifier - Either a new value to be stored in the cookie or
     * a function to be applied to current function
     *
     * @return {*}
     *
     * @private
     */
  }, {
    key: '_updateValue',
    value: function _updateValue(value, modifier) {
      if (typeof modifier === 'function') {
        return modifier(value);
      }
      return modifier;
    }

    /**
     * Delete cookie and reinitialize
     *
     * @return {undefined}
     */
  }, {
    key: 'reset',
    value: function reset() {
      this.remove();
      this.init();
    }

    /**
     * Delete cookie
     *
     * @return {undefined}
     */
  }, {
    key: 'remove',
    value: function remove() {
      jsCookie.remove(this.name);
    }
  }]);

  return BaseCookie;
})();

exports['default'] = BaseCookie;
module.exports = exports['default'];

},{"js-cookie":2}],23:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _base = require('./base');

var _base2 = _interopRequireDefault(_base);

var _config = require('../../config');

var _config2 = _interopRequireDefault(_config);

/**
 * @type {String}
 * @constant
 * @default
 */
var Name = 'sc_fb';

exports.Name = Name;
/**
 * @constant
 * @default
 */
var Fields = {
  // Util
  version: 'v',

  // General
  timeOnSite: 't',
  maxTimeOnSite: 10000,
  pageviews: 'p',
  maxPageViews: 100,
  sessions: 's',
  maxSessions: 100,

  // Brands
  brands: 'b',

  // Products
  products: 'pv',
  maxProducts: 25,
  productViews: 'v',
  maxProductViews: 100,
  productId: 'i',

  // Transactions
  transactions: 'tr',
  maxTransactions: 100,

  // Events
  trackedEvents: 'e'
};

exports.Fields = Fields;
/**
 * Cookie used to store local user state.
 *
 * @class
 */

var MainCookie = (function (_BaseCookie) {
  _inherits(MainCookie, _BaseCookie);

  /**
   * @return {undefined}
   */

  function MainCookie() {
    _classCallCheck(this, MainCookie);

    _get(Object.getPrototypeOf(MainCookie.prototype), 'constructor', this).call(this, Name);

    /** @type {Object} Cookie options */
    this.options = { expires: _config2['default'].expires };

    if (!this.get()) {
      this.init();
    }
  }

  /**
   * Initialize the cookie with default values
   *
   * @return {undefined}
   */

  _createClass(MainCookie, [{
    key: 'init',
    value: function init() {
      var content = {};
      content[Fields.version] = _config2['default'].version;
      content[Fields.timeOnSite] = 0;
      content[Fields.pageviews] = 0;
      content[Fields.sessions] = 0;
      content[Fields.brands] = [];
      content[Fields.products] = [];
      content[Fields.transactions] = 0;
      content[Fields.trackedEvents] = [];

      this.set(content);
    }
  }]);

  return MainCookie;
})(_base2['default']);

exports['default'] = new MainCookie();

},{"../../config":3,"./base":22}],24:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _base = require('./base');

var _base2 = _interopRequireDefault(_base);

/** @type {String} Session cookie name */
var Name = 'sc_fb_session';

exports.Name = Name;
/** @type {Object} Mapping of cookie fields */
var Fields = {
  created: 'c'
};

exports.Fields = Fields;
/**
 * Cookie used to keep track of user sessions.
 *
 * @class
 */

var SessionCookie = (function (_BaseCookie) {
  _inherits(SessionCookie, _BaseCookie);

  /**
   * @override
   *
   * @return {undefined}
   */

  function SessionCookie() {
    _classCallCheck(this, SessionCookie);

    _get(Object.getPrototypeOf(SessionCookie.prototype), 'constructor', this).call(this, Name);
  }

  return SessionCookie;
})(_base2['default']);

exports['default'] = new SessionCookie();

},{"./base":22}],25:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _base = require('./base');

var _base2 = _interopRequireDefault(_base);

/** @type {String} Session cookie name */
var Name = '_sckey';

exports.Name = Name;
/**
 * Cookie used by SidecarJS to track sessions.
 *
 * @class
 */

var SidecarKeyCookie = (function (_BaseCookie) {
  _inherits(SidecarKeyCookie, _BaseCookie);

  /**
   * @override
   *
   * @return {undefined}
   */

  function SidecarKeyCookie() {
    _classCallCheck(this, SidecarKeyCookie);

    _get(Object.getPrototypeOf(SidecarKeyCookie.prototype), 'constructor', this).call(this, Name);
  }

  return SidecarKeyCookie;
})(_base2['default']);

exports['default'] = new SidecarKeyCookie();

},{"./base":22}],26:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});
exports['default'] = debug;

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _config = require('../config');

var _config2 = _interopRequireDefault(_config);

function debug(message) {
  if (!!_config2['default'].debug) {
    console.log(message);
  }
}

;
module.exports = exports['default'];

},{"../config":3}],27:[function(require,module,exports){
/* eslint no-loop-func: 0 */

/**
 * @class
 */
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

var EventManager = (function () {
  /**
   * @return {undefined}
   */

  function EventManager() {
    _classCallCheck(this, EventManager);

    /** @type {String} */
    this.defaultRoute = 'default';

    /** @type {Object} */
    this.listeners = {};
  }

  /**
   * @param {Array}    listeners - Registered listeners
   * @param {Function} target    - Function to search for
   *
   * @return {Function|undefined}
   */

  _createClass(EventManager, [{
    key: 'findListener',
    value: function findListener(listeners, target) {
      if (!listeners || !target) {
        return;
      }

      for (var i = 0, l = listeners.length; i < l; i++) {
        if (listeners[i].callback === target) {
          return listeners[i];
        }
      }
    }

    /**
     * @param {String}   namespace - Namespace identifier for event
     * @param {String}   route     - Route identifier for event
     * @param {Function} callback  - Function to be called when event is emitted
     * @param {Boolean}  once      - Whether or not the callback should only be triggered once
     *
     * @return {undefined}
     */
  }, {
    key: 'listen',
    value: function listen(namespace, route, callback, once) {
      once = once || false;

      // Verify all requirements are met
      if (!namespace || !callback) {
        throw Error('Namespace and callback are required.');
      }
      route = route || this.defaultRoute;

      if (!this.listeners[namespace]) {
        this.listeners[namespace] = {};
      }

      if (!this.listeners[namespace][route]) {
        this.listeners[namespace][route] = [];
      }

      // Exit if listener is already registered
      if (this.findListener(this.listeners[namespace][route], callback)) {
        return;
      }

      this.listeners[namespace][route].push({ callback: callback, once: once });
    }

    /**
     * @param {String}   namespace - Namespace identifier for event
     * @param {String}   route     - Route identifier for event
     * @param {Function} callback  - Function to be called when event is emitted
     *
     * @return {undefined}
     */
  }, {
    key: 'listenOnce',
    value: function listenOnce(namespace, route, callback) {
      this.listen(namespace, route, callback, true);
    }

    /**
     * @param {String}   namespace - Namespace identifier for event
     * @param {String}   route     - Route identifier for event
     * @param {Function} target    - Function to be removed from listeners array
     *
     * @return {undefined}
     */
  }, {
    key: 'remove',
    value: function remove(namespace, route, target) {
      if (!this.listeners[namespace] || !this.listeners[namespace][route]) {
        return;
      }

      var listeners = this.listeners[namespace][route];
      var updatedListeners = [];

      for (var i = 0, l = listeners.length; i < l; i++) {
        if (listeners[i].callback !== target) {
          updatedListeners.push(listeners[i]);
        }
      }
      this.listeners[namespace][route] = updatedListeners;
    }

    /**
     * @param {String} namespace - Namespace identifier for event
     * @param {String} route     - Route identifier for event
     * @param {*}      context   - Data to be passed to callback
     *
     * @return {undefined}
     */
  }, {
    key: 'trigger',
    value: function trigger(namespace, route, context) {
      var _this = this;

      route = route || this.defaultRoute;

      // Bug out if no valid listeners
      if (!this.listeners[namespace] || !this.listeners[namespace][route]) {
        return;
      }

      var targetListeners = this.listeners[namespace][route];
      var removeListener = this.remove;

      for (var i = 0, l = targetListeners.length; i < l; i++) {
        (function (listeners, idx) {
          var ref = setTimeout(function () {
            try {
              listeners[idx].callback(context);
              if (listeners[idx].once === true) {
                removeListener.call(_this, namespace, route, listeners[idx].callback);
              }
              clearTimeout(ref);
            } catch (e) {
              return;
            }
          });
        })(targetListeners, i);
      }
    }
  }]);

  return EventManager;
})();

exports['default'] = new EventManager();
module.exports = exports['default'];

},{}],28:[function(require,module,exports){
/* eslint-disable */
'use strict';

module.exports = function (window) {
  return !(function (f, b, e, v, n, t, s) {
    if (f.fbq) return;n = f.fbq = function () {
      n.callMethod ? n.callMethod.apply(n, arguments) : n.queue.push(arguments);
    };if (!f._fbq) f._fbq = n;
    n.push = n;n.loaded = !0;n.version = '2.0';n.queue = [];t = b.createElement(e);t.async = !0;
    t.src = v;s = b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t, s);
  })(window, document, 'script', 'https://connect.facebook.net/en_US/fbevents.js');
};
/* eslint-enable */

},{}],29:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

var _config = require('../../config');

var _config2 = _interopRequireDefault(_config);

var _debug = require('../debug');

var _debug2 = _interopRequireDefault(_debug);

/**
 * @class
 */

var Facebook = (function () {

  /**
   * @param {window} window - Browser window object
   *
   * @return {undefined}
   */

  function Facebook(window) {
    _classCallCheck(this, Facebook);

    /** @type {window} - Browser window object **/
    this.window = window;
  }

  /**
   * Initialize Facebook service
   *
   * @return {undefined}
   */

  _createClass(Facebook, [{
    key: 'init',
    value: function init() {
      (0, _debug2['default'])('Init Facebook');
      if (!_config2['default'].pixelId) {
        return;
      }

      this.load();

      if (_config2['default'].ignoreEvents.indexOf('init') === -1) {
        (0, _debug2['default'])('Sending Facebook init for pixel: ' + _config2['default'].pixelId);
        this.window.fbq('init', _config2['default'].pixelId);
      }
    }

    /**
     * Load the Facebook tracking code
     *
     * @return {undefined}
     */
  }, {
    key: 'load',
    value: function load() {
      if (!this.window.fbq) {
        require('./fbq')(this.window);
      }
    }

    /**
     * Send tracking information to Facebook
     *
     * Note: Basic Facebooke events will not be sent if `ignoreBasicEvents`
     * is set in the configuration.
     *
     * @param {String} name    - Event name
     * @param {Boolean} custom - Whether or not this is a custom Facebook event
     * @param {Object} context - Event context
     *
     * @return {undefined}
     */
  }, {
    key: 'track',
    value: function track(name) {
      var custom = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
      var context = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];

      if (!_config2['default'].pixelId || _config2['default'].ignoreEvents.indexOf(name) !== -1) {

        (0, _debug2['default'])('Skipping Tracking: ' + name);
        return;
      }

      (0, _debug2['default'])('Tracking: ' + name);

      var type = custom ? 'trackCustom' : 'track';
      this.window.fbq(type, name, context);
    }
  }]);

  return Facebook;
})();

exports['default'] = Facebook;
module.exports = exports['default'];

},{"../../config":3,"../debug":26,"./fbq":28}],30:[function(require,module,exports){
/**
 * @class
 */
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

var PageUtils = (function () {

  /**
   * @param {document} document - Browser document object
   *
   * @return {undefined}
   */

  function PageUtils(document) {
    _classCallCheck(this, PageUtils);

    /**
     * @type {document} Browser document object
     */
    this.document = document;

    /**
     * @type {String} Name of document property based on detected browser
     */
    this.hidden = null;

    /**
     * @type {String} Name of event signaling a change in visiblity based on detected browser
     */
    this.visibilityChange = null;

    // Opera 12.10 and Firefox 18
    if (typeof document.hidden !== 'undefined') {
      this.hidden = 'hidden';
      this.visibilityChange = 'visibilitychange';
      // Firefox 18+
    } else if (typeof document.mozHidden !== 'undefined') {
        this.hidden = 'mozHidden';
        this.visibilityChange = 'mozvisibilitychange';
        // IE
      } else if (typeof document.msHidden !== 'undefined') {
          this.hidden = 'msHidden';
          this.visibilityChange = 'msvisibilitychange';
          // Safari and Chrome
        } else if (typeof document.webkitHidden !== 'undefined') {
            this.hidden = 'webkitHidden';
            this.visibilityChange = 'webkitvisibilitychange';
          }
  }

  /**
   * @return {Boolean}
   */

  _createClass(PageUtils, [{
    key: 'isVisible',
    value: function isVisible() {
      return !this.document[this.hidden];
    }
  }]);

  return PageUtils;
})();

exports['default'] = new PageUtils(window.document);
module.exports = exports['default'];

},{}]},{},[4])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvZmV0Y2hpdmFsL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2pzLWNvb2tpZS9zcmMvanMuY29va2llLmpzIiwiL1VzZXJzL3JvYm90dG8vUHJvamVjdHMvV29yay9TaWRlY2FyL2ZhY2Vib29rLXRyYWNraW5nL3NyYy9jb25maWcvaW5kZXguanMiLCIvVXNlcnMvcm9ib3R0by9Qcm9qZWN0cy9Xb3JrL1NpZGVjYXIvZmFjZWJvb2stdHJhY2tpbmcvc3JjL21haW4uanMiLCIvVXNlcnMvcm9ib3R0by9Qcm9qZWN0cy9Xb3JrL1NpZGVjYXIvZmFjZWJvb2stdHJhY2tpbmcvc3JjL29ic2VydmVycy9hY3Rpdml0eS1vYnNlcnZlci5qcyIsIi9Vc2Vycy9yb2JvdHRvL1Byb2plY3RzL1dvcmsvU2lkZWNhci9mYWNlYm9vay10cmFja2luZy9zcmMvb2JzZXJ2ZXJzL2Jhc2Utb2JzZXJ2ZXIuanMiLCIvVXNlcnMvcm9ib3R0by9Qcm9qZWN0cy9Xb3JrL1NpZGVjYXIvZmFjZWJvb2stdHJhY2tpbmcvc3JjL29ic2VydmVycy9pbmRleC5qcyIsIi9Vc2Vycy9yb2JvdHRvL1Byb2plY3RzL1dvcmsvU2lkZWNhci9mYWNlYm9vay10cmFja2luZy9zcmMvb2JzZXJ2ZXJzL2ludGVyYWN0aW9uLW9ic2VydmVyLmpzIiwiL1VzZXJzL3JvYm90dG8vUHJvamVjdHMvV29yay9TaWRlY2FyL2ZhY2Vib29rLXRyYWNraW5nL3NyYy9vYnNlcnZlcnMvcGFnZS1vYnNlcnZlci5qcyIsIi9Vc2Vycy9yb2JvdHRvL1Byb2plY3RzL1dvcmsvU2lkZWNhci9mYWNlYm9vay10cmFja2luZy9zcmMvb2JzZXJ2ZXJzL3Byb2R1Y3Qtdmlldy1vYnNlcnZlci5qcyIsIi9Vc2Vycy9yb2JvdHRvL1Byb2plY3RzL1dvcmsvU2lkZWNhci9mYWNlYm9vay10cmFja2luZy9zcmMvb2JzZXJ2ZXJzL3Nlc3Npb24tb2JzZXJ2ZXIuanMiLCIvVXNlcnMvcm9ib3R0by9Qcm9qZWN0cy9Xb3JrL1NpZGVjYXIvZmFjZWJvb2stdHJhY2tpbmcvc3JjL29ic2VydmVycy90cmFuc2FjdGlvbi1vYnNlcnZlci5qcyIsIi9Vc2Vycy9yb2JvdHRvL1Byb2plY3RzL1dvcmsvU2lkZWNhci9mYWNlYm9vay10cmFja2luZy9zcmMvcnVsZXMvYWdncmVnYXRlLXJ1bGUuanMiLCIvVXNlcnMvcm9ib3R0by9Qcm9qZWN0cy9Xb3JrL1NpZGVjYXIvZmFjZWJvb2stdHJhY2tpbmcvc3JjL3J1bGVzL2Jhc2UtcnVsZS5qcyIsIi9Vc2Vycy9yb2JvdHRvL1Byb2plY3RzL1dvcmsvU2lkZWNhci9mYWNlYm9vay10cmFja2luZy9zcmMvcnVsZXMvY2xpY2stcnVsZS5qcyIsIi9Vc2Vycy9yb2JvdHRvL1Byb2plY3RzL1dvcmsvU2lkZWNhci9mYWNlYm9vay10cmFja2luZy9zcmMvcnVsZXMvaW5kZXguanMiLCIvVXNlcnMvcm9ib3R0by9Qcm9qZWN0cy9Xb3JrL1NpZGVjYXIvZmFjZWJvb2stdHJhY2tpbmcvc3JjL3J1bGVzL291dHNpZGUtcmVmZXJyZXItcnVsZS5qcyIsIi9Vc2Vycy9yb2JvdHRvL1Byb2plY3RzL1dvcmsvU2lkZWNhci9mYWNlYm9vay10cmFja2luZy9zcmMvcnVsZXMvcGFnZXZpZXctcnVsZS5qcyIsIi9Vc2Vycy9yb2JvdHRvL1Byb2plY3RzL1dvcmsvU2lkZWNhci9mYWNlYm9vay10cmFja2luZy9zcmMvcnVsZXMvcHJvZHVjdC1yZXB1cmNoYXNlci1ydWxlLmpzIiwiL1VzZXJzL3JvYm90dG8vUHJvamVjdHMvV29yay9TaWRlY2FyL2ZhY2Vib29rLXRyYWNraW5nL3NyYy9ydWxlcy9wdXJjaGFzZS1ydWxlLmpzIiwiL1VzZXJzL3JvYm90dG8vUHJvamVjdHMvV29yay9TaWRlY2FyL2ZhY2Vib29rLXRyYWNraW5nL3NyYy9ydWxlcy92aWV3LWNvbnRlbnQtcnVsZS5qcyIsIi9Vc2Vycy9yb2JvdHRvL1Byb2plY3RzL1dvcmsvU2lkZWNhci9mYWNlYm9vay10cmFja2luZy9zcmMvc2VydmljZXMvY29va2llL2Jhc2UuanMiLCIvVXNlcnMvcm9ib3R0by9Qcm9qZWN0cy9Xb3JrL1NpZGVjYXIvZmFjZWJvb2stdHJhY2tpbmcvc3JjL3NlcnZpY2VzL2Nvb2tpZS9tYWluLmpzIiwiL1VzZXJzL3JvYm90dG8vUHJvamVjdHMvV29yay9TaWRlY2FyL2ZhY2Vib29rLXRyYWNraW5nL3NyYy9zZXJ2aWNlcy9jb29raWUvc2Vzc2lvbi5qcyIsIi9Vc2Vycy9yb2JvdHRvL1Byb2plY3RzL1dvcmsvU2lkZWNhci9mYWNlYm9vay10cmFja2luZy9zcmMvc2VydmljZXMvY29va2llL3NpZGVjYXIta2V5LmpzIiwiL1VzZXJzL3JvYm90dG8vUHJvamVjdHMvV29yay9TaWRlY2FyL2ZhY2Vib29rLXRyYWNraW5nL3NyYy9zZXJ2aWNlcy9kZWJ1Zy5qcyIsIi9Vc2Vycy9yb2JvdHRvL1Byb2plY3RzL1dvcmsvU2lkZWNhci9mYWNlYm9vay10cmFja2luZy9zcmMvc2VydmljZXMvZXZlbnQtbWFuYWdlci5qcyIsIi9Vc2Vycy9yb2JvdHRvL1Byb2plY3RzL1dvcmsvU2lkZWNhci9mYWNlYm9vay10cmFja2luZy9zcmMvc2VydmljZXMvZmFjZWJvb2svZmJxLmpzIiwiL1VzZXJzL3JvYm90dG8vUHJvamVjdHMvV29yay9TaWRlY2FyL2ZhY2Vib29rLXRyYWNraW5nL3NyYy9zZXJ2aWNlcy9mYWNlYm9vay9pbmRleC5qcyIsIi9Vc2Vycy9yb2JvdHRvL1Byb2plY3RzL1dvcmsvU2lkZWNhci9mYWNlYm9vay10cmFja2luZy9zcmMvc2VydmljZXMvcGFnZS11dGlscy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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Q0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDOzs7OztBQUt6QixRQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQzs7Ozs7QUFLbkIsUUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQzs7O0FBRzdCLFFBQUksT0FBTyxRQUFRLENBQUMsTUFBTSxLQUFLLFdBQVcsRUFBRTtBQUMxQyxVQUFJLENBQUMsTUFBTSxHQUFHLFFBQVEsQ0FBQztBQUN2QixVQUFJLENBQUMsZ0JBQWdCLEdBQUcsa0JBQWtCLENBQUM7O0tBRTVDLE1BQU0sSUFBSSxPQUFPLFFBQVEsQ0FBQyxTQUFTLEtBQUssV0FBVyxFQUFFO0FBQ3BELFlBQUksQ0FBQyxNQUFNLEdBQUcsV0FBVyxDQUFDO0FBQzFCLFlBQUksQ0FBQyxnQkFBZ0IsR0FBRyxxQkFBcUIsQ0FBQzs7T0FFL0MsTUFBTSxJQUFJLE9BQU8sUUFBUSxDQUFDLFFBQVEsS0FBSyxXQUFXLEVBQUU7QUFDbkQsY0FBSSxDQUFDLE1BQU0sR0FBRyxVQUFVLENBQUM7QUFDekIsY0FBSSxDQUFDLGdCQUFnQixHQUFHLG9CQUFvQixDQUFDOztTQUU5QyxNQUFNLElBQUksT0FBTyxRQUFRLENBQUMsWUFBWSxLQUFLLFdBQVcsRUFBRTtBQUN2RCxnQkFBSSxDQUFDLE1BQU0sR0FBRyxjQUFjLENBQUM7QUFDN0IsZ0JBQUksQ0FBQyxnQkFBZ0IsR0FBRyx3QkFBd0IsQ0FBQztXQUNsRDtHQUNGOzs7Ozs7ZUF4Q0csU0FBUzs7V0E2Q0oscUJBQUc7QUFDVixhQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7S0FDcEM7OztTQS9DRyxTQUFTOzs7cUJBa0RBLElBQUksU0FBUyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiOyhmdW5jdGlvbiAod2luZG93KSB7XG5cbiAgZnVuY3Rpb24gZGVmYXVsdHMgKHRhcmdldCwgb2JqKSB7XG4gICAgZm9yICh2YXIgcHJvcCBpbiBvYmopIHRhcmdldFtwcm9wXSA9IHRhcmdldFtwcm9wXSB8fCBvYmpbcHJvcF1cbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFF1ZXJ5IChxdWVyeVBhcmFtcykge1xuICAgIHZhciBhcnIgPSBPYmplY3Qua2V5cyhxdWVyeVBhcmFtcykubWFwKGZ1bmN0aW9uIChrKSB7XG4gICAgICByZXR1cm4gW2ssIGVuY29kZVVSSUNvbXBvbmVudChxdWVyeVBhcmFtc1trXSldLmpvaW4oJz0nKVxuICAgIH0pXG4gICAgcmV0dXJuICc/JyArIGFyci5qb2luKCcmJylcbiAgfVxuXG4gIGZ1bmN0aW9uIF9mZXRjaCAobWV0aG9kLCB1cmwsIG9wdHMsIGRhdGEsIHF1ZXJ5UGFyYW1zKSB7XG4gICAgb3B0cy5tZXRob2QgPSBtZXRob2RcbiAgICBvcHRzLmhlYWRlcnMgPSBvcHRzLmhlYWRlcnMgfHwge31cbiAgICBvcHRzLnJlc3BvbnNlQXMgPSAob3B0cy5yZXNwb25zZUFzICYmIFsnanNvbicsICd0ZXh0JywgJ3Jlc3BvbnNlJ10uaW5kZXhPZihvcHRzLnJlc3BvbnNlQXMpID49IDApID8gb3B0cy5yZXNwb25zZUFzIDogJ2pzb24nXG5cbiAgICBkZWZhdWx0cyhvcHRzLmhlYWRlcnMsIHtcbiAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgfSlcblxuICAgIGlmIChxdWVyeVBhcmFtcykge1xuICAgICAgdXJsICs9IGdldFF1ZXJ5KHF1ZXJ5UGFyYW1zKVxuICAgIH1cblxuICAgIGlmIChkYXRhKSB7XG4gICAgICAgIG9wdHMuYm9keSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGRlbGV0ZSBvcHRzLmJvZHk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZldGNoaXZhbC5mZXRjaCh1cmwsIG9wdHMpXG4gICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzIDwgMzAwKSB7XG4gICAgICAgICAgaWYob3B0cy5yZXNwb25zZUFzPT1cInJlc3BvbnNlXCIpXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2VcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IDIwNClcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgIHJldHVybiByZXNwb25zZVtvcHRzLnJlc3BvbnNlQXNdKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVyciA9IG5ldyBFcnJvcihyZXNwb25zZS5zdGF0dXNUZXh0KVxuICAgICAgICBlcnIucmVzcG9uc2UgPSByZXNwb25zZVxuICAgICAgICB0aHJvdyBlcnJcbiAgICAgIH0pXG4gIH1cblxuICBmdW5jdGlvbiBmZXRjaGl2YWwgKHVybCwgb3B0cykge1xuICAgIG9wdHMgPSBvcHRzIHx8IHt9XG5cbiAgICB2YXIgXyA9IGZ1bmN0aW9uICh1LCBvKSB7XG4gICAgICAvLyBFeHRlbmQgcGFyYW1ldGVycyB3aXRoIHByZXZpb3VzIG9uZXNcbiAgICAgIHUgPSB1cmwgKyAnLycgKyB1XG4gICAgICBvID0gbyB8fCB7fVxuICAgICAgZGVmYXVsdHMobywgb3B0cylcbiAgICAgIHJldHVybiBmZXRjaGl2YWwodSwgbylcbiAgICB9XG5cbiAgICBfLmdldCA9IGZ1bmN0aW9uIChxdWVyeVBhcmFtcykge1xuICAgICAgcmV0dXJuIF9mZXRjaCgnR0VUJywgdXJsLCBvcHRzLCBudWxsLCBxdWVyeVBhcmFtcylcbiAgICB9XG5cbiAgICBfLnBvc3QgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgcmV0dXJuIF9mZXRjaCgnUE9TVCcsIHVybCwgb3B0cywgZGF0YSlcbiAgICB9XG5cbiAgICBfLnB1dCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICByZXR1cm4gX2ZldGNoKCdQVVQnLCB1cmwsIG9wdHMsIGRhdGEpXG4gICAgfVxuXG4gICAgXy5wYXRjaCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICByZXR1cm4gX2ZldGNoKCdQQVRDSCcsIHVybCwgb3B0cywgZGF0YSlcbiAgICB9XG5cbiAgICBfLmRlbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBfZmV0Y2goJ0RFTEVURScsIHVybCwgb3B0cylcbiAgICB9XG5cbiAgICByZXR1cm4gX1xuICB9XG5cbiAgLy8gRXhwb3NlIGZldGNoIHNvIHRoYXQgb3RoZXIgcG9seWZpbGxzIGNhbiBiZSB1c2VkXG4gIC8vIEJpbmQgZmV0Y2ggdG8gd2luZG93IHRvIGF2b2lkIFR5cGVFcnJvcjogSWxsZWdhbCBpbnZvY2F0aW9uXG4gIGZldGNoaXZhbC5mZXRjaCA9IHR5cGVvZiBmZXRjaCAhPT0gJ3VuZGVmaW5lZCcgPyBmZXRjaC5iaW5kKHdpbmRvdykgOiBudWxsXG5cbiAgLy8gU3VwcG9ydCBDb21tb25KUywgQU1EICYgYnJvd3NlclxuICBpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuICAgIG1vZHVsZS5leHBvcnRzID0gZmV0Y2hpdmFsXG4gIGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcbiAgICBkZWZpbmUoZnVuY3Rpb24oKSB7IHJldHVybiBmZXRjaGl2YWwgfSlcbiAgZWxzZVxuICAgIHdpbmRvdy5mZXRjaGl2YWwgPSBmZXRjaGl2YWxcblxufSkodHlwZW9mIHdpbmRvdyAhPSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHVuZGVmaW5lZCk7XG4iLCIvKiFcbiAqIEphdmFTY3JpcHQgQ29va2llIHYyLjAuM1xuICogaHR0cHM6Ly9naXRodWIuY29tL2pzLWNvb2tpZS9qcy1jb29raWVcbiAqXG4gKiBDb3B5cmlnaHQgMjAwNiwgMjAxNSBLbGF1cyBIYXJ0bCAmIEZhZ25lciBCcmFja1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlXG4gKi9cbihmdW5jdGlvbiAoZmFjdG9yeSkge1xuXHRpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG5cdFx0ZGVmaW5lKGZhY3RvcnkpO1xuXHR9IGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHR9IGVsc2Uge1xuXHRcdHZhciBfT2xkQ29va2llcyA9IHdpbmRvdy5Db29raWVzO1xuXHRcdHZhciBhcGkgPSB3aW5kb3cuQ29va2llcyA9IGZhY3Rvcnkod2luZG93LmpRdWVyeSk7XG5cdFx0YXBpLm5vQ29uZmxpY3QgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHR3aW5kb3cuQ29va2llcyA9IF9PbGRDb29raWVzO1xuXHRcdFx0cmV0dXJuIGFwaTtcblx0XHR9O1xuXHR9XG59KGZ1bmN0aW9uICgpIHtcblx0ZnVuY3Rpb24gZXh0ZW5kICgpIHtcblx0XHR2YXIgaSA9IDA7XG5cdFx0dmFyIHJlc3VsdCA9IHt9O1xuXHRcdGZvciAoOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgYXR0cmlidXRlcyA9IGFyZ3VtZW50c1sgaSBdO1xuXHRcdFx0Zm9yICh2YXIga2V5IGluIGF0dHJpYnV0ZXMpIHtcblx0XHRcdFx0cmVzdWx0W2tleV0gPSBhdHRyaWJ1dGVzW2tleV07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH1cblxuXHRmdW5jdGlvbiBpbml0IChjb252ZXJ0ZXIpIHtcblx0XHRmdW5jdGlvbiBhcGkgKGtleSwgdmFsdWUsIGF0dHJpYnV0ZXMpIHtcblx0XHRcdHZhciByZXN1bHQ7XG5cblx0XHRcdC8vIFdyaXRlXG5cblx0XHRcdGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuXHRcdFx0XHRhdHRyaWJ1dGVzID0gZXh0ZW5kKHtcblx0XHRcdFx0XHRwYXRoOiAnLydcblx0XHRcdFx0fSwgYXBpLmRlZmF1bHRzLCBhdHRyaWJ1dGVzKTtcblxuXHRcdFx0XHRpZiAodHlwZW9mIGF0dHJpYnV0ZXMuZXhwaXJlcyA9PT0gJ251bWJlcicpIHtcblx0XHRcdFx0XHR2YXIgZXhwaXJlcyA9IG5ldyBEYXRlKCk7XG5cdFx0XHRcdFx0ZXhwaXJlcy5zZXRNaWxsaXNlY29uZHMoZXhwaXJlcy5nZXRNaWxsaXNlY29uZHMoKSArIGF0dHJpYnV0ZXMuZXhwaXJlcyAqIDg2NGUrNSk7XG5cdFx0XHRcdFx0YXR0cmlidXRlcy5leHBpcmVzID0gZXhwaXJlcztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0cmVzdWx0ID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xuXHRcdFx0XHRcdGlmICgvXltcXHtcXFtdLy50ZXN0KHJlc3VsdCkpIHtcblx0XHRcdFx0XHRcdHZhbHVlID0gcmVzdWx0O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBjYXRjaCAoZSkge31cblxuXHRcdFx0XHR2YWx1ZSA9IGVuY29kZVVSSUNvbXBvbmVudChTdHJpbmcodmFsdWUpKTtcblx0XHRcdFx0dmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC8lKDIzfDI0fDI2fDJCfDNBfDNDfDNFfDNEfDJGfDNGfDQwfDVCfDVEfDVFfDYwfDdCfDdEfDdDKS9nLCBkZWNvZGVVUklDb21wb25lbnQpO1xuXG5cdFx0XHRcdGtleSA9IGVuY29kZVVSSUNvbXBvbmVudChTdHJpbmcoa2V5KSk7XG5cdFx0XHRcdGtleSA9IGtleS5yZXBsYWNlKC8lKDIzfDI0fDI2fDJCfDVFfDYwfDdDKS9nLCBkZWNvZGVVUklDb21wb25lbnQpO1xuXHRcdFx0XHRrZXkgPSBrZXkucmVwbGFjZSgvW1xcKFxcKV0vZywgZXNjYXBlKTtcblxuXHRcdFx0XHRyZXR1cm4gKGRvY3VtZW50LmNvb2tpZSA9IFtcblx0XHRcdFx0XHRrZXksICc9JywgdmFsdWUsXG5cdFx0XHRcdFx0YXR0cmlidXRlcy5leHBpcmVzICYmICc7IGV4cGlyZXM9JyArIGF0dHJpYnV0ZXMuZXhwaXJlcy50b1VUQ1N0cmluZygpLCAvLyB1c2UgZXhwaXJlcyBhdHRyaWJ1dGUsIG1heC1hZ2UgaXMgbm90IHN1cHBvcnRlZCBieSBJRVxuXHRcdFx0XHRcdGF0dHJpYnV0ZXMucGF0aCAgICAmJiAnOyBwYXRoPScgKyBhdHRyaWJ1dGVzLnBhdGgsXG5cdFx0XHRcdFx0YXR0cmlidXRlcy5kb21haW4gICYmICc7IGRvbWFpbj0nICsgYXR0cmlidXRlcy5kb21haW4sXG5cdFx0XHRcdFx0YXR0cmlidXRlcy5zZWN1cmUgPyAnOyBzZWN1cmUnIDogJydcblx0XHRcdFx0XS5qb2luKCcnKSk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFJlYWRcblxuXHRcdFx0aWYgKCFrZXkpIHtcblx0XHRcdFx0cmVzdWx0ID0ge307XG5cdFx0XHR9XG5cblx0XHRcdC8vIFRvIHByZXZlbnQgdGhlIGZvciBsb29wIGluIHRoZSBmaXJzdCBwbGFjZSBhc3NpZ24gYW4gZW1wdHkgYXJyYXlcblx0XHRcdC8vIGluIGNhc2UgdGhlcmUgYXJlIG5vIGNvb2tpZXMgYXQgYWxsLiBBbHNvIHByZXZlbnRzIG9kZCByZXN1bHQgd2hlblxuXHRcdFx0Ly8gY2FsbGluZyBcImdldCgpXCJcblx0XHRcdHZhciBjb29raWVzID0gZG9jdW1lbnQuY29va2llID8gZG9jdW1lbnQuY29va2llLnNwbGl0KCc7ICcpIDogW107XG5cdFx0XHR2YXIgcmRlY29kZSA9IC8oJVswLTlBLVpdezJ9KSsvZztcblx0XHRcdHZhciBpID0gMDtcblxuXHRcdFx0Zm9yICg7IGkgPCBjb29raWVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHZhciBwYXJ0cyA9IGNvb2tpZXNbaV0uc3BsaXQoJz0nKTtcblx0XHRcdFx0dmFyIG5hbWUgPSBwYXJ0c1swXS5yZXBsYWNlKHJkZWNvZGUsIGRlY29kZVVSSUNvbXBvbmVudCk7XG5cdFx0XHRcdHZhciBjb29raWUgPSBwYXJ0cy5zbGljZSgxKS5qb2luKCc9Jyk7XG5cblx0XHRcdFx0aWYgKGNvb2tpZS5jaGFyQXQoMCkgPT09ICdcIicpIHtcblx0XHRcdFx0XHRjb29raWUgPSBjb29raWUuc2xpY2UoMSwgLTEpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRjb29raWUgPSBjb252ZXJ0ZXIgJiYgY29udmVydGVyKGNvb2tpZSwgbmFtZSkgfHwgY29va2llLnJlcGxhY2UocmRlY29kZSwgZGVjb2RlVVJJQ29tcG9uZW50KTtcblxuXHRcdFx0XHRcdGlmICh0aGlzLmpzb24pIHtcblx0XHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRcdGNvb2tpZSA9IEpTT04ucGFyc2UoY29va2llKTtcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGUpIHt9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKGtleSA9PT0gbmFtZSkge1xuXHRcdFx0XHRcdFx0cmVzdWx0ID0gY29va2llO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKCFrZXkpIHtcblx0XHRcdFx0XHRcdHJlc3VsdFtuYW1lXSA9IGNvb2tpZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gY2F0Y2ggKGUpIHt9XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0fVxuXG5cdFx0YXBpLmdldCA9IGFwaS5zZXQgPSBhcGk7XG5cdFx0YXBpLmdldEpTT04gPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRyZXR1cm4gYXBpLmFwcGx5KHtcblx0XHRcdFx0anNvbjogdHJ1ZVxuXHRcdFx0fSwgW10uc2xpY2UuY2FsbChhcmd1bWVudHMpKTtcblx0XHR9O1xuXHRcdGFwaS5kZWZhdWx0cyA9IHt9O1xuXG5cdFx0YXBpLnJlbW92ZSA9IGZ1bmN0aW9uIChrZXksIGF0dHJpYnV0ZXMpIHtcblx0XHRcdGFwaShrZXksICcnLCBleHRlbmQoYXR0cmlidXRlcywge1xuXHRcdFx0XHRleHBpcmVzOiAtMVxuXHRcdFx0fSkpO1xuXHRcdH07XG5cblx0XHRhcGkud2l0aENvbnZlcnRlciA9IGluaXQ7XG5cblx0XHRyZXR1cm4gYXBpO1xuXHR9XG5cblx0cmV0dXJuIGluaXQoKTtcbn0pKTtcbiIsIi8qKlxuICogUmV0cmlldmUgdGhlIEZhY2Vib29rIFBpeGVsIElEIGRlZmluZWQgYnkgU2lkZWNhckpTXG4gKlxuICogQHJldHVybiB7dW5kZWZpbmVkfVxuICovXG5mdW5jdGlvbiBnZXRQaXhlbElkKCkge1xuICB0cnkge1xuICAgIHJldHVybiB3aW5kb3cuc2lkZWNhci5jb25maWcuZmFjZWJvb2tfcGl4ZWxfaWQ7XG4gIH0gY2F0Y2goZSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vKipcbiAqIFJldHJpZXZlIHRoZSBTaXRlIElEIGRlZmluZWQgYnkgU2lkZWNhckpTXG4gKlxuICogQHJldHVybiB7dW5kZWZpbmVkfVxuICovXG5mdW5jdGlvbiBnZXRTaXRlSWQoKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHdpbmRvdy5zaWRlY2FyLmNvbmZpZy5zaXRlX2lkO1xuICB9IGNhdGNoKGUpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIHRoaXMgdHJhY2tpbmcgc29sdXRpb24gc2hvdWxkIGZpcmUgdGhlIGJhc2ljIEZhY2Vib29rXG4gKiBldmVudHMuICBFZywgYEluaXRgLCBgUGFnZVZpZXdgLCBgVmlld0NvbnRlbnRgXG4gKlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gc2hvdWxkSWdub3JlRXZlbnRzKCkge1xuICBsZXQgY29uZmlnO1xuXG4gIHRyeSB7XG4gICAgY29uZmlnID0gd2luZG93LnNpZGVjYXIuY29uZmlnO1xuICB9IGNhdGNoKGUpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgXG4gIGlmKCEhY29uZmlnLmZhY2Vib29rX2lnbm9yZV9iYXNpY19ldmVudHMpIHtcbiAgICByZXR1cm4gWydpbml0JywgJ1BhZ2VWaWV3JywgJ1ZpZXdDb250ZW50JywgJ1B1cmNoYXNlJ107XG4gIH1cbiAgXG4gIGlmKEFycmF5LmlzQXJyYXkoY29uZmlnLmZhY2Vib29rX2lnbm9yZV9ldmVudHMpKSB7XG4gICAgcmV0dXJuIGNvbmZpZy5mYWNlYm9va19pZ25vcmVfZXZlbnRzO1xuICB9XG4gIFxuICByZXR1cm4gW107XG59XG5cbi8qKlxuICogRmFjZWJvb2stc3BlY2lmaWMgY29uZmlndXJhdGlvbi4gIFdyYXBzIHBpeGVsIElEIGZyb20gbWFpbiBjb25maWcuXG4gKlxuICogTk9URTogQ2xpZW50LXNwZWNpZmljIGNvbmZpZ3VyYXRpb24gc2hvdWxkIHN0aWxsIGdvIGluIHRoZSBTaWRlY2FySlMgY29uZmlnIGZpbGUuXG4gKiBAdHlwZSB7T2JqZWN0fVxuICovXG5leHBvcnQgY29uc3QgQ29uZmlnID0ge1xuICB2ZXJzaW9uOiAwLjMsXG4gIGV4cGlyZXM6IDkwLFxuICBzaXRlSWQ6IGdldFNpdGVJZCgpLFxuICBwaXhlbElkOiBnZXRQaXhlbElkKCksXG4gIGlnbm9yZUV2ZW50czogc2hvdWxkSWdub3JlRXZlbnRzKCksXG4gIGVuZHBvaW50czoge1xuICAgIGNhbGM6ICdodHRwczovL2ZhY2Vib29rLmdldHNpZGVjYXIuY29tL2FnZ3JlZ2F0ZS1ydWxlJyxcbiAgICBmaXJlaG9zZTogJ2h0dHBzOi8vZmFjZWJvb2suZ2V0c2lkZWNhci5jb20vdHJhY2suZ2lmJyxcbiAgICBoZXJtZXM6ICdodHRwczovL2ZhY2Vib29rLmdldHNpZGVjYXIuY29tL2hlcm1lcy9ydWxlcydcbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgQ29uZmlnO1xuIiwiLyogZXNsaW50IG5vLXNoYWRvdy1yZXN0cmljdGVkLW5hbWVzOiAwLCBuby11bnVzZWQtdmFyczogMCAqL1xuXG4vKipcbiAqIE1haW5cbiAqL1xuaW1wb3J0IEV2ZW50TWFuYWdlciBmcm9tICcuL3NlcnZpY2VzL2V2ZW50LW1hbmFnZXInO1xuaW1wb3J0IE1haW5Db29raWUgZnJvbSAnLi9zZXJ2aWNlcy9jb29raWUvbWFpbic7XG5pbXBvcnQgRmFjZWJvb2sgZnJvbSAnLi9zZXJ2aWNlcy9mYWNlYm9vayc7XG5pbXBvcnQgQ29uZmlnIGZyb20gJy4vY29uZmlnJztcblxuKGZ1bmN0aW9uIG1haW4od2luZG93LCBkb2N1bWVudCwgdW5kZWZpbmVkKSB7XG4gIGNvbnN0IEZCID0gbmV3IEZhY2Vib29rKHdpbmRvdyk7XG4gIHdpbmRvdy5zY0ZCQ29va2llID0gTWFpbkNvb2tpZTtcblxuICBGQi5pbml0KCk7XG5cbiAgRXZlbnRNYW5hZ2VyLmxpc3Rlbk9uY2UoJ3J1bGVzJywgJ2xvYWRlZCcsICgpID0+IHtcbiAgICByZXF1aXJlKCcuL29ic2VydmVycycpKHdpbmRvdyk7XG4gIH0pO1xuXG4gIHJlcXVpcmUoJy4vcnVsZXMnKSh3aW5kb3cpO1xufSkod2luZG93LCBkb2N1bWVudCk7XG4iLCJpbXBvcnQgQmFzZU9ic2VydmVyIGZyb20gJy4vYmFzZS1vYnNlcnZlcic7XG5pbXBvcnQgeyBkZWZhdWx0IGFzIENvb2tpZSwgRmllbGRzIH0gZnJvbSAnLi4vc2VydmljZXMvY29va2llL21haW4nO1xuaW1wb3J0IFBhZ2VVdGlscyBmcm9tICcuLi9zZXJ2aWNlcy9wYWdlLXV0aWxzJztcblxuLyoqXG4gKiBNb25pdG9ycyB1c2VyJ3MgYWN0aXZlIHRpbWUgb24gcGFnZSBhbmQgaW5jcmVtZW50cyBhIGNvdW50ZXIgaW4gbWFpbiBjb29raWVcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQWN0aXZpdHlPYnNlcnZlciBleHRlbmRzIEJhc2VPYnNlcnZlciB7XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHt3aW5kb3d9IHdpbmRvdyAtIFdpbmRvdyBvYmplY3RcbiAgICpcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKi9cbiAgaW5pdCh3aW5kb3cpIHtcbiAgICB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgaWYgKFBhZ2VVdGlscy5pc1Zpc2libGUoKSkge1xuICAgICAgICB0aGlzLnVwZGF0ZUFjdGl2ZVRpbWUoKTtcbiAgICAgIH1cbiAgICB9LCAxMDAwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICB1cGRhdGVBY3RpdmVUaW1lKCkge1xuXG4gICAgdGhpcy5maWVsZCA9IEZpZWxkcy50aW1lT25TaXRlO1xuICAgIHRoaXMubWF4ID0gRmllbGRzLm1heFRpbWVPblNpdGU7XG5cbiAgICAvLyBJbmNyaW1lbnQgdGhlIGNvb2tpZSB2YWx1ZSBpZiBsZXNzIHRoYW4gbWF4IHNldHRpbmdcbiAgICBpZiAoQ29va2llLmdldEZpZWxkKHRoaXMuZmllbGQpIDwgdGhpcy5tYXgpIHtcbiAgICAgIENvb2tpZS5zZXRGaWVsZCh0aGlzLmZpZWxkLCAodmFsdWUpID0+IHtcbiAgICAgICAgcmV0dXJuICsrdmFsdWU7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBSZXNldCBjb29raWUgdmFsdWUgdG8gbWF4IGlmIHRoZXkgaGF2ZSBhbHJlYWR5IGV4Y2VlZGVkIGl0XG4gICAgaWYgKENvb2tpZS5nZXRGaWVsZCh0aGlzLmZpZWxkKSA+IHRoaXMubWF4KSB7XG4gICAgICBDb29raWUuc2V0RmllbGQodGhpcy5maWVsZCwgKCkgPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5tYXg7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgfVxufVxuIiwiaW1wb3J0IEV2ZW50TWFuYWdlciBmcm9tICcuLi9zZXJ2aWNlcy9ldmVudC1tYW5hZ2VyJztcblxuLyoqXG4gKiBAY2xhc3NcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmFzZU9ic2VydmVyIHtcblxuICAvKipcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKlxuICAgKiBAdGhyb3dzIHtUeXBlRXJyb3J9IEJhc2VPYnNlcnZlciBtdXN0IGJlIGV4dGVuZGVkIGJ5IGFub3RoZXIgb2JzZXJ2ZXJcbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIC8qKlxuICAgICAqIEB0eXBlIHtTdHJpbmd9XG4gICAgICovXG4gICAgdGhpcy5uYW1lc3BhY2UgPSAnb2JzZXJ2ZXJzJztcblxuICAgIC8vIEZha2UgYWJzdHJhY3RcbiAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gQmFzZU9ic2VydmVyKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY29uc3RydWN0IEJhc2VPYnNlcnZlciBpbnN0YW5jZXMgZGlyZWN0bHkuJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEBhYnN0cmFjdFxuICAgKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICBpbml0KCkge1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7U3RyaW5nfSByb3V0ZSAgIC0gUm91dGUgb2YgZXZlbnRcbiAgICogQHBhcmFtIHsqfSAgICAgIGNvbnRleHQgLSBEYXRhIHRvIGJlIHBhc3NlZCB0byBldmVudCBsaXN0ZW5lclxuICAgKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICB0cmlnZ2VyKHJvdXRlLCBjb250ZXh0KSB7XG4gICAgRXZlbnRNYW5hZ2VyLnRyaWdnZXIodGhpcy5uYW1lc3BhY2UsIHJvdXRlLCBjb250ZXh0KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBhZ2VPYnNlcnZlciBmcm9tICcuL3BhZ2Utb2JzZXJ2ZXInO1xuaW1wb3J0IFByb2R1Y3RWaWV3T2JzZXJ2ZXIgZnJvbSAnLi9wcm9kdWN0LXZpZXctb2JzZXJ2ZXInO1xuaW1wb3J0IFRyYW5zYWN0aW9uT2JzZXJ2ZXIgZnJvbSAnLi90cmFuc2FjdGlvbi1vYnNlcnZlcic7XG5pbXBvcnQgU2Vzc2lvbk9ic2VydmVyIGZyb20gJy4vc2Vzc2lvbi1vYnNlcnZlcic7XG5pbXBvcnQgQWN0aXZpdHlPYnNlcnZlciBmcm9tICcuL2FjdGl2aXR5LW9ic2VydmVyJztcbmltcG9ydCBJbnRlcmFjdGlvbk9ic2VydmVyIGZyb20gJy4vaW50ZXJhY3Rpb24tb2JzZXJ2ZXInO1xuaW1wb3J0IEV2ZW50TWFuYWdlciBmcm9tICcuLi9zZXJ2aWNlcy9ldmVudC1tYW5hZ2VyJztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBsb2FkT2JzZXJ2ZXJzKHdpbmRvdykge1xuICBjb25zdCBvYnNlcnZlcnMgPSBbXG4gICAgbmV3IFBhZ2VPYnNlcnZlcigpLFxuICAgIG5ldyBTZXNzaW9uT2JzZXJ2ZXIoKSxcbiAgICBuZXcgUHJvZHVjdFZpZXdPYnNlcnZlcigpLFxuICAgIG5ldyBUcmFuc2FjdGlvbk9ic2VydmVyKCksXG4gICAgbmV3IEFjdGl2aXR5T2JzZXJ2ZXIoKSxcbiAgICBuZXcgSW50ZXJhY3Rpb25PYnNlcnZlcigpXG4gIF07XG5cbiAgZm9yIChsZXQgaSA9IDAsIGwgPSBvYnNlcnZlcnMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgb2JzZXJ2ZXJzW2ldLmluaXQod2luZG93KTtcbiAgfVxuXG4gIEV2ZW50TWFuYWdlci50cmlnZ2VyKCdvYnNlcnZlcnMnLCAnbG9hZGVkJyk7XG59O1xuIiwiaW1wb3J0IEJhc2VPYnNlcnZlciBmcm9tICcuL2Jhc2Utb2JzZXJ2ZXInO1xuXG4vKipcbiAqIE1vbml0b3JzIHVzZXIncyBpbnRlcmF0aW9ucyB3aXRoIHRoZSBwYWdlLiAgRWcuIFNjcm9sbGluZywgQ2xpY2tpbmcsIGV0Yy5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW50ZXJhY3Rpb25PYnNlcnZlciBleHRlbmRzIEJhc2VPYnNlcnZlciB7XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHt3aW5kb3d9IHdpbmRvdyAtIFdpbmRvdyBvYmplY3RcbiAgICpcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKi9cbiAgaW5pdCh3aW5kb3cpIHtcbiAgICAvKiogQHR5cGUge3dpbmRvd30gLSBCcm93c2VyIHdpbmRvdyBvYmplY3QgKiovXG4gICAgdGhpcy53aW5kb3cgPSB3aW5kb3c7XG5cbiAgICB0aGlzLmFkZEV2ZW50KCdjbGljaycsIChlKSA9PiB7IHRoaXMuaGFuZGxlQ2xpY2soZSk7IH0pO1xuICAgIHRoaXMuYWRkRXZlbnQoJ3Njcm9sbCcsIChlKSA9PiB7IHRoaXMuaGFuZGxlU2Nyb2xsKGUpOyB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge0V2ZW50fSBldiAtIEJyb3dzZXIgZXZlbnRcbiAgICpcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKi9cbiAgaGFuZGxlQ2xpY2soZXYpIHtcbiAgICB0aGlzLnRyaWdnZXIoJ2NsaWNrJywgZXYudGFyZ2V0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICBoYW5kbGVTY3JvbGwoKSB7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtTdHJpbmd9IHR5cGUgLSBFdmVudCBkZXNjcmlwdGVyXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIC0gQ2FsbGJhY2tcbiAgICpcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKi9cbiAgYWRkRXZlbnQodHlwZSwgZm4pIHtcbiAgICB0cnkge1xuICAgICAgdGhpcy53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBmbik7XG4gICAgfSBjYXRjaChlKSB7XG4gICAgICB0aGlzLndpbmRvdy5hdHRhY2hFdmVudCh0eXBlLCBmbik7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgQmFzZU9ic2VydmVyIGZyb20gJy4vYmFzZS1vYnNlcnZlcic7XG5pbXBvcnQgeyBkZWZhdWx0IGFzIENvb2tpZSwgRmllbGRzIH0gZnJvbSAnLi4vc2VydmljZXMvY29va2llL21haW4nO1xuXG4vKipcbiAqIEBjbGFzc1xuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQYWdlT2JzZXJ2ZXIgZXh0ZW5kcyBCYXNlT2JzZXJ2ZXIge1xuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIEluY3JlbWVudCBwYWdldmlldyBjb3VudCBpbiBtYWluIGNvb2tpZVxuICAgKlxuICAgKiBAcGFyYW0ge3dpbmRvd30gd2luZG93IC0gQnJvd3NlciB3aW5kb3cgb2JqZWN0XG4gICAqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIGluaXQod2luZG93KSB7XG4gICAgdGhpcy5pbmNyZW1lbnRQYWdldmlld3MoKTtcbiAgICB0aGlzLmNoZWNrUmVmZXJyZXIod2luZG93LmRvY3VtZW50KTtcbiAgICB0aGlzLnRyaWdnZXIoJ3BhZ2V2aWV3Jyk7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKi9cbiAgaW5jcmVtZW50UGFnZXZpZXdzKCkge1xuICAgIFxuICAgIHRoaXMuZmllbGQgPSBGaWVsZHMucGFnZXZpZXdzO1xuICAgIHRoaXMubWF4ID0gRmllbGRzLm1heFBhZ2VWaWV3cztcblxuICAgIC8vIEluY3JpbWVudCB0aGUgY29va2llIHZhbHVlIGlmIGxlc3MgdGhhbiBtYXggc2V0dGluZ1xuICAgIGlmIChDb29raWUuZ2V0RmllbGQodGhpcy5maWVsZCkgPCB0aGlzLm1heCkge1xuICAgICAgQ29va2llLnNldEZpZWxkKHRoaXMuZmllbGQsICh2YWx1ZSkgPT4ge1xuICAgICAgICByZXR1cm4gKyt2YWx1ZTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFJlc2V0IGNvb2tpZSB2YWx1ZSB0byBtYXggaWYgdGhleSBoYXZlIGFscmVhZHkgZXhjZWVkZWQgaXRcbiAgICBpZiAoQ29va2llLmdldEZpZWxkKHRoaXMuZmllbGQpID4gdGhpcy5tYXgpIHtcbiAgICAgIENvb2tpZS5zZXRGaWVsZCh0aGlzLmZpZWxkLCAoKSA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLm1heDtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHRoaXMudHJpZ2dlcigndXBkYXRlJyk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtkb2N1bWVudH0gZG9jdW1lbnQgLSBCcm93c2VyIGRvY3VtZW50IG9iamVjdFxuICAgKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICBjaGVja1JlZmVycmVyKGRvY3VtZW50KSB7XG4gICAgY29uc3QgcmVmICAgICAgPSBkb2N1bWVudC5yZWZlcnJlcjtcbiAgICBjb25zdCBob3N0bmFtZSA9IGRvY3VtZW50LmxvY2F0aW9uLmhvc3RuYW1lO1xuXG4gICAgaWYgKCFyZWYgfHwgcmVmID09PSAnJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChyZWYuaW5kZXhPZihob3N0bmFtZSkgPT09IC0xKSB7XG4gICAgICB0aGlzLnRyaWdnZXIoJ291dHNpZGUtcmVmZXJyZXInLCB7IHZpc2l0OiAnVHJ1ZScgfSk7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgQmFzZU9ic2VydmVyIGZyb20gJy4vYmFzZS1vYnNlcnZlcic7XG5pbXBvcnQgeyBkZWZhdWx0IGFzIE1haW5Db29raWUsIEZpZWxkcyB9IGZyb20gJy4uL3NlcnZpY2VzL2Nvb2tpZS9tYWluJztcblxuLyoqXG4gKiBAY2xhc3NcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJvZHVjdFZpZXdPYnNlcnZlciBleHRlbmRzIEJhc2VPYnNlcnZlciB7XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG5cbiAgICAvKipcbiAgICAgKiBTaWRlY2FyIHBhZ2UgaW5mb3JtYXRpb25cbiAgICAgKiBAdHlwZSB7T2JqZWN0fVxuICAgICAqL1xuICAgIHRoaXMuU2lkZWNhciA9IHdpbmRvdy5zaWRlY2FyO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIGluaXQoKSB7XG4gICAgY29uc3QgcHJvZHVjdElkICAgPSB0aGlzLmdldEdyb3VwSWQoKSB8fCB0aGlzLmdldFByb2R1Y3RJZCgpO1xuICAgIGNvbnN0IHByb2R1Y3RUeXBlID0gKHRoaXMuZ2V0R3JvdXBJZCgpICE9PSB1bmRlZmluZWQpID8gJ3Byb2R1Y3RfZ3JvdXAnIDogJ3Byb2R1Y3QnO1xuXG4gICAgaWYgKHByb2R1Y3RJZCkge1xuICAgICAgdGhpcy51cGRhdGVQcm9kdWN0Vmlld3MocHJvZHVjdElkKTtcbiAgICAgIHRoaXMudHJpZ2dlcigndmlldy1jb250ZW50Jywge3R5cGU6IHByb2R1Y3RUeXBlLCBpZDogcHJvZHVjdElkfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge1N0cmluZ3x1bmRlZmluZWR9XG4gICAqL1xuICBnZXRHcm91cElkKCkge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gdGhpcy5TaWRlY2FyLnByb2R1Y3RfaW5mby5ncm91cF9pZDtcbiAgICB9IGNhdGNoKGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7U3RyaW5nfHVuZGVmaW5lZH1cbiAgICovXG4gIGdldFByb2R1Y3RJZCgpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIHRoaXMuU2lkZWNhci5wcm9kdWN0X2luZm8ucHJvZHVjdF9pZDtcbiAgICB9IGNhdGNoKGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtTdHJpbmd9IHByb2R1Y3RJZCAtIFByb2R1Y3QgSWQgZnJvbSBtYWluIFNpZGVjYXIgdHJhY2tpbmcgc2NyaXB0XG4gICAqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIHVwZGF0ZVByb2R1Y3RWaWV3cyhwcm9kdWN0SWQpIHtcblxuICAgIHRoaXMubWF4UHJvZHVjdHMgPSBGaWVsZHMubWF4UHJvZHVjdHM7XG4gICAgdGhpcy5tYXhWaWV3cyA9IEZpZWxkcy5tYXhQcm9kdWN0Vmlld3M7XG5cbiAgICBjb25zdCBwcm9kdWN0Vmlld3MgPSBNYWluQ29va2llLmdldEZpZWxkKEZpZWxkcy5wcm9kdWN0cykgfHwgW107XG4gICAgbGV0IGZvdW5kID0gZmFsc2U7XG5cbiAgICBmb3IgKGxldCBpID0gMCwgbCA9IHByb2R1Y3RWaWV3cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgIGlmIChwcm9kdWN0Vmlld3NbaV1bRmllbGRzLnByb2R1Y3RJZF0gPT09IHByb2R1Y3RJZCkge1xuXG4gICAgICAgIC8vIEluY3JpbWVudCB0aGUgY29va2llIHZhbHVlIGlmIGxlc3MgdGhhbiBtYXggc2V0dGluZ1xuICAgICAgICBpZiAocHJvZHVjdFZpZXdzW2ldW0ZpZWxkcy5wcm9kdWN0Vmlld3NdIDwgdGhpcy5tYXhWaWV3cykge1xuICAgICAgICAgIHByb2R1Y3RWaWV3c1tpXVtGaWVsZHMucHJvZHVjdFZpZXdzXSsrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVzZXQgY29va2llIHZhbHVlIHRvIG1heCBpZiB0aGV5IGhhdmUgYWxyZWFkeSBleGNlZWRlZCBpdFxuICAgICAgICBpZiAocHJvZHVjdFZpZXdzW2ldW0ZpZWxkcy5wcm9kdWN0Vmlld3NdID4gdGhpcy5tYXhWaWV3cykge1xuICAgICAgICAgIHByb2R1Y3RWaWV3c1tpXVtGaWVsZHMucHJvZHVjdFZpZXdzXSA9IHRoaXMubWF4Vmlld3M7XG4gICAgICAgIH1cblxuICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFmb3VuZCAmJiBwcm9kdWN0Vmlld3MubGVuZ3RoIDwgdGhpcy5tYXhQcm9kdWN0cykge1xuICAgICAgY29uc3QgbmV3UHJvZHVjdCA9IHt9O1xuICAgICAgbmV3UHJvZHVjdFtGaWVsZHMucHJvZHVjdElkXSA9IHByb2R1Y3RJZDtcbiAgICAgIG5ld1Byb2R1Y3RbRmllbGRzLnByb2R1Y3RWaWV3c10gPSAxO1xuICAgICAgcHJvZHVjdFZpZXdzLnB1c2gobmV3UHJvZHVjdCk7XG4gICAgfVxuXG4gICAgTWFpbkNvb2tpZS5zZXRGaWVsZChGaWVsZHMucHJvZHVjdHMsIHByb2R1Y3RWaWV3cyk7XG4gIH1cbn1cbiIsImltcG9ydCBCYXNlT2JzZXJ2ZXIgZnJvbSAnLi9iYXNlLW9ic2VydmVyJztcbmltcG9ydCB7IGRlZmF1bHQgYXMgTWFpbkNvb2tpZSwgRmllbGRzIH0gZnJvbSAnLi4vc2VydmljZXMvY29va2llL21haW4nO1xuaW1wb3J0IFNlc3Npb25Db29raWUgZnJvbSAnLi4vc2VydmljZXMvY29va2llL3Nlc3Npb24nO1xuXG4vKipcbiAqIEBjbGFzc1xuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZXNzaW9uT2JzZXJ2ZXIgZXh0ZW5kcyBCYXNlT2JzZXJ2ZXIge1xuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIERldGVybWluZSBpZiB0aGlzIGlzIGEgbmV3IHNlc3Npb25cbiAgICogSWYgc28gaW5jcmVtZW50IGNvdW50IGluIG1haW4gY29va2llIGFuZCBjcmVhdGUgbmV3IHNlc3Npb24gY29va2llXG4gICAqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIGluaXQoKSB7XG5cbiAgICBpZiAoIVNlc3Npb25Db29raWUuZ2V0KCkpIHtcbiAgICAgIHRoaXMuZmllbGQgPSBGaWVsZHMuc2Vzc2lvbnM7XG4gICAgICB0aGlzLm1heCA9IEZpZWxkcy5tYXhTZXNzaW9ucztcblxuICAgICAgY29uc3QgY29udGVudCA9IHt9O1xuICAgICAgY29udGVudC5zdGFydCA9IERhdGUubm93KCk7XG4gICAgICBjb250ZW50W0ZpZWxkcy5wYWdldmlld3NdID0gMTtcbiAgICAgIFNlc3Npb25Db29raWUuc2V0KGNvbnRlbnQpO1xuXG4gICAgICAvLyBJbmNyaW1lbnQgdGhlIGNvb2tpZSB2YWx1ZSBpZiBsZXNzIHRoYW4gbWF4IHNldHRpbmdcbiAgICAgIGlmIChNYWluQ29va2llLmdldEZpZWxkKHRoaXMuZmllbGQpIDwgdGhpcy5tYXgpIHtcbiAgICAgICAgTWFpbkNvb2tpZS5zZXRGaWVsZCh0aGlzLmZpZWxkLCAodmFsdWUpID0+IHtcbiAgICAgICAgICByZXR1cm4gKyt2YWx1ZTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFJlc2V0IGNvb2tpZSB2YWx1ZSB0byBtYXggaWYgdGhleSBoYXZlIGFscmVhZHkgZXhjZWVkZWQgaXRcbiAgICAgIGlmIChNYWluQ29va2llLmdldEZpZWxkKHRoaXMuZmllbGQpID4gdGhpcy5tYXgpIHtcbiAgICAgICAgTWFpbkNvb2tpZS5zZXRGaWVsZCh0aGlzLmZpZWxkLCAoKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMubWF4O1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmZpZWxkID0gRmllbGRzLnBhZ2V2aWV3cztcbiAgICAgIHRoaXMubWF4ID0gRmllbGRzLm1heFBhZ2VWaWV3cztcblxuICAgICAgLy8gSW5jcmltZW50IHRoZSBjb29raWUgdmFsdWUgaWYgbGVzcyB0aGFuIG1heCBzZXR0aW5nXG4gICAgICBpZiAoU2Vzc2lvbkNvb2tpZS5nZXRGaWVsZCh0aGlzLmZpZWxkKSA8IHRoaXMubWF4KSB7XG4gICAgICAgIFNlc3Npb25Db29raWUuc2V0RmllbGQodGhpcy5maWVsZCwgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgcmV0dXJuICsrdmFsdWU7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBSZXNldCBjb29raWUgdmFsdWUgdG8gbWF4IGlmIHRoZXkgaGF2ZSBhbHJlYWR5IGV4Y2VlZGVkIGl0XG4gICAgICBpZiAoU2Vzc2lvbkNvb2tpZS5nZXRGaWVsZCh0aGlzLmZpZWxkKSA+IHRoaXMubWF4KSB7XG4gICAgICAgIFNlc3Npb25Db29raWUuc2V0RmllbGQodGhpcy5maWVsZCwgKCkgPT4ge1xuICAgICAgICAgIHJldHVybiB0aGlzLm1heDtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCBCYXNlT2JzZXJ2ZXIgZnJvbSAnLi9iYXNlLW9ic2VydmVyJztcbmltcG9ydCB7IGRlZmF1bHQgYXMgQ29va2llLCBGaWVsZHMgfSBmcm9tICcuLi9zZXJ2aWNlcy9jb29raWUvbWFpbic7XG5cbi8qKlxuICogQGNsYXNzXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRyYW5zYWN0aW9uT2JzZXJ2ZXIgZXh0ZW5kcyBCYXNlT2JzZXJ2ZXIge1xuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICB9XG5cbiAgLyoqXG4gICAqIERldGVybWluZSBpZiB0aGUgdXNlciBpcyBvbiBhIHRyYW5zYWN0aW9uIHBhZ2VcbiAgICpcbiAgICogQHBhcmFtIHt3aW5kb3d9IHdpbmRvdyAtIEJyb3dzZXIgd2luZG93IG9iamVjdFxuICAgKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICBpbml0KHdpbmRvdykge1xuICAgIGNvbnN0IFNpZGVjYXIgPSB3aW5kb3cuc2lkZWNhcjtcblxuICAgIGlmICghU2lkZWNhciB8fFxuICAgICAgICAhU2lkZWNhci50cmFuc2FjdGlvbnMgfHxcbiAgICAgICAgIVNpZGVjYXIudHJhbnNhY3Rpb25zLmRhdGEgfHxcbiAgICAgICAgIVNpZGVjYXIudHJhbnNhY3Rpb25zLml0ZW1zKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy51cGRhdGVUcmFuc2FjdGlvbnMoKTtcbiAgICB0aGlzLnRyaWdnZXIoJ3B1cmNoYXNlJywgU2lkZWNhci50cmFuc2FjdGlvbnMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIHVwZGF0ZVRyYW5zYWN0aW9ucygpIHtcblxuICAgIHRoaXMuZmllbGQgPSBGaWVsZHMudHJhbnNhY3Rpb25zO1xuICAgIHRoaXMubWF4ID0gRmllbGRzLm1heFRyYW5zYWN0aW9ucztcblxuICAgIC8vIEluY3JpbWVudCB0aGUgY29va2llIHZhbHVlIGlmIGxlc3MgdGhhbiBtYXggc2V0dGluZ1xuICAgIGlmIChDb29raWUuZ2V0RmllbGQodGhpcy5maWVsZCkgPCB0aGlzLm1heCkge1xuICAgICAgQ29va2llLnNldEZpZWxkKHRoaXMuZmllbGQsICh2YWx1ZSkgPT4ge1xuICAgICAgICByZXR1cm4gKyt2YWx1ZTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFJlc2V0IGNvb2tpZSB2YWx1ZSB0byBtYXggaWYgdGhleSBoYXZlIGFscmVhZHkgZXhjZWVkZWQgaXRcbiAgICBpZiAoQ29va2llLmdldEZpZWxkKHRoaXMuZmllbGQpID4gdGhpcy5tYXgpIHtcbiAgICAgIENvb2tpZS5zZXRGaWVsZCh0aGlzLmZpZWxkLCAoKSA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLm1heDtcbiAgICAgIH0pO1xuICAgIH1cblxuICB9XG59XG4iLCJpbXBvcnQgQmFzZVJ1bGUgZnJvbSAnLi9iYXNlLXJ1bGUuanMnO1xuaW1wb3J0IHsgZGVmYXVsdCBhcyBDb29raWUsIEZpZWxkcyB9IGZyb20gJy4uL3NlcnZpY2VzL2Nvb2tpZS9tYWluJztcblxuLyoqXG4gKiBAY2xhc3NcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQWdncmVnYXRlUnVsZSBleHRlbmRzIEJhc2VSdWxlIHtcblxuICAvKipcbiAgICogQHBhcmFtIHt3aW5kb3d9IHdpbmRvdyAtIEJyb3dzZXIgd2luZG93IG9iamVjdFxuICAgKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICBjb25zdHJ1Y3Rvcih3aW5kb3cpIHtcbiAgICBzdXBlcih3aW5kb3cpO1xuXG4gICAgLyoqXG4gICAgICogVGhyZXNob2xkIGxldmVscyBmb3IgaW5pdGlhbCBtb2RlbFxuICAgICAqL1xuICAgIHRoaXMudGhyZXNob2xkcyA9IHtcbiAgICAgIGxvdzogMC4xLFxuICAgICAgbWVkOiAwLjIsXG4gICAgICBoaWdoOiAwLjVcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIGluaXQoZmFjZWJvb2spIHtcbiAgICBzdXBlci5pbml0KGZhY2Vib29rKTtcbiAgICBcbiAgICB0aGlzLmxpc3RlbigndXBkYXRlJywgKCkgPT4ge1xuICAgICAgdGhpcy5jaGVjaygpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIERldGVybWluZSBpZiB0aGUgY29uZGl0aW9ucyBmb3IgYSBydWxlIGhhdmUgYmVlbiBtZXRcbiAgICpcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKi9cbiAgY2hlY2soKSB7XG4gICAgY29uc3QgZGF0YSA9IENvb2tpZS5nZXQoKTtcblxuICAgIC8vIFRlbXAgc2VydmljZSByZXF1ZXN0XG4gICAgdGhpcy5jYWxjRmlyZWhvc2Uoe1xuICAgICAgdmlld3M6IGRhdGFbRmllbGRzLnBhZ2V2aWV3c10sXG4gICAgICBzZXNzaW9uczogZGF0YVtGaWVsZHMuc2Vzc2lvbnNdLFxuICAgICAgdHJhbnNhY3Rpb25zOiBkYXRhW0ZpZWxkcy50cmFuc2FjdGlvbnNdXG4gICAgfSwgKHNjb3JlKSA9PiB7XG4gICAgICBpZiAoc2NvcmUgPj0gdGhpcy50aHJlc2hvbGRzLmxvdyAmJlxuICAgICAgICAgIHNjb3JlIDw9IHRoaXMudGhyZXNob2xkcy5tZWQpIHtcbiAgICAgICAgdGhpcy50cmFjaygnc2NfbG93Jywge3RyYWNrT25jZTogdHJ1ZX0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoc2NvcmUgPiB0aGlzLnRocmVzaG9sZHMubWVkICYmXG4gICAgICAgICAgc2NvcmUgPD0gdGhpcy50aHJlc2hvbGRzLmhpZ2gpIHtcbiAgICAgICAgdGhpcy50cmFjaygnc2NfbWVkJywge3RyYWNrT25jZTogdHJ1ZX0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoc2NvcmUgPiB0aGlzLnRocmVzaG9sZHMuaGlnaCkge1xuICAgICAgICB0aGlzLnRyYWNrKCdzY19oaWdoJywge3RyYWNrT25jZTogdHJ1ZX0pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gSGVybWVzIHJlcXVlc3RcbiAgICB0aGlzLmNhbGN1bGF0ZUV2ZW50cyh7XG4gICAgICB2aWV3czogZGF0YVtGaWVsZHMucGFnZXZpZXdzXSxcbiAgICAgIHNlc3Npb25zOiBkYXRhW0ZpZWxkcy5zZXNzaW9uc10sXG4gICAgICB0cmFuc2FjdGlvbnM6IGRhdGFbRmllbGRzLnRyYW5zYWN0aW9uc11cbiAgICB9LCAocmVzcG9uc2UpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgIGlmICghcmVzcG9uc2UuZmJFdmVudHMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc3BvbnNlLmZiRXZlbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChDb25maWcuZGVidWcpIHtcbiAgICAgICAgICBDb25zb2xlLmxvZyhyZXNwb25zZS5mYkV2ZW50c1tpXS5uYW1lLCAnOicsIHJlc3BvbnNlLmZiRXZlbnRzW2ldLmNvbnRleHQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZCBjdXN0b20gZXZlbnQgdG8gRmFjZWJvb2sgYW5kIHJlZ2lzdGVyIHRoZSBldmVudCBhcyBmaXJlZCBpbiB0aGUgbWFpbiBjb29raWVcbiAgICpcbiAgICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50TmFtZSAtIE5hbWUgb2YgY3VzdG9tIEZhY2Vib29rIGV2ZW50IHRvIGZpcmVcbiAgICogQHBhcmFtIHtPYmplY3R9IGNvbnRleHQgLSBDb250ZXh0IHRvIHJ1biB0aGUgcnVsZSB3aXRoXG4gICAqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIHRyYWNrKGV2ZW50TmFtZSwgY29udGV4dCkge1xuICAgIGNvbnN0IGFscmVhZHlUcmFja2VkID0gQ29va2llLmdldEZpZWxkKEZpZWxkcy50cmFja2VkRXZlbnRzKSB8fCBbXTtcbiAgICBpZiAoY29udGV4dC50cmFja09uY2UgPT09IHRydWUgJiYgYWxyZWFkeVRyYWNrZWQuaW5kZXhPZihldmVudE5hbWUpICE9PSAtMSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmKCF0aGlzLndpbmRvdy5mYnEpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLndpbmRvdy5mYnEoJ3RyYWNrQ3VzdG9tJywgZXZlbnROYW1lLCBjb250ZXh0KTtcbiAgICBhbHJlYWR5VHJhY2tlZC5wdXNoKGV2ZW50TmFtZSk7XG4gICAgQ29va2llLnNldEZpZWxkKEZpZWxkcy50cmFja2VkRXZlbnRzLCBhbHJlYWR5VHJhY2tlZCk7XG4gIH1cbn1cbiIsImltcG9ydCBFdmVudE1hbmFnZXIgZnJvbSAnLi4vc2VydmljZXMvZXZlbnQtbWFuYWdlcic7XG5pbXBvcnQgU2lkZWNhcktleUNvb2tpZSBmcm9tICcuLi9zZXJ2aWNlcy9jb29raWUvc2lkZWNhci1rZXknO1xuaW1wb3J0IFNpZGVjYXJDb29raWUgZnJvbSAnLi4vc2VydmljZXMvY29va2llL21haW4nO1xuaW1wb3J0IEZhY2Vib29rIGZyb20gJy4uL3NlcnZpY2VzL2ZhY2Vib29rJztcbmltcG9ydCBDb25maWcgZnJvbSAnLi4vY29uZmlnJztcbmltcG9ydCBkZWJ1ZyBmcm9tICcuLi9zZXJ2aWNlcy9kZWJ1Zyc7XG5jb25zdCBmZXRjaGl2YWwgPSByZXF1aXJlKCdmZXRjaGl2YWwnKTtcblxuLyoqXG4gKiBFeHRlbmRhYmxlIGJhc2UgY2xhc3MgZm9yIHJ1bGVzLlxuICpcbiAqIEBjbGFzc1xuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCYXNlUnVsZSB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7d2luZG93fSB3aW5kb3cgLSBCcm93c2VyIHdpbmRvdyBvYmplY3RcbiAgICpcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKlxuICAgKiBAdGhyb3dzIHtUeXBlRXJyb3J9XG4gICAqL1xuICBjb25zdHJ1Y3Rvcih3aW5kb3cpIHtcbiAgICAvKiogQHR5cGUge09iamVjdH0gKi9cbiAgICB0aGlzLndpbmRvdyA9IHdpbmRvdztcbiAgICBcbiAgICB0aGlzLmRlYnVnID0gZGVidWc7XG5cbiAgICAvKiogQHR5cGUge1N0cmluZ30gKi9cbiAgICB0aGlzLm5hbWVzcGFjZSA9ICdydWxlcyc7XG5cbiAgICAvKiogQHR5cGUge1N0cmluZ30gKi9cbiAgICB0aGlzLnByb2R1Y2VyTmFtZXNwYWNlID0gJ29ic2VydmVycyc7XG5cbiAgICAvKiogQHR5cGUge0ZldGNoaXZhbH0gKi9cbiAgICB0aGlzLmNhbGMgPSBmZXRjaGl2YWwoQ29uZmlnLmVuZHBvaW50cy5jYWxjLCB7IG1vZGU6ICdjb3JzJyB9KTtcblxuICAgIC8qKiBAdHlwZSB7RmV0Y2hpdmFsfSAqL1xuICAgIHRoaXMuZmlyZWhvc2UgPSBmZXRjaGl2YWwoQ29uZmlnLmVuZHBvaW50cy5maXJlaG9zZSwgeyBtb2RlOiAnY29ycycgfSk7XG5cbiAgICAvKiogQHR5cGUge0ZldGNoaXZhbH0gKi9cbiAgICB0aGlzLmhlcm1lcyA9IGZldGNoaXZhbChDb25maWcuZW5kcG9pbnRzLmhlcm1lcywgeyBtb2RlOiAnY29ycycgfSk7XG5cbiAgICAvLyBGYWtlIGFic3RyYWN0XG4gICAgLy8gRmFrZSBhYnN0cmFjdFxuICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBCYXNlUnVsZSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNvbnN0cnVjdCBCYXNlUnVsZSBpbnN0YW5jZXMgZGlyZWN0bHkuJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIGluaXQoZmFjZWJvb2spIHtcbiAgICB0aGlzLmZhY2Vib29rID0gZmFjZWJvb2s7XG4gICAgXG4gICAgY29uc3QgY2xhc3NOYW1lID0gdGhpcy5jb25zdHJ1Y3Rvci50b1N0cmluZygpLm1hdGNoKC9mdW5jdGlvbiAoXFx3KikvKVsxXTtcbiAgICBcbiAgICB0aGlzLmRlYnVnKGBJbml0aWFsaXplZDogJHtjbGFzc05hbWV9YCk7XG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0ZXIgYSBjYWxsYmFjayB0byBmaXJlIG9uIGEgbGlzdGVuZXIgZXZlcnkgdGltZSBpdCBpcyBlbWl0dGVkXG4gICAqXG4gICAqIEBwYXJhbSB7U3RyaW5nfSByb3V0ZSAtIFJvdXRlIGlkZW50aWZpZXJcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBGdW5jdGlvbiB0byBiZSBjYWxsZWRcbiAgICpcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKi9cbiAgbGlzdGVuKHJvdXRlLCBjYWxsYmFjaykge1xuICAgIEV2ZW50TWFuYWdlci5saXN0ZW4odGhpcy5wcm9kdWNlck5hbWVzcGFjZSwgcm91dGUsIGNhbGxiYWNrKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWdpc3RlciBhIGNhbGxiYWNrIHRvIGZpcmUgb24gYSBsaXN0ZW5lciBvbmNlXG4gICAqXG4gICAqIEBwYXJhbSB7U3RyaW5nfSByb3V0ZSAtIFJvdXRlIGlkZW50aWZpZXJcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBGdW5jdGlvbiB0byBiZSBjYWxsZWRcbiAgICpcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKi9cbiAgbGlzdGVuT25jZShyb3V0ZSwgY2FsbGJhY2spIHtcbiAgICBFdmVudE1hbmFnZXIubGlzdGVuT25jZSh0aGlzLnByb2R1Y2VyTmFtZXNwYWNlLCByb3V0ZSwgY2FsbGJhY2spO1xuICB9XG5cbiAgY2FsY3VsYXRlRXZlbnRzKGRhdGEpIHtcbiAgICBpZiAoIUNvbmZpZy5zaXRlSWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBkYXRhLnNpdGVJZCA9IENvbmZpZy5zaXRlSWQ7XG4gICAgZGF0YS5zY1Nlc3Npb25JZCA9IFNpZGVjYXJLZXlDb29raWUuZ2V0KCk7XG4gICAgZGF0YS52aWV3cyA9IFNpZGVjYXJDb29raWUuZ2V0RmllbGQoJ3AnKTtcbiAgICBkYXRhLnRyYW5zYWN0aW9ucyA9IFNpZGVjYXJDb29raWUuZ2V0RmllbGQoJ3RyJyk7XG4gICAgZGF0YS5zZXNzaW9ucyA9IFNpZGVjYXJDb29raWUuZ2V0RmllbGQoJ3MnKTtcbiAgICB0aGlzLmhlcm1lcy5nZXQoZGF0YSlcbiAgICAgIC50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgICAgICBpZiAoIXJlc3BvbnNlLmV2ZW50cykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlc3BvbnNlLmV2ZW50cy5tYXAoKGV2KSA9PiB7XG4gICAgICAgICAgaWYgKCFldi50eXBlID09PSAnZmFjZWJvb2snKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgRmFjZWJvb2sudHJhY2soZXYudmFsdWUsIHRydWUsIGV2LmNvbnRleHQpO1xuICAgICAgICB9KTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKCkgPT4ge1xuICAgICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZCB0cmFja2luZyBpbmZvcm1hdGlvbiBiYWNrIHRvIFNpZGVjYXIgZmlyZWhvc2VcbiAgICpcbiAgICogQHBhcmFtIHsqfSBkYXRhIC0gRGF0YSB0byBiZSBzZW50IHRvIHRoZSBmaXJlaG9zZSBzZXJ2ZXJcbiAgICpcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKi9cbiAgdHJhY2tGaXJlaG9zZShkYXRhKSB7XG4gICAgaWYgKENvbmZpZy5zaXRlSWQpIHtcbiAgICAgIGRhdGEuc2l0ZUlkID0gQ29uZmlnLnNpdGVJZDtcbiAgICAgIGRhdGEuc2NTZXNzaW9uSWQgPSBTaWRlY2FyS2V5Q29va2llLmdldCgpO1xuXG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2VuZCB1c2VyIHN0YXRlIHRvIGZpcmVob3NlIGFuZCBoYW5kbGUgdGhlIHJlc3BvbnNlXG4gICAqXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhIC0gRGF0YSB0byBiZSBzZW50IHRvIHRoZSBmaXJlaG9zZSBzZXJ2ZXJcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2IgLSBDYWxsYmFja1xuICAgKlxuICAgKiBAcmV0dXJuIHtOdW1iZXJ8U3RyaW5nfVxuICAgKi9cbiAgY2FsY0ZpcmVob3NlKGRhdGEsIGNiKSB7XG4gICAgaWYgKENvbmZpZy5zaXRlSWQpIHtcbiAgICAgIGRhdGEuc2l0ZUlkID0gQ29uZmlnLnNpdGVJZDtcbiAgICAgIHRoaXMuY2FsYy5nZXQoZGF0YSlcbiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgY2IocmVzcG9uc2UpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKCkgPT4ge1xuICAgICAgICB9KTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCBCYXNlUnVsZSBmcm9tICcuL2Jhc2UtcnVsZSc7XG5cbi8qKlxuICogU2VuZHMgaW5mb3JtYXRpb24gYWJvdXQgY2xpY2sgZXZlbnRzIHRvIFNpZGVjYXIgZmlyZWhvc2Ugc2VydmljZS5cbiAqXG4gKiBAY2xhc3NcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2xpY2tSdWxlIGV4dGVuZHMgQmFzZVJ1bGUge1xuICAvKipcbiAgICogQHBhcmFtIHt3aW5kb3d9IHdpbmRvdyAtIEJyb3dzZXIgd2luZG93IG9iamVjdFxuICAgKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICBjb25zdHJ1Y3Rvcih3aW5kb3cpIHtcbiAgICBzdXBlcih3aW5kb3cpO1xuICB9XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIGluaXQoZmFjZWJvb2spIHtcbiAgICBzdXBlci5pbml0KGZhY2Vib29rKTtcbiAgICBcbiAgICB0aGlzLmxpc3RlbignY2xpY2snLCAoY29udGV4dCkgPT4ge1xuICAgICAgbGV0IHRhcmdldCA9IGNvbnRleHQudGFnTmFtZTtcbiAgICAgIHRhcmdldCA9IHRoaXMuYWRkVGFyZ2V0RGV0YWlscyh0YXJnZXQsIGNvbnRleHQuaWQsICcjJyk7XG4gICAgICB0YXJnZXQgPSB0aGlzLmFkZFRhcmdldERldGFpbHModGFyZ2V0LCBjb250ZXh0LmNsYXNzTmFtZSwgJy4nKTtcbiAgICAgIHRoaXMudHJhY2tGaXJlaG9zZSh7XG4gICAgICAgIGV2ZW50OiAnY2xpY2snLFxuICAgICAgICBkZXRhaWxzOiB0YXJnZXRcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7U3RyaW5nfSB0YXJnZXQgLSBDdXJyZW50IHRhcmdldCBzdHJpbmdcbiAgICogQHBhcmFtIHtTdHJpbmd9IGRldGFpbCAtIENsYXNzIG9yIElkIG5hbWUgb2YgdGFyZ2V0LiAgSWYgYW55XG4gICAqIEBwYXJhbSB7U3RyaW5nfSBwcmVmaXggLSBEZXNjcmlwdGl2ZSBwcmVmaXggZm9yIGRldGFpbC4gIEVnICMgb3IgLlxuICAgKlxuICAgKiBAcmV0dXJuIHtTdHJpbmd9XG4gICAqL1xuICBhZGRUYXJnZXREZXRhaWxzKHRhcmdldCwgZGV0YWlsLCBwcmVmaXgpIHtcbiAgICBpZiAoIWRldGFpbCkge1xuICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldCArIHByZWZpeCArIGRldGFpbDtcbiAgfVxufVxuIiwiaW1wb3J0IEZhY2Vib29rIGZyb20gJy4uL3NlcnZpY2VzL2ZhY2Vib29rJztcbmltcG9ydCBBZ2dyZWdhdGVSdWxlIGZyb20gJy4vYWdncmVnYXRlLXJ1bGUuanMnO1xuaW1wb3J0IE91dHNpZGVSZWZlcnJlclJ1bGUgZnJvbSAnLi9vdXRzaWRlLXJlZmVycmVyLXJ1bGUuanMnO1xuaW1wb3J0IFBhZ2V2aWV3UnVsZSBmcm9tICcuL3BhZ2V2aWV3LXJ1bGUuanMnO1xuaW1wb3J0IFZpZXdDb250ZW50UnVsZSBmcm9tICcuL3ZpZXctY29udGVudC1ydWxlLmpzJztcbmltcG9ydCBQdXJjaGFzZVJ1bGUgZnJvbSAnLi9wdXJjaGFzZS1ydWxlLmpzJztcbmltcG9ydCBQcm9kdWN0UmVwdXJjaGFzZXJSdWxlIGZyb20gJy4vcHJvZHVjdC1yZXB1cmNoYXNlci1ydWxlLmpzJztcbmltcG9ydCBDbGlja1J1bGUgZnJvbSAnLi9jbGljay1ydWxlLmpzJztcbmltcG9ydCBFdmVudE1hbmFnZXIgZnJvbSAnLi4vc2VydmljZXMvZXZlbnQtbWFuYWdlcic7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gbG9hZFJ1bGVzKHdpbmRvdykge1xuICBjb25zdCBmYWNlYm9vayA9IG5ldyBGYWNlYm9vayh3aW5kb3cpO1xuICBcbiAgY29uc3QgcnVsZXMgPSBbXG4gICAgbmV3IEFnZ3JlZ2F0ZVJ1bGUod2luZG93KSxcbiAgICBuZXcgT3V0c2lkZVJlZmVycmVyUnVsZSh3aW5kb3cpLFxuICAgIG5ldyBWaWV3Q29udGVudFJ1bGUod2luZG93KSxcbiAgICBuZXcgUGFnZXZpZXdSdWxlKHdpbmRvdyksXG4gICAgbmV3IFB1cmNoYXNlUnVsZSh3aW5kb3cpLFxuICAgIG5ldyBQcm9kdWN0UmVwdXJjaGFzZXJSdWxlKHdpbmRvdyksXG4gICAgbmV3IENsaWNrUnVsZSh3aW5kb3cpXG4gIF07XG5cbiAgZm9yIChsZXQgaSA9IDAsIGwgPSBydWxlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICBydWxlc1tpXS5pbml0KGZhY2Vib29rKTtcbiAgfVxuXG4gIEV2ZW50TWFuYWdlci50cmlnZ2VyKCdydWxlcycsICdsb2FkZWQnKTtcbn07XG4iLCJpbXBvcnQgQmFzZVJ1bGUgZnJvbSAnLi9iYXNlLXJ1bGUuanMnO1xuaW1wb3J0IENvbmZpZyBmcm9tICcuLi9jb25maWcnO1xuXG4vKipcbiAqIEBjbGFzc1xuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBPdXRzaWRlUmVmZXJyZXJSdWxlIGV4dGVuZHMgQmFzZVJ1bGUge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3dpbmRvd30gd2luZG93IC0gQnJvd3NlciB3aW5kb3cgb2JqZWN0XG4gICAqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIGNvbnN0cnVjdG9yKHdpbmRvdykge1xuICAgIHN1cGVyKHdpbmRvdyk7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKi9cbiAgaW5pdChmYWNlYm9vaykge1xuICAgIHN1cGVyLmluaXQoZmFjZWJvb2spO1xuXG4gICAgdGhpcy5saXN0ZW4oJ291dHNpZGUtcmVmZXJyZXInLCAoY29udGV4dCkgPT4ge1xuICAgICAgdGhpcy5mYWNlYm9vay50cmFjaygnT3V0c2lkZVJlZmVycmVyJywgdHJ1ZSwgY29udGV4dCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBCYXNlUnVsZSBmcm9tICcuL2Jhc2UtcnVsZS5qcyc7XG5cbi8qKlxuICogQGNsYXNzXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBhZ2V2aWV3UnVsZSBleHRlbmRzIEJhc2VSdWxlIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7d2luZG93fSB3aW5kb3cgLSBCcm93c2VyIHdpbmRvdyBvYmplY3RcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKi9cbiAgY29uc3RydWN0b3Iod2luZG93KSB7XG4gICAgc3VwZXIod2luZG93KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICBpbml0KGZhY2Vib29rKSB7XG4gICAgc3VwZXIuaW5pdChmYWNlYm9vayk7XG4gICAgXG4gICAgdGhpcy5saXN0ZW4oJ3BhZ2V2aWV3JywgKGNvbnRleHQpID0+IHtcbiAgICAgIHRoaXMuZmFjZWJvb2sudHJhY2soJ1BhZ2VWaWV3Jyk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBCYXNlUnVsZSBmcm9tICcuL2Jhc2UtcnVsZS5qcyc7XG5pbXBvcnQgQ29uZmlnIGZyb20gJy4uL2NvbmZpZyc7XG5pbXBvcnQgU2Vzc2lvbkNvb2tpZSBmcm9tICcuLi9zZXJ2aWNlcy9jb29raWUvc2Vzc2lvbic7XG5cbi8qKlxuICogQGNsYXNzXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFByb2R1Y3RSZXB1cmNoYXNlclJ1bGUgZXh0ZW5kcyBCYXNlUnVsZSB7XG4gIC8qKlxuICAgKiBAcGFyYW0ge3dpbmRvd30gd2luZG93IC0gQnJvd3NlciB3aW5kb3cgb2JqZWN0XG4gICAqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIGNvbnN0cnVjdG9yKHdpbmRvdykge1xuICAgIHN1cGVyKHdpbmRvdyk7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKi9cbiAgaW5pdChmYWNlYm9vaykge1xuICAgIHN1cGVyLmluaXQoZmFjZWJvb2spO1xuICAgIFxuICAgIHRoaXMubGlzdGVuKCdwdXJjaGFzZScsIChjb250ZXh0KSA9PiB7XG4gICAgICBpZiAoQ29uZmlnLnBpeGVsSWQpIHtcbiAgICAgICAgY29uc3QgcHJvZHVjdHMgPSBjb250ZXh0Lml0ZW1zLm1hcCgocCkgPT4ge1xuICAgICAgICAgIHJldHVybiBgJHtwLnByb2R1Y3RfaWR9fCR7cC51bml0X3ByaWNlfXwke3AucXVhbnRpdHl9YDtcbiAgICAgICAgfSkuam9pbignfHwnKTtcbiAgICAgICAgY29uc3Qgc2Vzc2lvbkluZm8gPSBTZXNzaW9uQ29va2llLmdldCgpO1xuICAgICAgICB0aGlzLmNhbGN1bGF0ZUV2ZW50cyh7cHJvZHVjdHMsIC4uLnNlc3Npb25JbmZvfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBCYXNlUnVsZSBmcm9tICcuL2Jhc2UtcnVsZS5qcyc7XG5pbXBvcnQgQ29uZmlnIGZyb20gJy4uL2NvbmZpZyc7XG5cbi8qKlxuICogQGNsYXNzXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFB1cmNoYXNlUnVsZSBleHRlbmRzIEJhc2VSdWxlIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7d2luZG93fSB3aW5kb3cgLSBCcm93c2VyIHdpbmRvdyBvYmplY3RcbiAgICpcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKi9cbiAgY29uc3RydWN0b3Iod2luZG93KSB7XG4gICAgc3VwZXIod2luZG93KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICBpbml0KGZhY2Vib29rKSB7XG4gICAgc3VwZXIuaW5pdChmYWNlYm9vayk7XG5cbiAgICB0aGlzLmxpc3RlbigncHVyY2hhc2UnLCAoY29udGV4dCkgPT4ge1xuICAgICAgaWYoIWNvbnRleHQuaXRlbXMgfHwgIWNvbnRleHQuZGF0YSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHByb2R1Y3RJZHMgPSBbXTtcbiAgICAgIFxuICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBjb250ZXh0Lml0ZW1zLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICBwcm9kdWN0SWRzLnB1c2goY29udGV4dC5pdGVtc1tpXS5wcm9kdWN0X2lkKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgdG90YWwgPSBjb250ZXh0LmRhdGEudG90YWwgfHwgMDtcbiAgICAgIGNvbnN0IHNoaXBwaW5nID0gY29udGV4dC5kYXRhLnNoaXBwaW5nIHx8IDA7XG4gICAgICBcbiAgICAgIHRoaXMuZmFjZWJvb2sudHJhY2soJ1B1cmNoYXNlJywgZmFsc2UsIHtcbiAgICAgICAgdmFsdWU6IHBhcnNlRmxvYXQodG90YWwpIC0gcGFyc2VGbG9hdChzaGlwcGluZyksXG4gICAgICAgIGN1cnJlbmN5OiAnVVNEJyxcbiAgICAgICAgY29udGVudF9pZHM6IHByb2R1Y3RJZHMsXG4gICAgICAgIGNvbnRlbnRfdHlwZTogJ3Byb2R1Y3QnXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IEJhc2VSdWxlIGZyb20gJy4vYmFzZS1ydWxlLmpzJztcbmltcG9ydCBGYWNlYm9vayBmcm9tICcuLi9zZXJ2aWNlcy9mYWNlYm9vayc7XG5cbi8qKlxuICogQGNsYXNzXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFZpZXdDb250ZW50UnVsZSBleHRlbmRzIEJhc2VSdWxlIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7d2luZG93fSB3aW5kb3cgLSBCcm93c2VyIHdpbmRvdyBvYmplY3RcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKi9cbiAgY29uc3RydWN0b3Iod2luZG93KSB7XG4gICAgc3VwZXIod2luZG93KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICBpbml0KGZhY2Vib29rKSB7XG4gICAgc3VwZXIuaW5pdChmYWNlYm9vayk7XG4gICAgXG4gICAgdGhpcy5saXN0ZW4oJ3ZpZXctY29udGVudCcsIChjb250ZXh0KSA9PiB7XG4gICAgICB0aGlzLmZhY2Vib29rLnRyYWNrKCdWaWV3Q29udGVudCcsIGZhbHNlLCB7XG4gICAgICAgIGNvbnRlbnRfaWRzOiBjb250ZXh0LmlkLFxuICAgICAgICBjb250ZW50X3R5cGU6IGNvbnRleHQudHlwZVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIGpzQ29va2llIGZyb20gJ2pzLWNvb2tpZSc7XG5cbi8qKlxuICogQWJzdHJhY3QgQ29va2llIG9iamVjdFxuICogQGNsYXNzIEJhc2VDb29raWVcbiAqIEBhdXRob3IgUm9iIEthdWZtYW5uIDxyb2JAZ2V0c2lkZWNhci5jb20+XG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJhc2VDb29raWUge1xuICAvKipcbiAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgLSBDb29raWUgbmFtZVxuICAgKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICBjb25zdHJ1Y3RvcihuYW1lKSB7XG4gICAgLy8gRmFrZSBhYnN0cmFjdFxuICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBCYXNlQ29va2llKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY29uc3RydWN0IEJhc2VDb29raWUgaW5zdGFuY2VzIGRpcmVjdGx5LicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1hY2hpbmUgbmFtZSBmb3IgY29va2llXG4gICAgICogQHR5cGUge1N0cmluZ31cbiAgICAgKi9cbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiB0aGUgY29udGVudHMgb2YgdGhlIGNvb2tpZSBpbiBKU09OXG4gICAqXG4gICAqIEByZXR1cm5zIHtPYmplY3R9XG4gICAqL1xuICBnZXQoKSB7XG4gICAgcmV0dXJuIGpzQ29va2llLmdldEpTT04odGhpcy5uYW1lKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIHZhbHVlIG9mIGEgZmllbGQgaW4gdGhlIGNvb2tpZVxuICAgKlxuICAgKiBAcGFyYW0ge0FycmF5fSBmaWVsZHMgLSBBcnJheSBvZiBkZXNpcmVkIGZpZWxkcyBpbiBoaWVyYXJjaGljYWwgb3JkZXJcbiAgICpcbiAgICogQHJldHVybiB7Kn1cbiAgICovXG4gIGdldEZpZWxkKGZpZWxkcykge1xuICAgIGlmIChmaWVsZHMuY29uc3RydWN0b3IgIT09IEFycmF5KSB7XG4gICAgICBmaWVsZHMgPSBbZmllbGRzXTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX2dldEZpZWxkKGZpZWxkcywgdGhpcy5nZXQoKSk7XG4gIH1cblxuICAvKipcbiAgICogUmVjdXJzZSB0aHJvdWdoIHByb3ZpZGVkIGRhdGEgYW5kIHJldHVybiByZXF1ZXN0ZWQgdmFsdWUuXG4gICAqXG4gICAqIEBwYXJhbSB7QXJyYXl9IGZpZWxkcyAtIEFycmF5IG9mIGRlc2lyZWQgZmllbGRzIGluIGhpZXJhcmNoaWNhbCBvcmRlclxuICAgKiBAcGFyYW0geyp9ICAgICBkYXRhICAgLSBPYmplY3QgdG8gYmUgc2VhcmNoZWQgb3IgdmFsdWUgdG8gYmUgcmV0dXJuZWRcbiAgICogaWYgZmllbGRzIGlzIGVtcHR5XG4gICAqXG4gICAqIEByZXR1cm4geyp9XG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBfZ2V0RmllbGQoZmllbGRzLCBkYXRhKSB7XG4gICAgaWYgKCFmaWVsZHMgfHwgZmllbGRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBkYXRhICE9PSAnb2JqZWN0Jykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjb25zdCBmaWVsZCA9IGZpZWxkcy5zaGlmdCgpO1xuICAgIHJldHVybiB0aGlzLl9nZXRGaWVsZChmaWVsZHMsIGRhdGFbZmllbGRdKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb250ZW50IG9mIGNvb2tpZVxuICAgKlxuICAgKiBAcGFyYW0geyp9IHZhbHVlIC0gVmFsdWUgdG8gYmUgYXNzaWduZWQgdG8gY29va2llXG4gICAqXG4gICAqIEByZXR1cm4ge1N0cmluZ30gLSBTZXJpYWxpemVkIGNvb2tpZVxuICAgKi9cbiAgc2V0KHZhbHVlKSB7XG4gICAgcmV0dXJuIGpzQ29va2llLnNldCh0aGlzLm5hbWUsIHZhbHVlLCB0aGlzLm9wdGlvbnMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgYSBmaWVsZCBpbiB0aGUgY29va2llLlxuICAgKiBUaGUgbW9kaWZpZXIgY2FuIGVpdGhlciBiZSBhIGZ1bmN0aW9uIHRvIGJlIGFwcGxpZWQgdG8gdGhlXG4gICAqIGZpZWxkIG9yIGEgdmFsdWUuXG4gICAqXG4gICAqIEBwYXJhbSB7QXJyYXl9IGZpZWxkcyAgIC0gQXJyYXkgb2YgZGVzaXJlZCBmaWVsZHMgaW4gaGVpcmFyY2hpY2FsIG9yZGVyXG4gICAqIEBwYXJhbSB7Kn0gICAgIG1vZGlmaWVyIC0gTmV3IHZhbHVlIGZvciBnaXZlbiBmaWVsZC4gIElmIGEgZnVuY3Rpb24gaXNcbiAgICogcGFzc2VkIHRoZW4gaXQgaXMgYXBwbGllZCB0byB0aGUgY3VycmVudCB2YWx1ZSBhbmQgdGhlIHJlc3VsdCBpcyBzYXZlZFxuICAgKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICBzZXRGaWVsZChmaWVsZHMsIG1vZGlmaWVyKSB7XG4gICAgaWYgKCF0aGlzLmdldCgpKSB7XG4gICAgICB0aGlzLmluaXQoKTtcbiAgICB9XG5cbiAgICBpZiAoZmllbGRzLmNvbnN0cnVjdG9yICE9PSBBcnJheSkge1xuICAgICAgZmllbGRzID0gW2ZpZWxkc107XG4gICAgfVxuXG4gICAgY29uc3QgcmVzdWx0ID0gdGhpcy5fc2V0RmllbGQoZmllbGRzLCBtb2RpZmllciwganNDb29raWUuZ2V0SlNPTih0aGlzLm5hbWUpKTtcbiAgICB0aGlzLnNldChyZXN1bHQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlY3Vyc2UgdGhyb3VnaCBkYXRhIGFuZCB1cGRhdGUgdGhlIGZpZWxkXG4gICAqXG4gICAqIEBwYXJhbSB7QXJyYXl9IGZpZWxkcyAgIC0gQXJyYXkgb2YgZGVzaXJlZCBmaWVsZHMgaW4gaGVpcmFyY2hpY2FsIG9yZGVyXG4gICAqIEBwYXJhbSB7Kn0gICAgIG1vZGlmaWVyIC0gTmV3IHZhbHVlIGZvciBnaXZlbiBmaWVsZC4gIElmIGEgZnVuY3Rpb24gaXNcbiAgICogcGFzc2VkIHRoZW4gaXQgaXMgYXBwbGllZCB0byB0aGUgY3VycmVudCB2YWx1ZSBhbmQgdGhlIHJlc3VsdCBpcyBzYXZlZFxuICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YSAgICAtIERhdGEgb2JqZWN0IHRvIGJlIHdhbGtlZCBmb3IgcmVxdWVzdGVkIGZpZWxkc1xuICAgKlxuICAgKiBAcmV0dXJuIHsqfVxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgX3NldEZpZWxkKGZpZWxkcywgbW9kaWZpZXIsIGRhdGEpIHtcbiAgICBpZiAoIWZpZWxkcyB8fCBmaWVsZHMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdXBkYXRlVmFsdWUoZGF0YSwgbW9kaWZpZXIpO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGRhdGEgPSB7fTtcbiAgICB9XG5cbiAgICBjb25zdCBmaWVsZCA9IGZpZWxkcy5zaGlmdCgpO1xuICAgIGRhdGFbZmllbGRdID0gdGhpcy5fc2V0RmllbGQoZmllbGRzLCBtb2RpZmllciwgZGF0YVtmaWVsZF0pO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgbmV3IHZhbHVlIGZvciBhIGZpZWxkIGluIHRoZSBjb29raWUuXG4gICAqIElmIG1vZGlmaWVyIGlzIGEgZnVuY3Rpb24gaXQgYXBwbGllZCBpdCB0byBkYXRhLlxuICAgKiBPdGhlcndpc2UgaXQgcmV0dXJucyB0aGUgbW9kaWZpZXIuXG4gICAqXG4gICAqIEBwYXJhbSB7Kn0gdmFsdWUgICAgLSBDdXJyZW50IHZhbHVlIGZyb20gY29va2llXG4gICAqIEBwYXJhbSB7Kn0gbW9kaWZpZXIgLSBFaXRoZXIgYSBuZXcgdmFsdWUgdG8gYmUgc3RvcmVkIGluIHRoZSBjb29raWUgb3JcbiAgICogYSBmdW5jdGlvbiB0byBiZSBhcHBsaWVkIHRvIGN1cnJlbnQgZnVuY3Rpb25cbiAgICpcbiAgICogQHJldHVybiB7Kn1cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICovXG4gIF91cGRhdGVWYWx1ZSh2YWx1ZSwgbW9kaWZpZXIpIHtcbiAgICBpZiAodHlwZW9mIG1vZGlmaWVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICByZXR1cm4gbW9kaWZpZXIodmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gbW9kaWZpZXI7XG4gIH1cblxuICAvKipcbiAgICogRGVsZXRlIGNvb2tpZSBhbmQgcmVpbml0aWFsaXplXG4gICAqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIHJlc2V0KCkge1xuICAgIHRoaXMucmVtb3ZlKCk7XG4gICAgdGhpcy5pbml0KCk7XG4gIH1cblxuICAvKipcbiAgICogRGVsZXRlIGNvb2tpZVxuICAgKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICByZW1vdmUoKSB7XG4gICAganNDb29raWUucmVtb3ZlKHRoaXMubmFtZSk7XG4gIH1cbn1cbiIsImltcG9ydCBCYXNlQ29va2llIGZyb20gJy4vYmFzZSc7XG5pbXBvcnQgQ29uZmlnIGZyb20gJy4uLy4uL2NvbmZpZyc7XG5cbi8qKlxuICogQHR5cGUge1N0cmluZ31cbiAqIEBjb25zdGFudFxuICogQGRlZmF1bHRcbiAqL1xuZXhwb3J0IGNvbnN0IE5hbWUgPSAnc2NfZmInO1xuXG4vKipcbiAqIEBjb25zdGFudFxuICogQGRlZmF1bHRcbiAqL1xuZXhwb3J0IGNvbnN0IEZpZWxkcyA9IHtcbiAgLy8gVXRpbFxuICB2ZXJzaW9uOiAndicsXG5cbiAgLy8gR2VuZXJhbFxuICB0aW1lT25TaXRlOiAndCcsXG4gIG1heFRpbWVPblNpdGU6IDEwMDAwLFxuICBwYWdldmlld3M6ICdwJyxcbiAgbWF4UGFnZVZpZXdzOiAxMDAsXG4gIHNlc3Npb25zOiAncycsXG4gIG1heFNlc3Npb25zOiAxMDAsXG5cbiAgLy8gQnJhbmRzXG4gIGJyYW5kczogJ2InLFxuXG4gIC8vIFByb2R1Y3RzXG4gIHByb2R1Y3RzOiAncHYnLFxuICBtYXhQcm9kdWN0czogMjUsXG4gIHByb2R1Y3RWaWV3czogJ3YnLFxuICBtYXhQcm9kdWN0Vmlld3M6IDEwMCxcbiAgcHJvZHVjdElkOiAnaScsXG5cbiAgLy8gVHJhbnNhY3Rpb25zXG4gIHRyYW5zYWN0aW9uczogJ3RyJyxcbiAgbWF4VHJhbnNhY3Rpb25zOiAxMDAsXG5cbiAgLy8gRXZlbnRzXG4gIHRyYWNrZWRFdmVudHM6ICdlJ1xufTtcblxuLyoqXG4gKiBDb29raWUgdXNlZCB0byBzdG9yZSBsb2NhbCB1c2VyIHN0YXRlLlxuICpcbiAqIEBjbGFzc1xuICovXG5jbGFzcyBNYWluQ29va2llIGV4dGVuZHMgQmFzZUNvb2tpZSB7XG4gIC8qKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcihOYW1lKTtcblxuICAgIC8qKiBAdHlwZSB7T2JqZWN0fSBDb29raWUgb3B0aW9ucyAqL1xuICAgIHRoaXMub3B0aW9ucyA9IHsgZXhwaXJlczogQ29uZmlnLmV4cGlyZXMgfTtcblxuICAgIGlmICghdGhpcy5nZXQoKSkge1xuICAgICAgdGhpcy5pbml0KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgdGhlIGNvb2tpZSB3aXRoIGRlZmF1bHQgdmFsdWVzXG4gICAqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIGluaXQoKSB7XG4gICAgY29uc3QgY29udGVudCA9IHt9O1xuICAgIGNvbnRlbnRbRmllbGRzLnZlcnNpb25dID0gQ29uZmlnLnZlcnNpb247XG4gICAgY29udGVudFtGaWVsZHMudGltZU9uU2l0ZV0gPSAwO1xuICAgIGNvbnRlbnRbRmllbGRzLnBhZ2V2aWV3c10gPSAwO1xuICAgIGNvbnRlbnRbRmllbGRzLnNlc3Npb25zXSA9IDA7XG4gICAgY29udGVudFtGaWVsZHMuYnJhbmRzXSA9IFtdO1xuICAgIGNvbnRlbnRbRmllbGRzLnByb2R1Y3RzXSA9IFtdO1xuICAgIGNvbnRlbnRbRmllbGRzLnRyYW5zYWN0aW9uc10gPSAwO1xuICAgIGNvbnRlbnRbRmllbGRzLnRyYWNrZWRFdmVudHNdID0gW107XG5cbiAgICB0aGlzLnNldChjb250ZW50KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBuZXcgTWFpbkNvb2tpZSgpO1xuIiwiaW1wb3J0IEJhc2VDb29raWUgZnJvbSAnLi9iYXNlJztcblxuLyoqIEB0eXBlIHtTdHJpbmd9IFNlc3Npb24gY29va2llIG5hbWUgKi9cbmV4cG9ydCBjb25zdCBOYW1lID0gJ3NjX2ZiX3Nlc3Npb24nO1xuXG4vKiogQHR5cGUge09iamVjdH0gTWFwcGluZyBvZiBjb29raWUgZmllbGRzICovXG5leHBvcnQgY29uc3QgRmllbGRzID0ge1xuICBjcmVhdGVkOiAnYydcbn07XG5cbi8qKlxuICogQ29va2llIHVzZWQgdG8ga2VlcCB0cmFjayBvZiB1c2VyIHNlc3Npb25zLlxuICpcbiAqIEBjbGFzc1xuICovXG5jbGFzcyBTZXNzaW9uQ29va2llIGV4dGVuZHMgQmFzZUNvb2tpZSB7XG5cbiAgLyoqXG4gICAqIEBvdmVycmlkZVxuICAgKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcihOYW1lKTtcbiAgfVxuXG59XG5cbmV4cG9ydCBkZWZhdWx0IG5ldyBTZXNzaW9uQ29va2llKCk7XG4iLCJpbXBvcnQgQmFzZUNvb2tpZSBmcm9tICcuL2Jhc2UnO1xuXG4vKiogQHR5cGUge1N0cmluZ30gU2Vzc2lvbiBjb29raWUgbmFtZSAqL1xuZXhwb3J0IGNvbnN0IE5hbWUgPSAnX3Nja2V5JztcblxuLyoqXG4gKiBDb29raWUgdXNlZCBieSBTaWRlY2FySlMgdG8gdHJhY2sgc2Vzc2lvbnMuXG4gKlxuICogQGNsYXNzXG4gKi9cbmNsYXNzIFNpZGVjYXJLZXlDb29raWUgZXh0ZW5kcyBCYXNlQ29va2llIHtcblxuICAvKipcbiAgICogQG92ZXJyaWRlXG4gICAqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKE5hbWUpO1xuICB9XG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgbmV3IFNpZGVjYXJLZXlDb29raWUoKTtcbiIsImltcG9ydCBDb25maWcgZnJvbSAnLi4vY29uZmlnJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZGVidWcobWVzc2FnZSkge1xuICBpZighIUNvbmZpZy5kZWJ1Zykge1xuICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UpO1xuICB9XG59O1xuIiwiLyogZXNsaW50IG5vLWxvb3AtZnVuYzogMCAqL1xuXG4vKipcbiAqIEBjbGFzc1xuICovXG5jbGFzcyBFdmVudE1hbmFnZXIge1xuICAvKipcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKi9cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgLyoqIEB0eXBlIHtTdHJpbmd9ICovXG4gICAgdGhpcy5kZWZhdWx0Um91dGUgPSAnZGVmYXVsdCc7XG5cbiAgICAvKiogQHR5cGUge09iamVjdH0gKi9cbiAgICB0aGlzLmxpc3RlbmVycyA9IHt9O1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7QXJyYXl9ICAgIGxpc3RlbmVycyAtIFJlZ2lzdGVyZWQgbGlzdGVuZXJzXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IHRhcmdldCAgICAtIEZ1bmN0aW9uIHRvIHNlYXJjaCBmb3JcbiAgICpcbiAgICogQHJldHVybiB7RnVuY3Rpb258dW5kZWZpbmVkfVxuICAgKi9cbiAgZmluZExpc3RlbmVyKGxpc3RlbmVycywgdGFyZ2V0KSB7XG4gICAgaWYgKCFsaXN0ZW5lcnMgfHwgIXRhcmdldCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGZvciAobGV0IGkgPSAwLCBsID0gbGlzdGVuZXJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgaWYgKGxpc3RlbmVyc1tpXS5jYWxsYmFjayA9PT0gdGFyZ2V0KSB7XG4gICAgICAgIHJldHVybiBsaXN0ZW5lcnNbaV07XG4gICAgICB9XG4gICAgfVxuICB9XG5cblxuICAvKipcbiAgICogQHBhcmFtIHtTdHJpbmd9ICAgbmFtZXNwYWNlIC0gTmFtZXNwYWNlIGlkZW50aWZpZXIgZm9yIGV2ZW50XG4gICAqIEBwYXJhbSB7U3RyaW5nfSAgIHJvdXRlICAgICAtIFJvdXRlIGlkZW50aWZpZXIgZm9yIGV2ZW50XG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrICAtIEZ1bmN0aW9uIHRvIGJlIGNhbGxlZCB3aGVuIGV2ZW50IGlzIGVtaXR0ZWRcbiAgICogQHBhcmFtIHtCb29sZWFufSAgb25jZSAgICAgIC0gV2hldGhlciBvciBub3QgdGhlIGNhbGxiYWNrIHNob3VsZCBvbmx5IGJlIHRyaWdnZXJlZCBvbmNlXG4gICAqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIGxpc3RlbihuYW1lc3BhY2UsIHJvdXRlLCBjYWxsYmFjaywgb25jZSkge1xuICAgIG9uY2UgPSBvbmNlIHx8IGZhbHNlO1xuXG4gICAgLy8gVmVyaWZ5IGFsbCByZXF1aXJlbWVudHMgYXJlIG1ldFxuICAgIGlmICghbmFtZXNwYWNlIHx8ICFjYWxsYmFjaykge1xuICAgICAgdGhyb3cgRXJyb3IoJ05hbWVzcGFjZSBhbmQgY2FsbGJhY2sgYXJlIHJlcXVpcmVkLicpO1xuICAgIH1cbiAgICByb3V0ZSA9IHJvdXRlIHx8IHRoaXMuZGVmYXVsdFJvdXRlO1xuXG4gICAgaWYgKCF0aGlzLmxpc3RlbmVyc1tuYW1lc3BhY2VdKSB7XG4gICAgICB0aGlzLmxpc3RlbmVyc1tuYW1lc3BhY2VdID0ge307XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmxpc3RlbmVyc1tuYW1lc3BhY2VdW3JvdXRlXSkge1xuICAgICAgdGhpcy5saXN0ZW5lcnNbbmFtZXNwYWNlXVtyb3V0ZV0gPSBbXTtcbiAgICB9XG5cbiAgICAvLyBFeGl0IGlmIGxpc3RlbmVyIGlzIGFscmVhZHkgcmVnaXN0ZXJlZFxuICAgIGlmICh0aGlzLmZpbmRMaXN0ZW5lcih0aGlzLmxpc3RlbmVyc1tuYW1lc3BhY2VdW3JvdXRlXSwgY2FsbGJhY2spKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5saXN0ZW5lcnNbbmFtZXNwYWNlXVtyb3V0ZV0ucHVzaCh7Y2FsbGJhY2s6IGNhbGxiYWNrLCBvbmNlOiBvbmNlfSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtTdHJpbmd9ICAgbmFtZXNwYWNlIC0gTmFtZXNwYWNlIGlkZW50aWZpZXIgZm9yIGV2ZW50XG4gICAqIEBwYXJhbSB7U3RyaW5nfSAgIHJvdXRlICAgICAtIFJvdXRlIGlkZW50aWZpZXIgZm9yIGV2ZW50XG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrICAtIEZ1bmN0aW9uIHRvIGJlIGNhbGxlZCB3aGVuIGV2ZW50IGlzIGVtaXR0ZWRcbiAgICpcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKi9cbiAgbGlzdGVuT25jZShuYW1lc3BhY2UsIHJvdXRlLCBjYWxsYmFjaykge1xuICAgIHRoaXMubGlzdGVuKG5hbWVzcGFjZSwgcm91dGUsIGNhbGxiYWNrLCB0cnVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge1N0cmluZ30gICBuYW1lc3BhY2UgLSBOYW1lc3BhY2UgaWRlbnRpZmllciBmb3IgZXZlbnRcbiAgICogQHBhcmFtIHtTdHJpbmd9ICAgcm91dGUgICAgIC0gUm91dGUgaWRlbnRpZmllciBmb3IgZXZlbnRcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gdGFyZ2V0ICAgIC0gRnVuY3Rpb24gdG8gYmUgcmVtb3ZlZCBmcm9tIGxpc3RlbmVycyBhcnJheVxuICAgKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICByZW1vdmUobmFtZXNwYWNlLCByb3V0ZSwgdGFyZ2V0KSB7XG4gICAgaWYgKCF0aGlzLmxpc3RlbmVyc1tuYW1lc3BhY2VdIHx8ICF0aGlzLmxpc3RlbmVyc1tuYW1lc3BhY2VdW3JvdXRlXSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMubGlzdGVuZXJzW25hbWVzcGFjZV1bcm91dGVdO1xuICAgIGNvbnN0IHVwZGF0ZWRMaXN0ZW5lcnMgPSBbXTtcblxuICAgIGZvciAobGV0IGkgPSAwLCBsID0gbGlzdGVuZXJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgaWYgKGxpc3RlbmVyc1tpXS5jYWxsYmFjayAhPT0gdGFyZ2V0KSB7XG4gICAgICAgIHVwZGF0ZWRMaXN0ZW5lcnMucHVzaChsaXN0ZW5lcnNbaV0pO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLmxpc3RlbmVyc1tuYW1lc3BhY2VdW3JvdXRlXSA9IHVwZGF0ZWRMaXN0ZW5lcnM7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWVzcGFjZSAtIE5hbWVzcGFjZSBpZGVudGlmaWVyIGZvciBldmVudFxuICAgKiBAcGFyYW0ge1N0cmluZ30gcm91dGUgICAgIC0gUm91dGUgaWRlbnRpZmllciBmb3IgZXZlbnRcbiAgICogQHBhcmFtIHsqfSAgICAgIGNvbnRleHQgICAtIERhdGEgdG8gYmUgcGFzc2VkIHRvIGNhbGxiYWNrXG4gICAqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIHRyaWdnZXIobmFtZXNwYWNlLCByb3V0ZSwgY29udGV4dCkge1xuICAgIHJvdXRlID0gcm91dGUgfHwgdGhpcy5kZWZhdWx0Um91dGU7XG5cbiAgICAvLyBCdWcgb3V0IGlmIG5vIHZhbGlkIGxpc3RlbmVyc1xuICAgIGlmICghdGhpcy5saXN0ZW5lcnNbbmFtZXNwYWNlXSB8fCAhdGhpcy5saXN0ZW5lcnNbbmFtZXNwYWNlXVtyb3V0ZV0pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB0YXJnZXRMaXN0ZW5lcnMgPSB0aGlzLmxpc3RlbmVyc1tuYW1lc3BhY2VdW3JvdXRlXTtcbiAgICBjb25zdCByZW1vdmVMaXN0ZW5lciA9IHRoaXMucmVtb3ZlO1xuXG4gICAgZm9yIChsZXQgaSA9IDAsIGwgPSB0YXJnZXRMaXN0ZW5lcnMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAoKGxpc3RlbmVycywgaWR4KSA9PiB7XG4gICAgICAgIGNvbnN0IHJlZiA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsaXN0ZW5lcnNbaWR4XS5jYWxsYmFjayhjb250ZXh0KTtcbiAgICAgICAgICAgIGlmIChsaXN0ZW5lcnNbaWR4XS5vbmNlID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgIHJlbW92ZUxpc3RlbmVyLmNhbGwodGhpcywgbmFtZXNwYWNlLCByb3V0ZSwgbGlzdGVuZXJzW2lkeF0uY2FsbGJhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHJlZik7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KSh0YXJnZXRMaXN0ZW5lcnMsIGkpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBuZXcgRXZlbnRNYW5hZ2VyKCk7XG4iLCIvKiBlc2xpbnQtZGlzYWJsZSAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih3aW5kb3cpIHtcbiAgcmV0dXJuICFmdW5jdGlvbihmLGIsZSx2LG4sdCxzKXtpZihmLmZicSlyZXR1cm47bj1mLmZicT1mdW5jdGlvbigpe24uY2FsbE1ldGhvZD9cbiAgICBuLmNhbGxNZXRob2QuYXBwbHkobixhcmd1bWVudHMpOm4ucXVldWUucHVzaChhcmd1bWVudHMpfTtpZighZi5fZmJxKWYuX2ZicT1uO1xuICAgIG4ucHVzaD1uO24ubG9hZGVkPSEwO24udmVyc2lvbj0nMi4wJztuLnF1ZXVlPVtdO3Q9Yi5jcmVhdGVFbGVtZW50KGUpO3QuYXN5bmM9ITA7XG4gICAgdC5zcmM9djtzPWIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoZSlbMF07cy5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0LHMpfSh3aW5kb3csXG4gICAgZG9jdW1lbnQsJ3NjcmlwdCcsJ2h0dHBzOi8vY29ubmVjdC5mYWNlYm9vay5uZXQvZW5fVVMvZmJldmVudHMuanMnKTtcbn07XG4vKiBlc2xpbnQtZW5hYmxlICovXG4iLCJpbXBvcnQgQ29uZmlnIGZyb20gJy4uLy4uL2NvbmZpZyc7XG5pbXBvcnQgZGVidWcgZnJvbSAnLi4vZGVidWcnO1xuXG4vKipcbiAqIEBjbGFzc1xuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGYWNlYm9vayB7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7d2luZG93fSB3aW5kb3cgLSBCcm93c2VyIHdpbmRvdyBvYmplY3RcbiAgICpcbiAgICogQHJldHVybiB7dW5kZWZpbmVkfVxuICAgKi9cbiAgY29uc3RydWN0b3Iod2luZG93KSB7XG4gICAgLyoqIEB0eXBlIHt3aW5kb3d9IC0gQnJvd3NlciB3aW5kb3cgb2JqZWN0ICoqL1xuICAgIHRoaXMud2luZG93ID0gd2luZG93O1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgRmFjZWJvb2sgc2VydmljZVxuICAgKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICBpbml0KCkge1xuICAgIGRlYnVnKCdJbml0IEZhY2Vib29rJyk7XG4gICAgaWYgKCFDb25maWcucGl4ZWxJZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMubG9hZCgpO1xuXG4gICAgaWYgKENvbmZpZy5pZ25vcmVFdmVudHMuaW5kZXhPZignaW5pdCcpID09PSAtMSkge1xuICAgICAgZGVidWcoYFNlbmRpbmcgRmFjZWJvb2sgaW5pdCBmb3IgcGl4ZWw6ICR7Q29uZmlnLnBpeGVsSWR9YCk7XG4gICAgICB0aGlzLndpbmRvdy5mYnEoJ2luaXQnLCBDb25maWcucGl4ZWxJZCk7XG4gICAgfVxuICB9XG5cblxuICAvKipcbiAgICogTG9hZCB0aGUgRmFjZWJvb2sgdHJhY2tpbmcgY29kZVxuICAgKlxuICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9XG4gICAqL1xuICBsb2FkKCkge1xuICAgIGlmICghdGhpcy53aW5kb3cuZmJxKSB7XG4gICAgICByZXF1aXJlKCcuL2ZicScpKHRoaXMud2luZG93KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2VuZCB0cmFja2luZyBpbmZvcm1hdGlvbiB0byBGYWNlYm9va1xuICAgKlxuICAgKiBOb3RlOiBCYXNpYyBGYWNlYm9va2UgZXZlbnRzIHdpbGwgbm90IGJlIHNlbnQgaWYgYGlnbm9yZUJhc2ljRXZlbnRzYFxuICAgKiBpcyBzZXQgaW4gdGhlIGNvbmZpZ3VyYXRpb24uXG4gICAqXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lICAgIC0gRXZlbnQgbmFtZVxuICAgKiBAcGFyYW0ge0Jvb2xlYW59IGN1c3RvbSAtIFdoZXRoZXIgb3Igbm90IHRoaXMgaXMgYSBjdXN0b20gRmFjZWJvb2sgZXZlbnRcbiAgICogQHBhcmFtIHtPYmplY3R9IGNvbnRleHQgLSBFdmVudCBjb250ZXh0XG4gICAqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIHRyYWNrKG5hbWUsIGN1c3RvbSA9IGZhbHNlLCBjb250ZXh0ID0ge30pIHtcbiAgICBpZiAoIUNvbmZpZy5waXhlbElkIHx8IENvbmZpZy5pZ25vcmVFdmVudHMuaW5kZXhPZihuYW1lKSAhPT0gLTEpIHtcbiAgICAgIFxuICAgICAgZGVidWcoYFNraXBwaW5nIFRyYWNraW5nOiAke25hbWV9YCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIGRlYnVnKGBUcmFja2luZzogJHtuYW1lfWApO1xuXG4gICAgY29uc3QgdHlwZSA9IChjdXN0b20pID8gJ3RyYWNrQ3VzdG9tJyA6ICd0cmFjayc7XG4gICAgdGhpcy53aW5kb3cuZmJxKHR5cGUsIG5hbWUsIGNvbnRleHQpO1xuICB9XG59XG4iLCIvKipcbiAqIEBjbGFzc1xuICovXG5jbGFzcyBQYWdlVXRpbHMge1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2RvY3VtZW50fSBkb2N1bWVudCAtIEJyb3dzZXIgZG9jdW1lbnQgb2JqZWN0XG4gICAqXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cbiAgICovXG4gIGNvbnN0cnVjdG9yKGRvY3VtZW50KSB7XG4gICAgLyoqXG4gICAgICogQHR5cGUge2RvY3VtZW50fSBCcm93c2VyIGRvY3VtZW50IG9iamVjdFxuICAgICAqL1xuICAgIHRoaXMuZG9jdW1lbnQgPSBkb2N1bWVudDtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtTdHJpbmd9IE5hbWUgb2YgZG9jdW1lbnQgcHJvcGVydHkgYmFzZWQgb24gZGV0ZWN0ZWQgYnJvd3NlclxuICAgICAqL1xuICAgIHRoaXMuaGlkZGVuID0gbnVsbDtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtTdHJpbmd9IE5hbWUgb2YgZXZlbnQgc2lnbmFsaW5nIGEgY2hhbmdlIGluIHZpc2libGl0eSBiYXNlZCBvbiBkZXRlY3RlZCBicm93c2VyXG4gICAgICovXG4gICAgdGhpcy52aXNpYmlsaXR5Q2hhbmdlID0gbnVsbDtcblxuICAgIC8vIE9wZXJhIDEyLjEwIGFuZCBGaXJlZm94IDE4XG4gICAgaWYgKHR5cGVvZiBkb2N1bWVudC5oaWRkZW4gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB0aGlzLmhpZGRlbiA9ICdoaWRkZW4nO1xuICAgICAgdGhpcy52aXNpYmlsaXR5Q2hhbmdlID0gJ3Zpc2liaWxpdHljaGFuZ2UnO1xuICAgIC8vIEZpcmVmb3ggMTgrXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZG9jdW1lbnQubW96SGlkZGVuICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgdGhpcy5oaWRkZW4gPSAnbW96SGlkZGVuJztcbiAgICAgIHRoaXMudmlzaWJpbGl0eUNoYW5nZSA9ICdtb3p2aXNpYmlsaXR5Y2hhbmdlJztcbiAgICAvLyBJRVxuICAgIH0gZWxzZSBpZiAodHlwZW9mIGRvY3VtZW50Lm1zSGlkZGVuICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgdGhpcy5oaWRkZW4gPSAnbXNIaWRkZW4nO1xuICAgICAgdGhpcy52aXNpYmlsaXR5Q2hhbmdlID0gJ21zdmlzaWJpbGl0eWNoYW5nZSc7XG4gICAgLy8gU2FmYXJpIGFuZCBDaHJvbWVcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBkb2N1bWVudC53ZWJraXRIaWRkZW4gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB0aGlzLmhpZGRlbiA9ICd3ZWJraXRIaWRkZW4nO1xuICAgICAgdGhpcy52aXNpYmlsaXR5Q2hhbmdlID0gJ3dlYmtpdHZpc2liaWxpdHljaGFuZ2UnO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgKi9cbiAgaXNWaXNpYmxlKCkge1xuICAgIHJldHVybiAhdGhpcy5kb2N1bWVudFt0aGlzLmhpZGRlbl07XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgbmV3IFBhZ2VVdGlscyh3aW5kb3cuZG9jdW1lbnQpO1xuIl19
