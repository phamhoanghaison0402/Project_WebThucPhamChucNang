(function(){window.extole=window.extole||{};var m;m="https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915".replace(/^https?:/,"");void 0===extole.DEBUG_MODE&&(extole.DEBUG_MODE=!0);void 0===extole.DEBUG_MODE&&(extole.DEBUG_MODE=!1);void 0===extole.suppressLog&&(extole.suppressLog=!1===extole.DEBUG_MODE&&"pr"==extole.env);var r="";location&&"file:"==location.protocol&&(r="http:");extole.MEDIA_SERVER=r+m;extole.VERSION="v4-1.73.0.3010-20161219";extole.MAJOR_VERSION="v4";
extole.MINOR_VERSION="1.73.0.3010-20161219";extole.createZone=function(c,g){extole.require(["create-zone"],function(f){f(c,g)})};extole.define||function(){function c(){}function g(){var a="undefined"!==typeof opera&&"[object Opera]"===opera.toString(),d=document.createElement("script");this.useInteractive=d.attachEvent&&!(d.attachEvent.toString&&0>d.attachEvent.toString().indexOf("[native code"))&&!a}var f=[],l=function(a){var h;d(f,function(d){if(d.url==a)return h=d,!1});return h},b=function(a){"undefined"!==
typeof window.console&&console.log(a)},e=function(a){String(extole.DEBUG_MODE).match(/(^|,\s*)require($|\s*,)/g)&&b("[REQUIRE DEBUG] "+a)},a=function(a){b("[REQUIRE ERROR] "+a)},d=function(a,d){if(a.length)for(var h=0;h<a.length;h++)d(a[h],h);else for(h in a)a.hasOwnProperty(h)&&d(a[h],h)},h=function(a,h){var e=[];d(a,function(a,d){e[d]=h(a,d)});return e},n=function(a){var d=!!a.match(/^extole-creatives:/),h=!!a.match(/^extole-media:/),e=!!a.match(/^core-root:\/\//),b=!!a.match(/^extole-assets:/),
k=!!a.match(/^http:/),c=!!a.match(/^https:/);return d?(a=a.slice(17),n("extole-assets:/core-modules/"+a)):b?(a=a.slice(14),a="extole-media:/assets/"+a,n(a)):h?(a=a.slice(13),a=extole.MEDIA_SERVER+a,n(a)):e?(a=a.slice(12),a=extole.MEDIA_SERVER+a,n(a)):k?(a=a.slice(5),n(a)):c?(a=a.slice(6),n(a)):a};c.prototype={getUnresolvedDependencies:function(){var a=[];d(this.dependencies,function(d){"$config"!=d&&(d=l(d),(!d||d&&!d._defined)&&a.push(d))});return a},getDependencies:function(){var a=this,h=[];d(a.dependencies,
function(d){d="$config"==d?a.config||null:l(d).definition||null;h.push(d)});return h},define:function(){var h=this;if(!h._defining&&!h._defined&&h.dependencies){h._defining=!0;clearTimeout(h.errorTimeout);var b=this.getUnresolvedDependencies();if(0<b.length)h.errorTimeout=setTimeout(function(){var e=[];d(b,function(a){a._defined||e.push(a.url)});a("dependencies not resolved for "+h.url+" - "+e.join(", "))},5E3),h._defining=!1;else{var k=function(a){h.definedCallback=void 0;h.definition=a;h.end=(new Date).getTime();
h.timeToDefine=h.end-h.start;h.timeToFetch&&e("Fetched "+h.url+" in "+h.timeToFetch+"ms");h.isAsync&&e("Defined async "+h.url+" in "+h.timeToDefine+"ms");h._defining=!1;h._defined=!0;setTimeout(x,1)},c=h.getDependencies(),n={isAsync:!1,async:function(){n.isAsync=h.isAsync=!0;return function(a){k(a)}}};(function(){if(h.definedCallback){var a=h.definedCallback,a=a&&a.apply(n,c);n.isAsync||k(a)}else k(!0)})()}}},fetch:function(){var d=this;d._fetching||d._fetched||(d.url?(d._fetching=!0,d.startFetchTime=
(new Date).getTime(),k.loadModule(d.url,function(){d._fetching=!1;d.endFetchTime=(new Date).getTime();d.timeToFetch=d.endFetchTime-d.startFetchTime;d._fetched=!0;d.define()})):a("Tried to fetch a module without a url - dependencies: "+d.dependencies+" definedCallback: "+(d.definedCallback?"exists":"null")+" config: "+d.config))}};g.prototype={defineQueue:[],interactiveScript:null,currentlyAddingScript:null,getInteractiveScript:function(){if(k.interactiveScript&&"interactive"==k.interactiveScript.readyState)return k.interactiveScript;
for(var a=document.getElementsByTagName("head")[0].getElementsByTagName("script"),d,h=a.length-1;0<=h;h--){var b=this.getScriptDataUrl(a[h]);a[h]&&"interactive"==a[h].readyState&&b&&(d=a[h],e("...interactive script "+d.src))}return d},scriptUrlAttributeName:"data-extole-require-url",getScriptDataUrl:function(a){return a.getAttribute(this.scriptUrlAttributeName)},setScriptDataUrl:function(a,d){a.setAttribute(this.scriptUrlAttributeName,d)},attachOnLoad:function(a,d){d=d||function(){};var h=this.useInteractive,
b="PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,k=function(c){var n=a.readyState;if(h&&"interactive"==n)interactiveScript=a;else if("load"===c.type||n.match(b))h?a.detachEvent("onreadystatechange",k):a.removeEventListener("load",k),e(a.src+" finished loading"),d(c)};h?a.attachEvent("onreadystatechange",k):a.addEventListener("load",k,!1)},defineTimeout:null,addDefine:function(d){if(d.url)d.url=n(d.url);else{e("defining anonymous module...");var b=this.currentlyAddingScript||
this.getInteractiveScript();this.useInteractive&&b?(b=this.getScriptDataUrl(b),e("..scriptToCompare has data url "+b),d.url=b,this.interactiveScript=null):this.useInteractive&&e("..found no scriptToCompare")}d.dependencies=h(d.dependencies,n);this.useInteractive&&!d.url&&a("defines should not be missing a url in ie.");this.defineQueue.push(d);this.defineTimeout&&clearTimeout(this.defineTimeout);var k=this;this.defineTimeout=setTimeout(function(){e("intakeDefines from addDefine timeout");k.intakeDefines()},
1)},intakeTimeout:null,intakeDefines:function(){for(var a={},h=function(d,h){a[d]=a[d]?a[d]+","+h:h},b=[],k;k=this.defineQueue.shift();){k.url.match(/\/config\/clients\/(\d+)\/creative_([0-9a-zA-Z\.]+)(\.(?=js)|\/)/);var c=[];d(k.dependencies,function(a){a&&c.push(a)});var n=k.url&&l(k.url);k.url?n?h(k.url,"updated"):h(k.url,"created"):b.push("deps "+k.dependencies);d(c,function(a){h(a,"dependency");y(a)});y(k.url,c,k.definedCallback,k.config,k.isRequire)}var f="intakeDefines -- ";d(a,function(a,
d){f+="\n - "+d+" "+a});f+="\n -- "+b.length+" anonymous modules created";d(b,function(a){f+="\n - "+a});e(f);this.intakeTimeout&&clearTimeout(this.intakeTimeout);this.intakeTimeout=setTimeout(x,1)},loadModule:function(d,h){var b=document.createElement("script");b.async=!0;b.crossOrigin="anonymous";this.setScriptDataUrl(b,d);var k=this;e("loading module "+d);this.attachOnLoad(b,function(){if(!k.useInteractive){for(var b,c=k.defineQueue.length-1;0<=c;c--)k.defineQueue[c].url||(b&&a("Multiple anonymous modules loaded in one script - "+
d),b=k.defineQueue[c]);b?(e("assigned "+d+" to anonymous module"),b.url=d):e("module url didn't define a module - "+d)}e("intake defines from loadModule");k.intakeDefines();h&&h(null)});b.src=d;this.currentlyAddingScript=b;document.getElementsByTagName("head")[0].appendChild(b);this.currentlyAddingScript=void 0}};var k=new g,x=function(){d(f,function(a){a._fetched?a._defined||a.define():a.fetch()})},y=function(a,d,h,b,e){if("$config"!=a){var k=l(a),n=k||new c;k||f.push(n);a&&d&&(n._fetched=!0);n.start=
n.start||(new Date).getTime();n.url=n.url||a;n.dependencies=n.dependencies||d;n.config=n.config||b;n.definedCallback=n.definedCallback||h;n.isRequire=n.isRequire||e}},p=function(a,d,h,b){a instanceof Array&&(b=h,h=d,d=a,a=void 0);k.addDefine({url:a,dependencies:d,definedCallback:h,config:b})};p.getModule=function(a){return l(a)};var q=0,v=function(){q++;return"anonymous_"+q};extole.define=p;extole.require=function(a,d){k.addDefine({url:v(),dependencies:a,definedCallback:d,isRequire:!0})};extole.define("extole-require",
[],function(){return{resolveUrl:n}})}();extole.define("ajax",["utils"],function(c){var g=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],f=function(b){if(b=b.match(/^([a-zA-Z]*:?\/\/)?([^/]+)/))return b[2]},l=function(b,e){var a=Array.prototype.slice.call(arguments),d=e.headers||{},h=e.xhrFields||{},n=e.url||"",k=e.data||"",g=(e.type||"get").toUpperCase(),
l=e.complete||function(){},p=e.error||function(){c.log("Error with url "+n+"=",a.join(","))},q=f(n),v=f(location.toString()),q=!(q&&v&&q==v),v=location.protocol.replace(":",""),w=n.match(/^(https?)/),w=w?w[1]:v,A=v.match(/^file/);v===w||A||(n=n.replace(w,v));(q="undefined"!=typeof XDomainRequest&&q)&&(b=new XDomainRequest);c.isPlainObject(k)&&("GET"==g?(n+=c.location.serialize(k),k=null):k=JSON.stringify(k));q?(b.open(g,n),b.onprogress=function(){},b.ontimeout=p,b.timeout=0):b.open(g,n,!0);c.extend(b,
h);q||c.each(d,function(a,d){try{b.setRequestHeader(d,a)}catch(h){c.log("AJAX ERROR: Couldn't set request header",d,"to",a)}});var u=!1;b.onerror=function(a){u||(u=!0,p.call(b,b.statusText,b.status))};d=function(){void 0!==b.readyState&&4!==b.readyState||u||(u=!0,String(b.status||200).match(/^[23]/)?"function"===typeof l?l.call(b,b.responseText):c.log("`complete` callback must be a function."):p.call(b,b.statusText,b.status))};b.onload=d;b.onreadystatechange=d;b.send(k)};return function(b){b=b||{};
var e;e=!1;for(var a=0;a<g.length;a++){try{e=g[a]()}catch(d){continue}break}l(e,b);return e}});extole.define("campaigns",["utils","campaigns/api","campaigns/campaign"],function(c,g,f){return c.extend(g,{campaign:f})});extole.define("campaigns/api",["utils","configuration","campaigns/campaign","request-zone","creative-javascript-api/render/JsZone"],function(c,g,f,l,b){var e={},a=function(a){var d=a.id;d||c.throwError("campaigns","No id passed for campaign.",a);e[d]=a},d=function(a){return f(e[a])},
h=function(a){var h;c.each(e,function(b,e){var f=d(e);if(f.wantsZone(a))return h=f.id,c.each.BREAK});if(h)return d(h);c.log("No campaign wanted zone "+a.getName()+", render cancelled")};g=g.get("CLIENT_CONFIG");c.each(g.campaigns,function(d,h){a(c.extend(d,{id:h}))});return{add:a,get:d,getByZone:h,renderZone:function(a,d){function e(a,h){var c=a.getName(),n=a.getParameters();a.campaign&&(n.campaign_id=a.campaign.id);l(c,n,function(h){h?d(h):d(null,new b({name:c,parameters:n,element:a.element}))})}
d=d||function(){};var c=h(a);c?c.renderZone(a,function(h,b){b&&b.isLegacyCreative||(h&&a.removeCampaignReferences(),e(a,d))}):(a.removeCampaignReferences(),e(a,d))}}});extole.define("campaigns/campaign",["utils","configuration","creatives","creative-javascript-api/render/JsCreativeContext"],function(c,g,f,l){var b={getConfig:function(){return g.get("CLIENT_CONFIG").campaigns[this.id]},wantsZone:function(b){var a=g.get("CLIENT_CONFIG"),d=b.getName(),h=c.location.deserialize(location.search);return b.type&&
"microsite"==b.type&&h.campaignId==this.id||b.data.campaign&&b.data.campaign==this.id||b.data.parameters&&b.data.parameters.campaign_id==this.id?!0:b.data.campaign?!1:(a=a.zone_defaults[d])&&a.campaign==this.id||b.fromUri&&this.getConfig()[b.getType()+"_creative"]?!0:!1},selectCreativeId:function(b){var a=g.get("CLIENT_CONFIG"),d=this.getConfig(),h=b.getType(),c,k=b.getData();b=a.zone_defaults[b.getName()]||{};a=a.cta_name_to_id||{};k.cta&&(c=a[k.cta.toLowerCase()]||k.cta);c||(c=k.creative);c||(c=
d[h+"_creative"]);c||(c=b.creative);return c},selectCreative:function(b,a){var d=this.selectCreativeId(b);d?f.get(d,function(h,b){var e;!h&&b&&(e=c.extend({id:d},b));a(h,e)}):a(Error("No creative id for zone "+b.getName()+" and campaign "+this.id))},renderZone:function(b,a){a=a||function(){};var d=this;b.elementReady(function(h,c){h?a(h):(b.campaign=d,d.selectCreative(b,function(d,h){if(d)a(d);else{if(h.isLegacyCreative)h.render(b);else{var c=new l(b);h.render(c)}a(null,h)}}))})},getName:function(){return this.name?
this.name:this.name=g.get("CLIENT_CONFIG").campaign_id_to_name[this.id]}};return function(e){var a=e;a.__created||(a=c.createObject(b),c.extend(a,e),a.__created=!0);return a}});(function(){var c=new Function('/*\nv2 Core autopop/redirect\nPromote links lead to microsites. But not all clients have microsites. This script makes Promote links work with those clients. It does two things:\n1- when it detects that it is being run on a microsite, it redirects to the client\'s own website, and adds an extole_zone_name parameter to the query string\n2- when it\'s not on a microsite, and it sees an extole_zone_name parameter (unless it also sees an xtl_zone_name param, which is what we use for friend landing coupons), it inserts an extole/widget tag on the page for that zone, with whatever other parameters it finds.\nBy default, the redirect will set extole_zone_name to the same zone as the microsite it\'s redirecting from, so /micro/microsite1 => extole_zone_name=microsite1\nBy default, the destination URL for the redirect will be the same as the microsite\'s domain, but with a www. subdomain, so refer.american-giant.com would go to www.american-giant.com\nExample non-default settings:\nvar redirectUrl = "awesome.mydomain.com";\nvar autopopZone = "";\nvar redirectAllMicrosites = false;\nvar micrositeZoneToAutopopZoneMap = {\n"microsite1" : "autopopZone1",\n"microsite4" : "autopopZone4"\n};\nWith these settings, only microsite1 and microsite4 would redirect, to autopopZone1 and autopopZone4 respectively, and they would redirect to "awesome.mydomain.com". A hypothetical microsite2 would load as a normal microsite.\n*//*\n(function(){\n    "use strict";\n    // IE broken console\n    if (!window.console) {window.console = {log: function() {}};}\n    // Customize autopop & redirect defaults\n    var redirectUrl="acorn.tv/featured";\n    var redirectAllMicrosites = true;\n    var autopopZone = "advocate_widget";\n    var micrositeZoneToAutopopZoneMap = {\n    };\n\n    var micrositeZone, queryParams, cookie, config, utils;\n    // load needed modules\n    extole.require(["utils", "cookie", "configuration"], function(utilities, jqCookie, configuration) {\n        utils = utilities;\n        queryParams = utils.location.deserialize(window.location.search);\n        cookie = jqCookie;\n        config = configuration;\n        qaOrProd();\n    });\n\n    var qa = function () {\n        // this will run in QA mode\n    };\n    var prod = function () {\n        // this will run in PROD mode\n        if (String(window.top.location).match(/refer.luckyvitamin.com\\/micro/i)){\n            window.top.location = "http://www.luckyvitamin.com/?extole_zone_name=advocate_widget";\n        } else {\n            zoneFromQueryParam();\n        }\n\n    };\n\n    var isMicrosite = function() {\n        return (location.hostname == extole.config.client.sites[0].program_domain);\n    };\n\n    var zoneFromQueryParam = function () {\n        var allData = utils.extend(true, {},\n            config.utils.getSharedVars(), {\n                params: queryParams\n            });\n            // set the user f l e from the query string or whatever\n            extole.user.setFromContext(allData);\n            autopopZone = queryParams.extole_zone_name;\n            if (autopopZone && !queryParams.xtl_zone_name) {\n                extole.require([\'zones\', \'campaigns\'],\n                function (zones, campaigns) {\n                    var someZone = zones.zone({\n                        name: autopopZone,\n                        // Append the element this creative will go into to the body\n                        element: document.body,\n                        // specify the creative id directly\n                        data: {\n                        }\n                    });\n                    campaigns.renderZone(someZone);\n                });\n            }\n        };\n    var getDefaultRedirectUrl = function(){\n        var hostnameArr = document.location.hostname.split(".");\n        return "www." + hostnameArr.splice(1, hostnameArr.length).join(".");\n    };\n    var redirect = function(){\n        redirectUrl = redirectUrl || getDefaultRedirectUrl();\n        autopopZone = micrositeZoneToAutopopZoneMap[micrositeZone] || autopopZone || micrositeZone;\n        var queryString = document.location.search;\n        if (queryString) {\n            queryString += "&";\n        } else {\n            queryString += "?";\n        }\n        queryString += "extole_zone_name=" + autopopZone;\n        document.location.href = "//" + redirectUrl + queryString;\n    };\n\n    var isXdArbiter = function () {\n        return (document.location.pathname == "/xd-arbiter");\n    };\n    var qaOrProd = function () {\n        // do nothing if this is the Xd-Arbiter\'s Core\n        if (isXdArbiter()) {\n            return;\n        }\n        //  Setup -- Decide whether to initiate QA or Production and determine if testing is already happening\n        var initiateTestingStatus = queryParams.extole_testing_status;\n        var initiateQA = initiateTestingStatus == "QA";\n        var initiateProduction = initiateTestingStatus == "PROD";\n        var alreadyTesting = cookie(\'extole_testing_status\') == "QA";\n        if (initiateProduction && alreadyTesting){\n            cookie("extole_testing_status", "", { expires: 0 });\n            alreadyTesting = false;\n        }\n        if (initiateQA || alreadyTesting) {\n            console.log(\'Testing Extole Custom Code\');\n            if(initiateQA){\n                cookie("extole_testing_status", "QA", { expires: 30 });\n            }\n            try{\n                qa();\n            }\n            catch(extoleQAError){\n                console.log("Extole QA Error: " + extoleQAError);\n            }\n        } else {\n            prod();\n        }\n    };\n})();\n*/');
try{c()}catch(g){extole.require(["https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/logger.js"],function(c){c.error("Error executing extended core javascript. Message : "+g.message+" Stack: "+g.stack)})}})();extole.require("utils configuration campaigns zones params events page-scanner sites user services".split(" "),function(c,g,f,l,b,e,a,d,h,n){f=g.get("CLIENT_CONFIG");g.set("PUBLISHED_DATE",f.published_date||"now");extole.user=h;extole.services=n;extole.events=
e;extole.config=f;extole.site=d.getDefault();var k=function(){a.whenYouFind('script[type="extole/conversion"]').thenCall(function(a){if(!a.hasBeenUsed){a.hasBeenUsed=!0;a:{var d={};try{d=JSON.parse(a.innerHTML)}catch(h){c.log.error("Could not fire conversion. "+h);break a}a=c.extend(!0,{},g.utils.getSharedVars(),d);extole.services.zoneConvert({type:d.type,parameters:a.params})}}}).andRemove();a.findAllTheThings()},x=function(){var a;"function"===typeof window.onerror&&(a=window.onerror);window.onerror=
function(d,h,b,e,k){if(a)try{a(d,h,b,e,k)}catch(c){}var n={MESSAGE:d,SOURCE:h,LINE_NUMBER:b,COLUMN_NUMBER:e,STACK_TRACE:k&&k.stack?k.stack:void 0};JSON.stringify(n).match(/extole/i)&&extole.require(["https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/logger.js"],function(a){a.error("Unhandled exception",n)})}};d=function(){x();l.requester.start();k();if("undefined"!==typeof window.extoleEvents)e.on(window.extoleEvents);extole._bootstrapped=!0};extole.bootstrap=
d;extole.loadCoreAsLibrary||extole._bootstrapped||d();if("undefined"!==typeof window.extoleAsyncInit)try{extoleAsyncInit()}catch(y){extole.require(["https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/logger.js"],function(a){a.error("Error executing extended core javascript. Message : "+y.message+" Stack: "+y.stack)})}});extole.SYSTEM_DOWN=!1;extole.CLIENT_ID="160484";extole.CLIENT_CONFIG={client:{client_id:"160484",disabled:!1,sites:[{id:"b7e488f03850821145cb33d7",
name:"Lucky Vitamin",program_domain:"refer.luckyvitamin.com",lazy_load:!1,cloudsponge_keys:{"www.luckyvitamin.com":"5BEFEPRCYN5LB353TBG2","7714betasite.aspdotnetstorefront.luckyvitamin.com":"28FNFLZ75YMJZWTDQCT2","m.luckyvitamin.com":"5JFYXMNDZBZFYBYTWAEV","7714betasite.aspdotnetst":"28FNFLZ75YMJZWTDQCT2","refer.luckyvitamin.com":"3L75CVAFX3P4C6QCMT6M"},share_url:"http://refer.luckyvitamin.com/s",privacy_policy_url:"https://www.luckyvitamin.com/t-privacy",allowed_domains:["*.extole.io","*.extole.com",
"refer.luckyvitamin.com","*","api.extole.com"]}]},cta_creative_name_to_id:{},campaign_name_to_id:{},zones:{conversion:{id:null,name:"conversion",disabled:!1,default_type:"none",default_types:{size:{},none:"none",html:""},whitelist:".*",blacklist:"",reference_element:null,resources:{}},registration:{id:null,name:"registration",disabled:!1,default_type:"none",default_types:{size:{},none:"none",html:""},whitelist:".*",blacklist:"",reference_element:null,resources:{}},advocate_earned_reward_email:{id:null,
name:"advocate_earned_reward_email",disabled:!1,default_type:"none",default_types:{size:{},none:"none",html:""},whitelist:".*",blacklist:"",reference_element:null,resources:{}},share_destination:{id:null,name:"share_destination",disabled:!1,default_type:"none",default_types:{size:{},none:"none",html:""},whitelist:".*",blacklist:"",reference_element:null,resources:{}},campaign_image:{id:null,name:"campaign_image",disabled:!1,default_type:"none",default_types:{size:{},none:"none",html:""},whitelist:".*",
blacklist:"",reference_element:null,resources:{}},share_destination_facebook:{id:null,name:"share_destination_facebook",disabled:!1,default_type:"none",default_types:{size:{},none:"none",html:""},whitelist:".*",blacklist:"",reference_element:null,resources:{}},friend_cta_email:{id:null,name:"friend_cta_email",disabled:!1,default_type:"none",default_types:{size:{},none:"none",html:""},whitelist:".*",blacklist:"",reference_element:null,resources:{}},friend_landing_experience:{id:null,name:"friend_landing_experience",
disabled:!1,default_type:"none",default_types:{size:{},none:"none",html:""},whitelist:".*",blacklist:"",reference_element:null,resources:{}},terms:{id:null,name:"terms",disabled:!1,default_type:"none",default_types:{size:{},none:"none",html:""},whitelist:".*",blacklist:"",reference_element:null,resources:{}},optout:{id:null,name:"optout",disabled:!1,default_type:"none",default_types:{size:{},none:"none",html:""},whitelist:".*",blacklist:"",reference_element:null,resources:{}},advocate_widget:{id:null,
name:"advocate_widget",disabled:!1,default_type:"none",default_types:{size:{},none:"none",html:""},whitelist:".*",blacklist:"",reference_element:null,resources:{}},account_page:{id:null,name:"account_page",disabled:!1,default_type:"none",default_types:{size:{},none:"none",html:""},whitelist:".*",blacklist:"",reference_element:null,resources:{}},advocate_landing:{id:null,name:"advocate_landing",disabled:!1,default_type:"none",default_types:{size:{},none:"none",html:""},whitelist:".*",blacklist:"",
reference_element:null,resources:{}},homepage_cta:{id:null,name:"homepage_cta",disabled:!1,default_type:"none",default_types:{size:{},none:"none",html:""},whitelist:".*",blacklist:"",reference_element:null,resources:{}},confirmation_page:{id:null,name:"confirmation_page",disabled:!1,default_type:"none",default_types:{size:{},none:"none",html:""},whitelist:".*",blacklist:"",reference_element:null,resources:{}},advocate_dashboard_email:{id:null,name:"advocate_dashboard_email",disabled:!1,default_type:"none",
default_types:{size:{},none:"none",html:""},whitelist:".*",blacklist:"",reference_element:null,resources:{}},advocate_welcome_email:{id:null,name:"advocate_welcome_email",disabled:!1,default_type:"none",default_types:{size:{},none:"none",html:""},whitelist:".*",blacklist:"",reference_element:null,resources:{}},promote_destination:{id:null,name:"promote_destination",disabled:!1,default_type:"none",default_types:{size:{},none:"none",html:""},whitelist:".*",blacklist:"",reference_element:null,resources:{}},
share_experience:{id:null,name:"share_experience",disabled:!1,default_type:"none",default_types:{size:{},none:"none",html:""},whitelist:".*",blacklist:"",reference_element:null,resources:{}}},zone_defaults:{conversion:{creative:null,campaign:"6336228872761953818"},registration:{creative:null,campaign:"6208559554514339272"},advocate_earned_reward_email:{creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228870292777721:version=359:coreAssetsVersion=1481046984915/render-javascript.js",
campaign:"6336228872761953818"},share_destination:{creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228871079480651:version=359:coreAssetsVersion=1481046984915/render-javascript.js",campaign:"6336228872761953818"},campaign_image:{creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228871476615859:version=359:coreAssetsVersion=1481046984915/render-javascript.js",campaign:"6336228872761953818"},share_destination_facebook:{creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228872839773759:version=359:coreAssetsVersion=1481046984915/render-javascript.js",
campaign:"6336228872761953818"},friend_cta_email:{creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228870393441613:version=359:coreAssetsVersion=1481046984915/render-javascript.js",campaign:"6336228872761953818"},friend_landing_experience:{creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6345527548396668202:version=58:coreAssetsVersion=1481046984915/render-javascript.js",campaign:"6336228872761953818"},terms:{creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228871045085207:version=359:coreAssetsVersion=1481046984915/render-javascript.js",
campaign:"6336228872761953818"},optout:{creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228872909628585:version=359:coreAssetsVersion=1481046984915/render-javascript.js",campaign:"6336228872761953818"},advocate_widget:{creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6345865581457222599:version=46:coreAssetsVersion=1481046984915/render-javascript.js",campaign:"6336228872761953818"},account_page:{creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228872408246524:version=359:coreAssetsVersion=1481046984915/render-javascript.js",
campaign:"6336228872761953818"},advocate_landing:{creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228873248159678:version=359:coreAssetsVersion=1481046984915/render-javascript.js",campaign:"6336228872761953818"},homepage_cta:{creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6343228994147372931:version=109:coreAssetsVersion=1481046984915/render-javascript.js",campaign:"6336228872761953818"},confirmation_page:{creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228873673160577:version=359:coreAssetsVersion=1481046984915/render-javascript.js",
campaign:"6336228872761953818"},advocate_dashboard_email:{creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228871043120233:version=359:coreAssetsVersion=1481046984915/render-javascript.js",campaign:"6336228872761953818"},advocate_welcome_email:{creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228869982707259:version=359:coreAssetsVersion=1481046984915/render-javascript.js",campaign:"6336228872761953818"},promote_destination:{creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228872283072612:version=359:coreAssetsVersion=1481046984915/render-javascript.js",
campaign:"6336228872761953818"},share_experience:{creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228873667807685:version=359:coreAssetsVersion=1481046984915/render-javascript.js",campaign:"6336228872761953818"}},campaigns:{"6208559554514339272":{id:"6208559554514339272",name:"unknown",conversion_creative:null,registration_creative:null},"6336228872761953818":{id:"6336228872761953818",name:"unknown",conversion_creative:null,advocate_earned_reward_email_creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228870292777721:version=359:coreAssetsVersion=1481046984915/render-javascript.js",
share_destination_creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228871079480651:version=359:coreAssetsVersion=1481046984915/render-javascript.js",campaign_image_creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228871476615859:version=359:coreAssetsVersion=1481046984915/render-javascript.js",share_destination_facebook_creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228872839773759:version=359:coreAssetsVersion=1481046984915/render-javascript.js",
friend_cta_email_creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228870393441613:version=359:coreAssetsVersion=1481046984915/render-javascript.js",friend_landing_experience_creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6345527548396668202:version=58:coreAssetsVersion=1481046984915/render-javascript.js",terms_creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228871045085207:version=359:coreAssetsVersion=1481046984915/render-javascript.js",
optout_creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228872909628585:version=359:coreAssetsVersion=1481046984915/render-javascript.js",advocate_widget_creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6345865581457222599:version=46:coreAssetsVersion=1481046984915/render-javascript.js",account_page_creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228872408246524:version=359:coreAssetsVersion=1481046984915/render-javascript.js",
advocate_landing_creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228873248159678:version=359:coreAssetsVersion=1481046984915/render-javascript.js",homepage_cta_creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6343228994147372931:version=109:coreAssetsVersion=1481046984915/render-javascript.js",confirmation_page_creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228873673160577:version=359:coreAssetsVersion=1481046984915/render-javascript.js",
advocate_dashboard_email_creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228871043120233:version=359:coreAssetsVersion=1481046984915/render-javascript.js",advocate_welcome_email_creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228869982707259:version=359:coreAssetsVersion=1481046984915/render-javascript.js",promote_destination_creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228872283072612:version=359:coreAssetsVersion=1481046984915/render-javascript.js",
share_experience_creative:"https://origin.extole.io/type=creativeArchive:creativeArchiveId=6336228873667807685:version=359:coreAssetsVersion=1481046984915/render-javascript.js"}},js_source:'/*\nv2 Core autopop/redirect\nPromote links lead to microsites. But not all clients have microsites. This script makes Promote links work with those clients. It does two things:\n1- when it detects that it is being run on a microsite, it redirects to the client\'s own website, and adds an extole_zone_name parameter to the query string\n2- when it\'s not on a microsite, and it sees an extole_zone_name parameter (unless it also sees an xtl_zone_name param, which is what we use for friend landing coupons), it inserts an extole/widget tag on the page for that zone, with whatever other parameters it finds.\nBy default, the redirect will set extole_zone_name to the same zone as the microsite it\'s redirecting from, so /micro/microsite1 => extole_zone_name=microsite1\nBy default, the destination URL for the redirect will be the same as the microsite\'s domain, but with a www. subdomain, so refer.american-giant.com would go to www.american-giant.com\nExample non-default settings:\nvar redirectUrl = "awesome.mydomain.com";\nvar autopopZone = "";\nvar redirectAllMicrosites = false;\nvar micrositeZoneToAutopopZoneMap = {\n"microsite1" : "autopopZone1",\n"microsite4" : "autopopZone4"\n};\nWith these settings, only microsite1 and microsite4 would redirect, to autopopZone1 and autopopZone4 respectively, and they would redirect to "awesome.mydomain.com". A hypothetical microsite2 would load as a normal microsite.\n*//*\n(function(){\n    "use strict";\n    // IE broken console\n    if (!window.console) {window.console = {log: function() {}};}\n    // Customize autopop & redirect defaults\n    var redirectUrl="acorn.tv/featured";\n    var redirectAllMicrosites = true;\n    var autopopZone = "advocate_widget";\n    var micrositeZoneToAutopopZoneMap = {\n    };\n\n    var micrositeZone, queryParams, cookie, config, utils;\n    // load needed modules\n    extole.require(["utils", "cookie", "configuration"], function(utilities, jqCookie, configuration) {\n        utils = utilities;\n        queryParams = utils.location.deserialize(window.location.search);\n        cookie = jqCookie;\n        config = configuration;\n        qaOrProd();\n    });\n\n    var qa = function () {\n        // this will run in QA mode\n    };\n    var prod = function () {\n        // this will run in PROD mode\n        if (String(window.top.location).match(/refer.luckyvitamin.com\\/micro/i)){\n            window.top.location = "http://www.luckyvitamin.com/?extole_zone_name=advocate_widget";\n        } else {\n            zoneFromQueryParam();\n        }\n\n    };\n\n    var isMicrosite = function() {\n        return (location.hostname == extole.config.client.sites[0].program_domain);\n    };\n\n    var zoneFromQueryParam = function () {\n        var allData = utils.extend(true, {},\n            config.utils.getSharedVars(), {\n                params: queryParams\n            });\n            // set the user f l e from the query string or whatever\n            extole.user.setFromContext(allData);\n            autopopZone = queryParams.extole_zone_name;\n            if (autopopZone && !queryParams.xtl_zone_name) {\n                extole.require([\'zones\', \'campaigns\'],\n                function (zones, campaigns) {\n                    var someZone = zones.zone({\n                        name: autopopZone,\n                        // Append the element this creative will go into to the body\n                        element: document.body,\n                        // specify the creative id directly\n                        data: {\n                        }\n                    });\n                    campaigns.renderZone(someZone);\n                });\n            }\n        };\n    var getDefaultRedirectUrl = function(){\n        var hostnameArr = document.location.hostname.split(".");\n        return "www." + hostnameArr.splice(1, hostnameArr.length).join(".");\n    };\n    var redirect = function(){\n        redirectUrl = redirectUrl || getDefaultRedirectUrl();\n        autopopZone = micrositeZoneToAutopopZoneMap[micrositeZone] || autopopZone || micrositeZone;\n        var queryString = document.location.search;\n        if (queryString) {\n            queryString += "&";\n        } else {\n            queryString += "?";\n        }\n        queryString += "extole_zone_name=" + autopopZone;\n        document.location.href = "//" + redirectUrl + queryString;\n    };\n\n    var isXdArbiter = function () {\n        return (document.location.pathname == "/xd-arbiter");\n    };\n    var qaOrProd = function () {\n        // do nothing if this is the Xd-Arbiter\'s Core\n        if (isXdArbiter()) {\n            return;\n        }\n        //  Setup -- Decide whether to initiate QA or Production and determine if testing is already happening\n        var initiateTestingStatus = queryParams.extole_testing_status;\n        var initiateQA = initiateTestingStatus == "QA";\n        var initiateProduction = initiateTestingStatus == "PROD";\n        var alreadyTesting = cookie(\'extole_testing_status\') == "QA";\n        if (initiateProduction && alreadyTesting){\n            cookie("extole_testing_status", "", { expires: 0 });\n            alreadyTesting = false;\n        }\n        if (initiateQA || alreadyTesting) {\n            console.log(\'Testing Extole Custom Code\');\n            if(initiateQA){\n                cookie("extole_testing_status", "QA", { expires: 30 });\n            }\n            try{\n                qa();\n            }\n            catch(extoleQAError){\n                console.log("Extole QA Error: " + extoleQAError);\n            }\n        } else {\n            prod();\n        }\n    };\n})();\n*/',
published_date:"201612211544"};extole.define("configuration","utils configuration/get-client-config configuration/api configuration/processors configuration/utils configuration/zones".split(" "),function(c,g,f,l,b,e){var a=this.async();g(function(d,h){if(d)throw Error("Error getting client config - "+d.message);var n=extole.SYSTEM_DOWN;f.set("CLIENT_CONFIG",l.clientConfig(h));f.set("SYSTEM_DOWN",n);f.set("CLIENT_DOWN",!!h.client.disabled);f.set("SITE_DOMAIN",extole.SITE_DOMAIN||location.hostname);
c.extend(f,{processors:l,utils:b,zones:e});a(f)})});extole.define("configuration/api",[],function(){var c={};return{set:function(g,f){c[g]=f},get:function(g){return c[g]}}});extole.define("configuration/get-client-config",["JSON","ajax"],function(c,g){var f=function(b){setTimeout(function(){var e=extole.CLIENT_ID;e?b(null,e):b(Error("Could not find client id"))},1)},l=function(b){f(function(e,a){e&&b?b(Error("Error fetching client id - "+e.message)):g({url:extole.MEDIA_SERVER+"/config/clients/"+a+
"/client.json",complete:function(a){b&&b(null,c.parse(a))},error:function(a){b&&b(Error("Problem fetching client config - "+a.message))}})})};return function(b){if(extole.CLIENT_CONFIG){var e=extole.CLIENT_CONFIG;setTimeout(function(){b&&b(null,e)},1)}else l(b)}});extole.define("configuration/processors",["utils"],function(c){var g={},f=function(c,b){for(var e in c)if(c.hasOwnProperty(e)){var a=b(e);e!==a&&(c[a]=c[e],delete c[e])}};g.clientConfig=function(g){if(g._processed)return g;var b=function(b){return b.toLowerCase()};
f(g.zones,b);c.each(g.zones,function(b,a){b.name=a});f(g.zone_defaults,b);f(g.cta_creative_name_to_id,b);f(g.campaign_name_to_id,b);g.campaign_id_to_name={};c.each(g.campaign_name_to_id,function(b,a){g.campaign_id_to_name[b]=a});g.cta_creative_id_to_name={};c.each(g.cta_creative_id_to_name,function(b,a){g.cta_creative_id_to_name[b]=a});g._processed=!0;return g};return g});extole.define("configuration/utils",["configuration/api","utils","cookie","JSON"],function(c,g,f,l){return{getSharedVars:function(){for(var b=
document.getElementsByTagName("script"),c={},a,d=0;d<b.length;d++)if("extole/context"==b[d].type){a=void 0;try{a=l.parse(b[d].innerHTML)}catch(h){g.log.error("Bad JSON in context script tag.")}a&&g.extend(c,a)}return c}}});extole.define("configuration/zones",["utils","configuration/api"],function(c,g){return{blacklisted:function(f){f=g.get("CLIENT_CONFIG").zones[f]||{};var l=!0,b=!1;f.whitelist&&(l=!!location.toString().match(new RegExp(f.whitelist)));f.blacklist&&(b=!!location.toString().match(new RegExp(f.blacklist)));
return b?(c.log("Location is on black list"),!0):l?!1:(c.log("Not on white list uri"),!0)}}});extole.define("cookie",["utils","JSON"],function(c,g){function f(a){return a}function l(a){try{return decodeURIComponent(a.replace(e," "))}catch(h){return c.log("** utils.cookie.decoded ** Cookie error",h.message,h),""}}function b(d){0===d.indexOf('"')&&(d=d.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return a.json?g.parse(d):d}catch(h){}}var e=/\+/g,a=function(d,h,e){if(void 0!==h){e=c.extend({},
a.defaults,e);if("number"===typeof e.expires){var k=e.expires,x=e.expires=new Date;x.setDate(x.getDate()+k)}h=a.json?g.stringify(h):String(h);return document.cookie=[a.raw?d:encodeURIComponent(d),"=",a.raw?h:encodeURIComponent(h),e.expires?"; expires="+e.expires.toUTCString():"",e.path?"; path="+e.path:"",e.domain?"; domain="+e.domain:"",e.secure?"; secure":""].join("")}h=a.raw?f:l;e=document.cookie.split("; ");for(var k=d?void 0:{},x=0,y=e.length;x<y;x++){var p=e[x].split("="),q=h(p.shift()),p=h(p.join("="));
if(d&&d===q){k=b(p);break}d||(k[q]=b(p))}return k};a.defaults={};return a});extole.define("create-zone",["zones","campaigns"],function(c,g){function f(b,e){if(!b)throw new l(e||"Assertion failed","assertion_failed");}function l(b,e){var a=Error.call(this,b);this.name="ExtoleError";this.message=a.message;this.stack=a.stack;this.code=e}l.prototype=Error();l.prototype.constructor=l;return function(b,e){e=e||function(){};f(b,"createZone requires a map of parameters");f(b.name,'createZone expects the "name" parameter to be present');
f(b.element,'createZone expects the "element" parameter to be present');var a=c.zone({name:b.name,type:b.name,element:b.element,data:{insert_position:"inside",parameters:b.parameters||{}}});a.data.parameters.campaign_id&&(a.data.campaign=a.data.parameters.campaign_id);g.renderZone(a,e)}});extole.define("creative-javascript-api/render/JsCampaign",[],function(){return function(c){this.getId=function(){return c.id}}});extole.define("creative-javascript-api/render/JsCreativeContext",["creative-javascript-api/render/JsZone",
"creative-javascript-api/render/JsCampaign","creative-javascript-api/render/JsProgram","utils"],function(c,g,f,l){return function(b){this.getCampaign=function(){return new g({id:b.campaign.id})};this.getZone=function(){return new c({element:b.element,name:b.getName(),parameters:b.getParameters()})};this.getProgram=function(){return new f}}});extole.define("creative-javascript-api/render/JsProgram",[],function(){return function(){var c=extole.site;this.getName=function(){return c.name};this.getProgramDomain=
function(){return c.program_domain};this.getSitePatterns=function(){return c.allowed_domains}}});extole.define("creative-javascript-api/render/JsZone",[],function(){return function(c){this.getElement=function(){return c.element};this.getName=function(){return c.name};this.getParameters=function(){return c.parameters||{}};this.getData=function(){return c.parameters||{}}}});extole.define("creatives",["utils","configuration"],function(c,g){var f=function(c,b){var e=g.get("CLIENT_CONFIG"),a;a=c.match(/^(https?|file):\/\//)?
!0:c.match(/^\/\//)?!0:!1;return a?c:"extole-media:/config/clients/"+e.client.client_id+"/creative_"+c+"."+g.get("PUBLISHED_DATE")+".js"};return{get:function(c,b){var e=f(c);extole.require([e],function(a){var d={},h="[object Object]"===Object.prototype.toString.call(a),c="function"===typeof a.render;h&&c?(d.render=a.render,d.isLegacyCreative=!0):d.render=a;b(null,d)})}}});extole.define("dom","utils dom/api dom/events dom/window dom/attributes dom/query dom/ready".split(" "),function(c,g,f,l,b,e,a){return c.extend(g,
{events:f,window:l,attributes:b,query:e,ready:a})});extole.define("dom/api",["utils","dom/events"],function(c,g){var f={x:0,y:0};g.add(document,"mousemove",function(b){f.x=b.pageX;f.y=b.pageY});var l=function(b){var a=document.createDocumentFragment(),d=document.createElement("div");d.innerHTML=b;c.each(d.childNodes,function(d){1==d.nodeType&&a.appendChild(d)});return a},b=function(b){var a;c.each(b.childNodes,function(d){a||1!=d.nodeType||(a=d)});return a};return{prepend:function(c,a){var d=b(c),
h=a;"string"==typeof a&&(h=l(a));d?c.insertBefore(h,d):c.appendChild(ode)},append:function(b,a){var d=a;"string"==typeof a&&(d=l(a));b.appendChild(d)},mouse:f}});extole.define("dom/attributes",["utils"],function(c){var g=function(f){f=f.className;var b={};if(!f)return b;c.each(f.split(" "),function(c){b[c]=1});return b},f=function(f){var b="";c.each(f,function(c,a){b+=" "+a});return b.slice(1)};return{set:function(c,b,e){c.setAttribute(b,e);c[b]=e},get:function(c,b){return c.getAttribute(b)},addClass:function(c,
b){var e=g(c);e[b]||(e[b]=1,c.className=f(e))},removeClass:function(c,b){var e=g(c);delete e[b];c.className=f(e)},getClassNames:g}});extole.define("dom/events",["utils"],function(c){var g=[],f=function(b,c,a){for(var d=[],h=0;h<g.length;h++){var n=g[h];n.element==b&&n.eventType==c&&n.listener==a&&d.push({index:h,eventListener:n})}return d},l=function(b){this.originalEvent=b;this.type=b.type;this.keyCode=b.keyCode;this.target=b.srcElement?b.srcElement:b.target};l.prototype={preventDefault:function(){var b=
this.originalEvent;b.preventDefault?b.preventDefault():b.returnValue=!1},stopPropagation:function(){var b=this.originalEvent;b.stopPropagation&&b.stopPropagation();b.cancelBubble=!0}};return{add:function(b,e,a){if(0<f(b,e,a).length)c.log("events.add - Listener already exists for event "+e+" on element "+b);else{var d=!b.addEventListener,h=function(h){d&&(h=window.event);return a.call(b,new l(h))};g.push({element:b,eventType:e,listener:a,listenerWrapper:h});b.addEventListener?b.addEventListener(e,
h,!1):b.attachEvent("on"+e,h)}},trigger:function(b,e,a){var d=document.createEvent("Event");d.initEvent(e,!0,!1);c.extend(d,a);b.dispatchEvent(d)},remove:function(b,e,a){a=f(b,e,a);0>=a.length?c.log("events.remove - Couldn't find exiting event listener for type \""+e+'" listener on element '+b):c.each(a,function(a){var h=a.index;a=a.eventListener;b.removeEventListener?b.removeEventListener(e,a.listenerWrapper,!1):b.detachEvent("on"+e,a.listenerWrapper);g.splice(h,1)})}}});extole.define("dom/query",
[],function(){return function(c,g){return(g||document).querySelectorAll(c)}});extole.define("dom/ready",["utils"],function(c){var g=c.generalReady();(function(){var c;document.addEventListener?c=function(){document.removeEventListener("DOMContentLoaded",c,!1);g.set()}:document.attachEvent&&(c=function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",c),g.set())});"complete"===document.readyState&&g.set();document.addEventListener?(document.addEventListener("DOMContentLoaded",
c,!1),window.addEventListener("load",g.set,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",c),window.attachEvent("onload",g.set))})();return g});extole.define("dom/window",[],function(){return{getSize:function(){var c=document.documentElement,g=document.getElementsByTagName("body")[0];return{width:window.innerWidth||c.clientWidth||g.clientWidth,height:window.innerHeight||c.clientHeight||g.clientHeight}}}});extole.define("entity-events",["utils"],function(c){function g(a,d,h,
b){b=b.split(/\s+/);c.each(b,function(b){var e=a[b];e||c.throwError("bindEntityEvents","Method '"+b+"' was configured as an event handler, but does not exist.");a.listenTo(d,h,e)})}function f(a,d,h,b){a.listenTo(d,h,b)}function l(a,d,h,b){b=b.split(/\s+/);c.each(b,function(b){a.stopListening(d,h,a[b])})}function b(a,d,h,b){a.stopListening(d,h,b)}function e(a,d,b,e,k){d&&b&&(c.isFunction(b)&&(b=b.call(a)),c.each(b,function(b,h){c.isFunction(b)?e(a,d,h,b):k(a,d,h,b)}))}return{bind:function(a,d,b){e(a,
d,b,f,g)},unbind:function(a,d,h){e(a,d,h,b,l)}}});extole.define("events",["utils","configuration"],function(c,g){var f={},l=function(b,e){"object"==typeof b?c.each(b,function(a,d){l(d,a)}):c.each(b.split(" "),function(a){f[a]||(f[a]={name:a,callbacks:[]});f[a].callbacks.push(e)})};return{on:l,off:function(b,e){c.each(b.split(" "),function(a){if(f[a])if(e){var d=-1;c.each(f[a].callbacks,function(a,b){if(a==e)return d=b,!1});0<d&&f[a].callbacks.splice(d,1)}else f[a].callbacks=[]})},trigger:function(b,
e){var a=g.get("CLIENT_CONFIG");e=e||{};var d=e.sharedVars||g.utils.getSharedVars(),h={};c.each(e,function(a,d){"sharedVars"!==d&&"zoneName"!==d&&"campaignId"!==d&&(h[d]=a)});for(var a=a.client,n=c.extend(!0,h,d,{eventName:b,zoneName:e.zoneName,campaignId:e.campaignId,siteId:extole.site.id,clientId:a.client_id,clientName:a.name}),d=b.split(":"),a=d.length;0<a;a--){var k=d.slice(0,a).join(":");if(f[k]){c.each(f[k].callbacks,function(a){a(c.extend({},n,{eventNameRemainder:k}))});break}}}}});extole.define("JSON",
[],function(){var c;"object"!==typeof c&&(c={});(function(){function g(a){return 10>a?"0"+a:a}function f(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var d=h[a];return"string"===typeof d?d:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function l(b,h){var c,e,q,v,w=a,m,u=h[b];u&&u instanceof Date&&(c=u,u=isFinite(c.valueOf())?c.getUTCFullYear()+"-"+g(c.getUTCMonth()+1)+"-"+g(c.getUTCDate())+"T"+g(c.getUTCHours())+":"+g(c.getUTCMinutes())+":"+g(c.getUTCSeconds())+
"Z":null);"function"===typeof n&&(u=n.call(h,b,u));switch(typeof u){case "string":return f(u);case "number":return isFinite(u)?String(u):"null";case "boolean":case "null":return String(u);case "object":if(!u)return"null";a+=d;m=[];if("[object Array]"===Object.prototype.toString.apply(u)){v=u.length;for(c=0;c<v;c+=1)m[c]=l(c,u)||"null";q=0===m.length?"[]":a?"[\n"+a+m.join(",\n"+a)+"\n"+w+"]":"["+m.join(",")+"]";a=w;return q}if(n&&"object"===typeof n)for(v=n.length,c=0;c<v;c+=1)"string"===typeof n[c]&&
(e=n[c],(q=l(e,u))&&m.push(f(e)+(a?": ":":")+q));else for(e in u)Object.prototype.hasOwnProperty.call(u,e)&&(q=l(e,u))&&m.push(f(e)+(a?": ":":")+q);q=0===m.length?"{}":a?"{\n"+a+m.join(",\n"+a)+"\n"+w+"}":"{"+m.join(",")+"}";a=w;return q}}var b,e,a,d,h,n;"function"!==typeof c.stringify&&(e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},c.stringify=
function(b,h,c){var e;d=a="";if("number"===typeof c)for(e=0;e<c;e+=1)d+=" ";else"string"===typeof c&&(d=c);if((n=h)&&"function"!==typeof h&&("object"!==typeof h||"number"!==typeof h.length))throw Error("JSON.stringify");return l("",{"":b})});"function"!==typeof c.parse&&(b=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c.parse=function(a,d){function h(a,b){var c,e,k=a[b];if(k&&"object"===typeof k)for(c in k)Object.prototype.hasOwnProperty.call(k,
c)&&(e=h(k,c),void 0!==e?k[c]=e:delete k[c]);return d.call(a,b,k)}var c;a=String(a);b.lastIndex=0;b.test(a)&&(a=a.replace(b,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return c=eval("("+a+")"),"function"===typeof d?h({"":c},""):c;throw new SyntaxError("JSON.parse");})})();return c});
extole.define("page-scanner",["utils","dom"],function(c,g){function f(){function a(){h||(k=!1,h=!0,setTimeout(function(){for(var f={},l=e.splice(0,e.length);0<l.length;){var p=l.shift(),q=f[p.selector];if(!q)try{q=g.query(p.selector)}catch(v){c.log.error("query error -"+selector)}q&&0<q.length&&p.withElements(q);p.shouldDelete()||e.push(p)}h=!1;k?a():b||(f=Math.ceil(50*(.3*Math.pow(1.017,d/50)+.7)),setTimeout(a,f),d=f)},1))}var d=0,h=!1,e=[],k=!1;this.queue=function(d){e.push(d);k=!0;h||a()};this.scan=
a}function l(a){var d=0,b=function(){return!0},e=function(){},k=!1;this.withElements=function(a){c.each(a,function(a){b(a)&&e(a)});d++};this.setFilter=this.andIts=function(a){b=a;return this};this.setCompleted=this.thenCall=function(a){e=a;return this};this.setDeleteAfterCall=this.andRemove=function(){k=!0};this.shouldDelete=function(){return 0<d&&!0===k?!0:!1};this.selector=a}var b=!1;g.ready(function(){b=!0});var e=new f;return{whenYouFind:function(a){var d=new l(a);setTimeout(function(){e.queue(d)},
1);return d},findAllTheThings:function(){e.scan()},reset:function(){e=new f}}});extole.define("params",["utils","validators"],function(c,g){var f={e:"email",f:"first_name",l:"last_name"},l="email first_name last_name source partner_conversion_id partner_user_id".split(" ");return{rekey:function(b){var e={};c.each(b,function(a,d){f[d]&&(d=f[d]);var b=/^tag:/.test(d),g=-1<c.inArray(d,l)?!0:!1;b||g||(d="tag:"+d);e[d]=a});return e},split:function(b,e){e=c.extend({validateEmail:!0},e||{});var a={init:{},
client:{}};if(!b)return a;c.each(b,function(d,b){var f=a.init;-1<b.indexOf("tag:")?(b=b.substring(4),f=a.client):"email"==b&&e.validateEmail&&!g.isEmail(d)&&(c.log("Initialized with invalid email address ("+d+") - (configUtils.getInitParams)"),d=void 0);f[b]=d});return a},removeTags:function(b){var e={};c.each(b,function(a,d){d=d.replace(/^tag:/,"");e[d]=a});return e}}});extole.define("request-zone",["sites","ajax","utils","utils/collections"],function(c,g,f,l){function b(a){var d=a.code||"",b=a.description||
"";this.stack=Error(b).stack;this.getCode=function(){return d};this.getDescription=function(){return b}}function e(a){function d(a,c){if("[object Object]"!==Object.prototype.toString.call(a)){var e=c.join(".");b[e]=a}else l.each(a,function(a,b){var h=c.slice();h.push(b);d(a,h)})}var b={};d(a,[]);return b}b.prototype=Error();b.prototype.constructor=b;return function(a,d,h){h=h||function(){};extole.require(["https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/shared/js/user-service.js"],
function(n){n.getUser(function(k,n){if(k)h(k);else{var l=c.getDefault(),p=n.getAccessToken(),l="https://"+l.program_domain+"/zone/"+a,p=f.extend({},e(d),{access_token:p});g({type:"GET",url:l,headers:{Accept:"text/javascript"},xhrFields:{withCredentials:!0},data:p,complete:function(){f.log("zone request for zone: "+a+" succeeded");h(null)},error:function(d,c,e){f.log("zone request for zone: "+a+" failed");d=new b({description:"zone request failed: "+c,code:"zone_request_exception"});h(d)}})}})})}});
extole.define("services","utils services/share services/convert services/zone-convert services/confirm services/send-dashboard services/preshare services/click services/impression services/rewards services/claim-reward".split(" "),function(c,g,f,l,b,e,a,d,h,n,k){return{click:d,impression:h,share:g,convert:f,zoneConvert:l,confirm:b,sendDashboard:e,preshare:a,rewards:n,claimReward:k}});extole.define("services/claim-reward",["utils","services/request"],function(c,g){var f=g({method:"post",requiredParams:["rewardId",
"rewardOptionId"],getCommonData:function(){return{}},onBeforeSend:function(){this.validateRequiredParams();this.url="//"+this.getProgramDomain()+"/api/v2/rewards/"+this.rewardId+"/claim";this.xhrFields={withCredentials:!0};this.data={reward_option_id:this.rewardOptionId}}});return c.factory(f)});extole.define("services/click",["utils","services/stream"],function(c,g){var f=g({eventType:"CTA_CLICK"});return c.factory(f)});extole.define("services/confirm",["utils","services/request"],function(c,g){var f=
g({method:"post",eventType:void 0,requiredParams:["confirmationCode","actionId"],onBeforeSend:function(){this.validateRequiredParams();this.url="//"+this.getProgramDomain()+"/v2/confirm";this.data={confirmation_code:this.confirmationCode,action_id:this.actionId}}});return c.factory(f)});extole.define("services/convert",["utils","services/request","user","params"],function(c,g,f,l){g=g({method:"post",requiredParams:[],validate:function(){this.validateRequiredParams()},onBeforeSend:function(){this.validate();
this.url="//"+this.getProgramDomain()+"/v2/convert";this.data={action_type:(this.type||"PURCHASE").toUpperCase(),site_id:null}}});return c.factory(g)});extole.define("services/impression",["utils","services/stream"],function(c,g){var f=g({eventType:"CTA_IMPRESSION"});return c.factory(f)});extole.define("services/preshare",["utils","services/request"],function(c,g){var f=g({method:"get",eventType:void 0,requiredParams:["campaignId"],onBeforeSend:function(){this.validateRequiredParams();this.url="//"+
this.getProgramDomain()+"/v2/preshare/"+this.campaignId;this.data={confirmation_code:this.confirmationCode,action_id:this.actionId};this.xhrFields={withCredentials:!0}}});return c.factory(f)});extole.define("services/request","utils JSON dom ajax sites xd-messager-iframe params".split(" "),function(c,g,f,l,b,e,a){g=c.extend({validateRequiredParams:function(){var a=this,b=[],e=this.requiredParams||[];c.each(e,function(c){var e=a[c];e||"string"==typeof e||b.push(c)});b.length&&this.silentFail("Must pass "+
e.join(", ")+". Of those, you're missing "+b.join(", "))},getProgramUrl:function(){c.log("DEPRECATED. Use getProgramDomain.");return this.getProgramDomain()},getProgramDomain:function(){return b.getDefault().program_domain},silentFail:function(a){this.error=a},getCommonData:function(d){d=d||{};var h={};if(this.params){var e=a.rekey(this.params);d=a.split(e,d);c.extend(h,d.init,{client_params:d.client})}d=f.window.getSize();return c.extend(h,{mouse_xy:Math.round(f.mouse.x)+","+Math.round(f.mouse.y),
window_wh:d.width+","+d.height,screen_wh:screen.width+","+screen.height,site_id:b.getDefault().id})},send:function(a){var b=function(){},e=function(){};c.isPlainObject(a)?(b=a.complete||b,e=a.error||e):c.isFunction(a)&&(b=a);var k=this;this.triggerMethod("before:send");this.data=c.extend(!0,{},this.getCommonData(a),this.data);if(this.error)c.log.error("Request Error - ",this.error,this);else{this.headers=this.headers||{};void 0===this.headers["Content-Type"]&&(this.headers["Content-Type"]="application/json");
a={url:this.url,type:this.method,complete:function(){k.triggerMethod.apply(k,["send"].concat(arguments));b.apply(this,arguments)},error:function(){k.triggerMethod.apply(k,["send:error"].concat(arguments));e.apply(this,arguments)},data:this.data,xhrFields:c.extend(this.xhrFields,{withCredentials:!0}),headers:this.headers};var f=String(navigator.userAgent),g=f.match("Windows NT 10"),f=f.match("rv:11");"undefined"!==typeof window.XDomainRequest||g&&f?this.sendViaIframe(a):l(a)}},sendViaIframe:function(a){var b=
c.uniqueId("forwardAjaxCalls"),f=e.create(b);f.ready(function(){var b=f.socket;b.sendMessage("ajax",a);var h=function(c){b.off("ajaxComplete",h);a.complete.apply(c,arguments)},c=function(h){b.off("ajaxError",c);a.error.apply(h,arguments)};b.on("ajaxComplete",h);b.on("ajaxError",c)})}},c.events);return c.factory(g)});extole.define("services/rewards",["utils","services/request"],function(c,g){var f=g({onBeforeSend:function(){this.validateRequiredParams();this.url="//"+this.getProgramDomain()+"/api/v2/rewards/unclaimed";
this.xhrFields={withCredentials:!0}}});return c.factory(f)});extole.define("services/send-dashboard",["utils","services/request"],function(c,g){var f=g({method:"get",eventType:void 0,onBeforeSend:function(){this.url="//"+this.getProgramDomain()+"/v2/advdash/email/"}});return c.factory(f)});extole.define("services/share",["utils","services/request","user"],function(c,g,f){g=g({method:"post",eventType:void 0,requiredParams:["channel","campaignId","siteId","zoneName"],validate:function(){this.validateRequiredParams();
f.setFromShare(this);f.get("email")||this.silentFail("User must have email");"purl"==this.channel.toLowerCase()&&(this.actionId||this.silentFail("Purl share requires action id."),this.actionIdHash||this.silentFail("Purl share requires action id hash."))},onBeforeSend:function(){this.validate();this.url="//"+this.getProgramDomain()+"/v2/share";this.data={channel:this.channel,campaign_id:this.campaignId,zone_name:this.zoneName,client_params:{cta_id:this.ctaCreativeId,zone_id:this.zoneId},email:f.get("email"),
first_name:f.get("first_name"),last_name:f.get("last_name"),channel_email:this.email,channel_first_name:this.firstName,channel_last_name:this.lastName,channel_message:this.message,channel_access_token:this.accessToken,channel_access_token_secret:this.secret,source_url:window.location.toString(),resources:this.resources,recipients:this.recipients,site_id:this.siteId};"purl"==this.channel.toLowerCase()&&(this.data.action_id=this.actionId,this.data.id_hash=this.actionIdHash)}});return c.factory(g)});
extole.define("services/stream",["utils","services/request"],function(c,g){var f=g({method:"post",eventType:void 0,requiredParams:["campaignId","eventType"],onBeforeSend:function(){this.validateRequiredParams();this.url="//"+this.getProgramDomain()+"/v2/stream";this.data={campaign_id:this.campaignId,zone_name:this.zoneName,client_params:{cta_id:this.ctaCreativeId,zone_id:this.zoneId},event_type:this.eventType}}});return c.factory(f)});extole.define("services/zone-convert",["request-zone","params"],
function(c,g){function f(c){var b=c.code||"",e=c.description||"";this.stack=Error(e).stack;this.getCode=function(){return b};this.getDescription=function(){return e}}f.prototype=Error();f.prototype.constructor=f;return function(l,b){b=b||function(){};var e=function(a){var b;a=a.toLowerCase();if("purchase"===a)b="conversion";else if("register"===a||"registration"===a)b="registration";return b||null}(l.type),a=function(a){a=g.rekey(a);return g.removeTags(a)}(l.parameters);if(!e){var d="Error: could not find zone based on type:"+
l.type;extole.require(["https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/logger.js"],function(a){a.error(d)});e=new f({description:d,code:"error-no-type"});return b(e)}c(e,a,b)}});extole.define("sites",["utils","configuration","JSON"],function(c,g,f){function l(a){this.config=a;c.extend(this,this.config)}l.prototype={isAllowedForDomain:function(a){if(this.config.program_domain==a)return!0;var b=this.config.allowed_domains||[];b.push("*.extole.com");var h=!1;
c.each(b,function(b){(new RegExp(b.replace(/\./g,"\\.").replace(/\*/g,".*"))).test(a)&&(h=!0)});return h},getProgramDomain:function(){return this.config.program_domain}};var b=function(){var a=[],b=g.get("CLIENT_CONFIG").client;c.each(b.sites,function(b){a.push(new l(b))});return a},e=function(a){return c.map(b(),function(b){if(b.isAllowedForDomain(a))return b})};return{getDefault:function(){var a=g.get("SITE_DOMAIN"),b=e(a)[0];b||c.log("No default site found for domain "+a);return b},filterByDomain:e}});
extole.define("template",["utils"],function(c){var g=c.keys,f=c.invert,l=c.each,b=c.defaults,e={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};e.unescape=f(e.escape);var a={escape:new RegExp("["+g(e.escape).join("")+"]","g"),unescape:new RegExp("("+g(e.unescape).join("|")+")","g")},d,h;(function(){var b=function(b){return function(d){return null==d?"":(""+d).replace(a[b],function(a){return e[b][a]})}};d=b("escape");h=b("unescape")})();var n={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,
escape:/<%-([\s\S]+?)%>/g},k=/(.)^/,x={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},y=/\\|'|\r|\n|\t|\u2028|\u2029/g;return function(a,c,e){var f={escape:d,unescape:h,each:l},g;e=b({},e,n);var m=new RegExp([(e.escape||k).source,(e.interpolate||k).source,(e.evaluate||k).source].join("|")+"|$","g"),r=0,t="__p+='";a.replace(m,function(b,d,c,h,e){t+=a.slice(r,e).replace(y,function(a){return"\\"+x[a]});d&&(t+="'+\n((__t=("+d+"))==null?'':_.escape(__t))+\n'");c&&(t+="'+\n((__t=("+
c+"))==null?'':__t)+\n'");h&&(t+="';\n"+h+"\n__p+='");r=e+b.length;return b});t+="';\n";e.variable||(t="with(obj||{}){\n"+t+"}\n");t="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+t+"return __p;\n";try{g=new Function(e.variable||"obj","_",t)}catch(z){throw z.source=t,z;}if(c)return g(c,f);c=function(a){return g.call(this,a,f)};c.source="function("+(e.variable||"obj")+"){\n"+t+"}";return c}});extole.define("user",["utils","params","cookie","configuration",
"dom"],function(c,g,f,l,b){var e=!1,a=c.extend({attributes:{},has:function(a){return void 0!==this.get(a)},get:function(a){return this.attributes[a]||this.cookieAttributes[a]},set:function(a,b){if(!c.inArray(a,["first_name","last_name","email"])||!this.attributes[a]){var e=this.attributes[a];if(b&&e!==b){this.attributes[a]=b;var k=this,g={};c.each(["first_name","last_name","email"],function(a){g[a]=k.get(a)});f("extole_fle",JSON.stringify(g),{path:"/"});this.trigger("change")}}},toJson:function(){return c.extend({isAutoReg:this.isAutoReg()},
this.cookieAttributes,this.attributes)},isAutoReg:function(){return!0===e},setFromShare:function(a){var b=this;c.each({first_name:"firstName",last_name:"lastName",email:"email"},function(c,e){b.set(e,a[c])})},setFromContext:function(a){if(a&&a.params){var b=this,f=this.attributes.email;a=g.rekey(a.params);a=g.split(a).init;c.each(a,function(a,d){b.set(d,a)});f!==this.attributes.email&&(e=!0)}},logout:function(){f("extole_fle",null,{path:"/"});this.attributes=this.cookieAttributes={};this.trigger("logout")},
cookieAttributes:function(){var a;try{a=JSON.parse(f("extole_fle"))||{}}catch(b){return{}}var h={};c.each(["first_name","last_name","email"],function(b){h[b]=a[b]});return h}()},c.events);b.ready(function(){a.setFromContext(l.utils.getSharedVars())});return a});extole.define("utils","utils/api utils/factory utils/string utils/events utils/location utils/insert-script".split(" "),function(c,g,f,l,b,e){return c.extend(c,{factory:g,string:f,events:l,location:b,insertScript:e})});extole.define("utils/api",
["utils/collections","JSON"],function(c,g){var f=c.each,l=c.map,b=c.mapObj,e=c.has,a=c.keys,d=c.values,h=c.invert,n=c.toArray,k=c.inArray,x=c.isArray,y=c.isPlainObject,p=0,q=function(a){return a&&"function"===typeof a&&a.call&&a.apply};"undefined"!=typeof window.console&&(extole.console=extole.console||console);var v;v=function(){var a,b,d,c,h,e=arguments[0]||{},k=1,f=arguments.length,g=!1;"boolean"===typeof e&&(g=e,e=arguments[1]||{},k=2);for("object"===typeof e||q(e)||(e={});k<f;k++)if(a=arguments[k],
null!==a)for(b in a)d=e[b],c=a[b],e!==c&&(g&&c&&(y(c)||(h=x(c)))?(h?(h=!1,d=d&&x(d)?d:[]):d=d&&y(d)?d:{},e[b]=v(g,d,c)):void 0!==c&&(e[b]=c));return e};var w=Array.prototype.slice,m=function(a){if(!extole.suppressLog){var b=w.call(arguments,1);if(extole.console)try{extole.console[a].apply(extole.console,b)}catch(d){for(var c=a.toUpperCase()+" - ",h=0;h<b.length;h++)c+=" "+b[h];extole.console.log(c)}}},u=function(){var a=w.call(arguments);m.apply(this,["log"].concat(a))},r=function(a){u[a]=function(){var b=
w.call(arguments);m.apply(this,[a].concat(b))}};r("error");r("debug");r("info");r("warn");var t=extole.generalReady;extole.generalReady||(t=extole.generalReady=function(a){extole._generalReadyAnonKey||(extole._generalReadyAnonKey=0);var b=extole._generalReadyAnonKey++;a=v(a||{},{readyTest:void 0});t.readies[b]||(t.readies[b]={ready:!1,funcs:[]});var d=function(a){a||t.readies[b].ready?t.readies[b].funcs.push(a):(t.readies[b].ready=!0,u.debug("** generalReady ** "+b+" - set ready"));if(t.readies[b].ready)for(;a=
t.readies[b].funcs.pop();)setTimeout(a,0)};d.unset=function(){t.readies[b].ready=!1};d.set=function(){d()};d.isReady=function(){return t.readies[b].ready};return d},t.readies={});var z=function(a,b){b||(b=a,a="undefined");var d=Error("TYPE: "+a+"  MESSAGE: "+b);d.type=a;return d};return{uniqueId:function(a){var b=++p+"";return a?a+b:b},each:f,map:l,mapObj:b,has:e,keys:a,values:d,invert:h,toArray:n,inArray:k,isEmpty:function(a){if(null===a)return!0;if(x(a)||"string"===typeof a)return 0===a.length;
for(var b in a)if(e(a,b))return!1;return!0},isArray:x,isPlainObject:y,isFunction:q,proxy:function(a,b){var d;a.__proxiedContext===b?d=a:(d=function(){return a.apply(b,arguments)},d.__proxiedContext=b);return d},log:u,generalReady:t,extend:v,defaults:function(a){f(w.call(arguments,1),function(b){if(b)for(var d in b)void 0===a[d]&&(a[d]=b[d])});return a},createObject:Object.create||function(a){var b=function(){};b.prototype=a;return new b},typedError:z,throwError:function(a,b){throw z(a,b);},handleError:function(a,
b,d){d=d||function(){};try{b()}catch(c){if(c.type==a)return d(c),c;throw c;}}}});extole.define("utils/collections",[],function(){var c=Array.prototype.slice,g=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},f=function(a){if(!b(a))return[];var d=[],c;for(c in a)g(a,c)&&d.push(c);return d},l=function(a){for(var b=f(a),d=b.length,c=Array(d),e=0;e<d;e++)c[e]=a[b[e]];return c},b=function(a){if("[object Object]"!==String(a)||a.nodeType||a.window&&a.window==a)return!1;try{if(a.constructor&&
!a.constructor.prototype.hasOwnProperty("isPrototypeOf"))return!1}catch(b){return!1}return!0},e=function(a){return a instanceof Array},a=function(a,b){var d,c;if(a.length===+a.length)for(c=0;c<a.length;c++){if(d=b(a[c],c),!1===d)return!1}else for(c in a)if(a.hasOwnProperty(c)&&(d=b(a[c],c),!1===d))return!1};a.BREAK=!1;var d=function(b,d){var c=[];a(b,function(a,b){var e=d(a,b);void 0!==e&&c.push(e)});return c};return{each:a,map:d,mapObj:function(b,d){var c={};a(b,function(a,b){var e=d(a,b);void 0!==
e&&(e.key&&e.value?c[e.key]=e.value:c[b]=e)});return c},has:g,keys:f,values:l,invert:function(a){for(var b={},d=f(a),c=0,e=d.length;c<e;c++)b[a[d[c]]]=d[c];return b},toArray:function(a){return a?e(a)?c.call(a):a.length===+a.length?d(a,function(a){return a}):l(a):[]},inArray:function(a,b,d){var c;if(b)for(c=b.length,d=d?0>d?Math.max(0,c+d):d:0;d<c;d++)if(d in b&&b[d]===a)return d;return-1},isArray:e,isPlainObject:b}});extole.define("utils/events",["utils/api"],function(c){var g=Array.prototype.slice,
f={on:function(a,d,c){if(!b(this,"on",a,[d,c])||!d)return this;this._events||(this._events={});(this._events[a]||(this._events[a]=[])).push({callback:d,context:c,ctx:c||this});return this},listenTo:function(a,b,e){var f=this._listeningTo||(this._listeningTo={}),k=a._listenId||(a._listenId=c.uniqueId("l"));f[k]=a;e||"object"!==typeof b||(e=this);a.on(b,e,this);return this},stopListening:function(a,b,e){var f=this._listeningTo;if(!f)return this;var k=!b&&!e;e||"object"!==typeof b||(e=this);a&&((f={})[a._listenId]=
a);for(var g in f)a=f[g],a.off(b,e,this),(k||c.isEmpty(a._events))&&delete this._listeningTo[g];return this},off:function(a,d,e){var f,k,g,l,p,q,v,w;if(!this._events||!b(this,"off",a,[d,e]))return this;if(!a&&!d&&!e)return this._events=void 0,this;l=a?[a]:c.keys(this._events);p=0;for(q=l.length;p<q;p++)if(a=l[p],g=this._events[a]){this._events[a]=f=[];if(d||e)for(v=0,w=g.length;v<w;v++)k=g[v],(d&&d!==k.callback&&d!==k.callback._callback||e&&e!==k.context)&&f.push(k);f.length||delete this._events[a]}return this},
trigger:function(a){if(!this._events)return this;var d=g.call(arguments,1);if(!b(this,"trigger",a,d))return this;var c=this._events[a],f=this._events.all;c&&e(c,d);f&&e(f,arguments);return this}},l=/\s+/,b=function(a,b,c,e){if(!c)return!0;if("object"===typeof c){for(var f in c)a[b].apply(a,[f,c[f]].concat(e));return!1}if(l.test(c)){c=c.split(l);f=0;for(var g=c.length;f<g;f++)a[b].apply(a,[c[f]].concat(e));return!1}return!0},e=function(a,b){var c,e=-1,f=a.length,g=b[0],l=b[1],p=b[2];switch(b.length){case 0:for(;++e<
f;)(c=a[e]).callback.call(c.ctx);break;case 1:for(;++e<f;)(c=a[e]).callback.call(c.ctx,g);break;case 2:for(;++e<f;)(c=a[e]).callback.call(c.ctx,g,l);break;case 3:for(;++e<f;)(c=a[e]).callback.call(c.ctx,g,l,p);break;default:for(;++e<f;)(c=a[e]).callback.apply(c.ctx,b)}};f.triggerMethod=function(){function a(a,b,c){return c.toUpperCase()}var b=/(^|:)(\w)/gi;return function(e){var f=this["on"+e.replace(b,a)];c.isFunction(this.trigger)&&this.trigger.apply(this,arguments);if(c.isFunction(f))return f.apply(this,
c.toArray(arguments).slice(1))}}();return f});extole.define("utils/factory",["utils/api"],function(c){var g={};return c.extend(function(f,l){l=l||function(){};var b=function(e,a){var d="boolean"==typeof b.deepExtend?b.deepExtend:!1,h;h=e||{};a||(a=f);if(!0!==h.__created){h=c.createObject(a);g[h]={parent:a};var n=[h,e];d&&n.splice(0,0,!0);c.extend.apply(null,n);l.call(h,h);h.__created=!0}return h};return b},{getInfo:function(c){return g[c]},getProto:function(c){return(c=g[c])&&c.parent}})});extole.define("utils/insert-script",
[],function(){var c="PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,g=function(f,g){g=g||function(){};var b=function(e){var a=f.readyState;if("load"===e.type||a.match(c))f.detachEvent?f.detachEvent("onreadystatechange",b):f.removeEventListener("load",b),g(e)};f.attachEvent?f.attachEvent("onreadystatechange",b):f.addEventListener("load",b,!1)};return function(c,l){var b=document.createElement("script");b.async=!0;g(b,function(){l(null)});b.src=c;document.getElementsByTagName("head")[0].appendChild(b)}});
extole.define("utils/location",["utils/api"],function(c){return{serialize:function(g){var f="";c.each(g,function(c,b){void 0!==b&&void 0!==c&&(f+="&"+encodeURIComponent(b)+"="+encodeURIComponent(String(c)))});0<f.length&&(f="?"+f.slice(1));return f},deserialize:function(g){if(!g)return{};var f={};g=g.substring(1).split("&");for(var l=0;l<g.length;l++){var b=g[l],e=b.substring(0,b.indexOf("=")),b=b.substring(b.indexOf("=")+1);if(e&&b)try{f[e]=decodeURIComponent(b)}catch(a){c.log("Bad Query Param "+
e+" : "+b)}}return f}}});extole.define("utils/string",[],function(){var c=function(c){return c.replace(/(_.)/g,function(c,g){return g.replace("_","").toUpperCase()})};return{toCamelCase:c,toPascalCase:function(g){g=c(g);return g=g.substring(0,1).toUpperCase()+g.substring(1)},trim:function(c){return c.replace(/^\s+/,"").replace(/\s+$/,"")}}});extole.define("validators",[],function(){return{isEmail:function(c){c=String(c);c=c.replace(/^\s+/,"").replace(/\s+$/,"");return c.match(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i)}}});
extole.define("xd-messager-iframe",["utils","xd-messager","configuration","sites","dom"],function(c,g,f,l,b){return{create:function(e){e||(e=c.uniqueId("socket-iframe"));var a=c.generalReady(),d=l.getDefault().program_domain,h=f.get("CLIENT_CONFIG");extole.MEDIA_SERVER.match(/^\/\/([a-zA-Z\.-]+)/);var h=h.client.client_id,n=document.createElement("iframe");n.src=location.protocol+"//"+d+"/xd-arbiter-origin/"+h+"?coreRoot="+encodeURIComponent(location.protocol+extole.MEDIA_SERVER)+"&socketId="+e;c.each({scrolling:"no",
frameborder:"0",allowTransparency:"true",seamless:"seamless"},function(a,c){b.attributes.set(n,c,a)});document.body.appendChild(n);var k=g.create(e);b.events.add(n,"load",function(){k.sendTo=n.contentWindow;var b,c=function(){k.off("ready",c);clearInterval(b);a()};k.on("ready",c);b=setInterval(function(){k.sendMessage("ready?")},250)});return{socket:k,iframe:n,ready:a}}}});extole.define("xd-messager",["utils","JSON"],function(c,g){var f=function(b){window.addEventListener?window.addEventListener("message",
b,!1):window.attachEvent("onmessage",b)},l={listen:function(){var b=this;this._listener=function(c){c=c.data;var a=c.split("-"),d=a[0],h=a[1],a=a[2];if(d!=b.id)return!1;if(a)try{var f=c.substring(d.length+1+h.length+1),a=g.parse(f)}catch(k){}b.trigger(h,a)};f(this._listener)},stopListening:function(){if(this._listener){var b=this._listener;window.removeEventListener?window.removeEventListener("message",b):window.detachEvent("onmessage",b)}},destroy:function(){this.stopListening()},sendMessage:function(b,
c){var a;a=this.id+"-"+b;c&&(a+="-"+g.stringify(c));this.sendTo.postMessage(a,"*")}};return{create:function(b,e){e||(e={});b||(b=c.uniqueId("socket_"));var a=c.createObject(l);c.extend(a,{id:b,options:e,sendTo:e.sendTo||window.parent},c.events);a.listen();return a}}});extole.define("zones",["zones/zone","zones/default-content","zones/resources","zones/requester"],function(c,g,f,l){return{zone:c,defaultContent:g,resources:f,requester:l}});extole.define("zones/creative-placement",["utils","dom"],function(c,
g){var f=function(b,a){var c=b;"none"!==a&&(c=document.createElement("span"));return c},l=function(b,a,c,h){var f=arguments,k=a.parentNode;if(!k)return g.ready(function(){k||(document.body.appendChild(a),l.apply(null,f))}),!1;"replace"==c?(k.insertBefore(b,a),k.removeChild(a)):"before"==c?k.insertBefore(b,a):"after"==c?a.nextSibling?k.insertBefore(b,a.nextSibling):k.appendChild(b):"inside"==c&&a.appendChild(b);h(null)},b=function(b){b=c.extend({insertPosition:void 0,referenceElement:void 0},b||{});
var a=b.insertPosition;b=b.referenceElement;a||(a="before","*"==b?a="inside":b&&(a="none"));return a};return{renderElement:function(c,a){var d=c.getData(),d=b({insertPosition:d.insert_position,referenceElement:d.reference_element}),h=c.element,g=f(h,d);l(g,h,d,function(){a(null,g)});return g},getInsertPosition:b}});extole.define("zones/default-content",["configuration","utils"],function(c,g){var f={},l={none:function(){return document.createDocumentFragment()},size:function(b){var c=document.createDocumentFragment(),
a=document.createElement("span"),d=["height","width"],h,f=b.default_types.size;a.style.display="block";for(var g=0;g<d.length;g++)b=d[g],h=f[b]+"px",a.style[b]=h;c.appendChild(a);return c},html:function(b){var c=document.createDocumentFragment(),a=document.createElement("div");for(a.innerHTML=b.default_types.html;0<a.childNodes.length;)c.appendChild(a.childNodes[0]);return c}};return{shouldShow:function(b){var e=c.get("CLIENT_CONFIG");b=b.name.toLowerCase();e=e.zones[b];return!0===c.get("SYSTEM_DOWN")?
(f[b]="the system is off",!0):!0===c.get("CLIENT_DOWN")?(f[b]="the client is disabled",!0):e&&void 0!==e.disabled&&!0===e.disabled?(f[b]="the zone is disabled",!0):c.zones.blacklisted(b)?(f[b]="the zone is blacklisted",!0):!1},getElement:function(b){var e=c.get("CLIENT_CONFIG");b=b.name.toLowerCase();var e=e.zones[b],a=f[b];g.log("Showing default content for "+b+(a?" because "+a:""));if(!e)return g.log("There was no config for the given zone, so I couldn't show the default content."),document.createDocumentFragment();
b="none";e.default_type&&(b=e.default_type);e.default_types&&e.default_types[b]&&!e.reference_element||(b="none");return l[b](e)}}});extole.define("zones/requester","JSON utils dom configuration page-scanner zones/zone campaigns".split(" "),function(c,g,f,l,b,e,a){function d(a){function d(c,e){e=e||function(){};var f;f=c.reference_element&&"*"==c.reference_element?"body":c.reference_element?c.reference_element:!1;if(!f)return e(null,a);b.whenYouFind(f).thenCall(function(a){e(null,a)}).andRemove()}
this.prepare=function(b){b=b||function(){};var e;try{e=c.parse(a.innerHTML)}catch(f){return b(Error("element has bad JSON, can't make zone. html: "+a.innerHTML))}var m=(e.zone||"default").toLowerCase(),p=l.get("CLIENT_CONFIG").zones[m]||{},q=g.extend(!0,{},p,e);d(q,function(a,c){if(a)return b(a);b(null,m,{id:p.id,element:c,data:q})})}}return new function(){function c(){r||b.whenYouFind('script[type="extole/widget"]').thenCall(function(a){a.hasBeenUsed||(a.hasBeenUsed=!0,(new d(a)).prepare(function(a,
b,c){if(a)return g.log("couldn't prepare page request "+a.message);k(b,c)}))});r=!0;b.findAllTheThings()}function l(){if(!m){var a=g.location.deserialize(location.search),b=a.extole_zone_name||a.xtl_zone_name,c=a.extole_campaign_id||a.xtl_campaign_id;b?(m=!0,f.ready(function(){var a="extole-"+b+"-zone",d=document.getElementById(a);d||(d=document.createElement("div"),d.id=a,document.body.appendChild(d));k(b,{fromUri:!0,element:d,data:{campaign:c,insert_position:"none",parameters:{source:g.location.deserialize(location.search).extole_source}}})})):
g.log("uri zone has no zone name")}}function k(b,c){c=c||{};var d=e(g.extend({name:b,type:b},c));a.renderZone(d)}var m=!1,r=!1;this.start=function(){c();l()};this.request=k}});extole.define("zones/resources",["utils","extole-creatives:/shared/js/legacy-resource-selector.js"],function(c,g){var f=function(b){return(new Function("legacyResourceSelector",b))(g)},l=function(b,a){var c=f(b),h="";if(!c)return"";"::content::"==a?h=c.textContent||c.innerText||c.innerHTML:"string"==typeof a&&(h=c[a]?c[a]:c.getAttribute?
c.getAttribute(a):"");return h},b=function(b){var a="",d=c.location.deserialize(location.search);"element"==b.resource_type?a=l(b.selector,b.attr):"query_param"==b.resource_type&&(a=d[b.param_name]);return a};return{getElementFromSelector:f,getValueFromSelector:l,getValueFromRule:b,getValuesFromRules:function(c){c=c||[];var a={},d;for(d in c)c.hasOwnProperty(d)&&(a[d]=b(c[d]));return a},getQueryParameterByName:function(b){for(var a=location.search.substring(1).split("&"),c=0;c<a.length;c++){var h=
a[c].split("=");if(decodeURIComponent(h[0])==b)return decodeURIComponent(h[1])}return""}}});extole.define("zones/zone",["utils","configuration","zones/default-content","zones/creative-placement"],function(c,g,f,l){var b=[],e={elementReady:function(a){var b=this;l.renderElement(this,function(c,e){b.element=e;a&&a(c,e)})},shouldShowDefaultContent:function(){return f.shouldShow(this)},renderDefaultContent:function(){var a=f.getElement(this),b=this.element;b||c.throwError("zone","Tried to render default content without an element");
c.each(a.childNodes,function(a){a&&b.appendChild(a)})},getConfig:function(){var a=this.getName();return g.get("CLIENT_CONFIG").zones[a]},getInsertPosition:function(){return l.getInsertPosition({insertPosition:this.data.insert_position,referenceElement:this.data.reference_element})},getData:function(){return this.data},getType:function(){return this.type||"cta"},getName:function(){return this.name&&this.name.toLowerCase()},getParameters:function(){return c.extend({},this.data.parameters,this.data.params)},
removeCampaignReferences:function(){this.data.parameters&&delete this.data.parameters.campaign_id;this.data.params&&delete this.data.params.campaign_id;this.campaign&&delete this.campaign},destroy:function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);for(var a=0;a<b.length&&b[a]!=this;a++);b.splice(a,1)}},a=function(a){var h;h=a||{};!0!==h.__created&&(h=c.createObject(e),c.extend(h,a),b.push(h),h.__created=!0);return h};c.extend(a,{getZones:function(){return b}});
return a})})();extole.define("https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/ajax.js",["ajax"],function(m){return m});extole.define("https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/collection.js",["utils"],function(m){return{each:m.each,map:function(r,c){return m.isPlainObject(r)?m.mapObj(r,c):m.map(r,c)},merge:m.extend}});
extole.define("https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/uri.js",["utils"],function(m){return{serialize:m.location.serialize,deserialize:m.location.deserialize,objectToDotNotation:function(m){function c(f,l){for(var b in f){var e=f[b],a=l?l+"."+b:b;e&&"object"===typeof e?c(e,a):g[a]=e}}var g={};c(m);return g},dotNotationToObject:function(m){var c={},g;for(g in m){for(var f=c,l=g.split("."),b=l.pop();l.length;)var e=l.shift(),f=f[e]=f[e]||{};f[b]=m[g]}return c},
decodeComponent:function(m){try{return decodeURIComponent(m)}catch(c){return m}},encodeComponent:function(m){return encodeURIComponent(m)}}});
extole.define("https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/dom.js",["dom"],function(m){var r={},c=function(c,b){function e(){b();f.removeEventListener(a,"load",e)}if(r[c])return b();r[c]=!0;var a=document.createElement("link");f.setAttribute(a,"rel","stylesheet");f.setAttribute(a,"href",c);f.append(f.query("head")[0],a);f.addEventListener(a,"load",e)},g=function(f,b){0===f.length?b():c(f[0],function(){g(f.slice(1),b)})},f={addEventListener:m.events.add,
removeEventListener:m.events.remove,triggerEvent:m.events.trigger,getAttribute:m.attributes.get,setAttribute:m.attributes.set,addClass:m.attributes.addClass,removeClass:m.attributes.removeClass,getClassNames:function(){return Object.keys(m.attributes.getClassNames.apply(null,arguments))},prepend:m.prepend,append:m.append,query:m.query,queryFirst:function(c,b){return m.query(c,b)[0]},injectStylesheet:c,injectStylesheets:g};return f});
extole.define("https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/event-bus.js",["utils"],function(m){var r=Array.prototype.slice;return{create:function(){var c=m.extend({},m.events);c.once=function(g,f,l){var b=function(){var e=r.call(arguments);f.apply(this,e);c.off(g,b,l)};c.on(g,b,l);return c};return c}}});extole.define("https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/JSON.js",["JSON"],function(m){return m});
extole.define("https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/type.js",[],function(){return{isPlainObject:function(m){return"[object Object]"===Object.prototype.toString.call(m)},isPlainFunction:function(m){return"[object Function]"===Object.prototype.toString.call(m)},isArray:function(m){return"[object Array]"===Object.prototype.toString.call(m)}}});
extole.define("https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/user-service.js","https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/collection.js https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/uri.js https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/logger.js https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/event-bus.js https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/cookie.js https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/api.js".split(" "),
function(m,r,c,g,f,l){function b(){function a(){function b(a){var c=location.pathname.split("/");c.shift();c.pop();1!==c.length&&m.each(c,function(b,d){var e="/"+c.slice(0,d+1).join("/");f(a,"",{expires:-1,path:e})})}this.get=function(a){return f(a)};this.set=function(a,c){extole.COOKIES_DISABLED||(b(a),f(a,c,{expires:1825,path:"/"}))};this.remove=function(a){f(a,"",{expires:-1,path:"/"});b(a)}}function b(){(function(){var a="test"+(new Date).getTime();try{localStorage.setItem(a,a),localStorage.removeItem(a)}catch(b){throw Error("Local storage not supported");
}})();this.get=function(a){return window.localStorage.getItem(a)};this.set=function(a,b){window.localStorage.setItem(a,b)};this.remove=function(a){window.localStorage.removeItem(a)}}var e=[];e.push(new function(){var a={};this.get=function(b){return a[b]};this.set=function(b,c){a[b]=c};this.remove=function(b){delete a[b]}});extole.COOKIES_DISABLED||e.push(new a);if(extole.LOCAL_STORAGE_ENABLED)try{e.push(new b)}catch(g){c.info("Local Storage not supported in current browser")}this.get=function(){for(var a,
b=0;b<e.length;b++){a=e[b];var c=a.get("extole_access_token");if("string"===typeof c&&"undefined"!==c&&"null"!==c&&c.length)return a.get("extole_access_token")}};this.set=function(a){m.each(e,function(b){b.set("extole_access_token",a)})};this.remove=function(){m.each(e,function(a){a.remove("extole_access_token")})}}function e(){function a(){var b=g.get();return b?b:""}function c(a){m.merge(f,a)}function e(){m.each(f,function(a,b){f[b]=void 0})}var f={},g=new b,y={getAccessToken:function(){return f.access_token},
getId:function(){return f.id},getEmail:function(){return f.email},getFirstName:function(){return f.first_name},getLastName:function(){return f.last_name},getParameters:function(){return f.parameters},getMe:function(){return{id:f.id,email:f.email,first_name:f.first_name,last_name:f.last_name,profile_picture_url:f.profile_picture_url,partner_user_id:f.partner_user_id,parameters:f.parameters}},getCapabilities:function(){return Array.isArray(f.capabilities)?f.capabilities.slice():[]},getScopes:function(){return Array.isArray(f.scopes)?
f.scopes.slice():[]}};m.merge(this,y);(function(){var a=r.deserialize(window.location.search).extole_access_token;a&&g.set(a)})();this.asReadOnly=function(){return y};this.fetchAccessToken=function(b){var e=a();l.get("/token?access_token="+e,function(a,d){if(a)return b(a);g.set(d.access_token);c(d);b(null)})};this.deleteAccessToken=function(b){var c=a();e();g.remove();l.del("/token?access_token="+c,function(a,c){b(a,c)})};this.fetchAttributes=function(b){var e=a();l.get("/me?access_token="+e,function(a,
d){if(a)return b(a);c(d);b(null,d)})};this.saveAttributes=function(b,e){b={email:b.email,first_name:b.first_name,last_name:b.last_name,profile_picture_url:b.profile_picture_url,partner_user_id:b.partner_user_id};var f=a();l.post("/me?access_token="+f,b,function(a,d){if(a)return e(a);c(b);e(null)})};this.saveParameters=function(b,e,f){e="string"!==typeof e?"PRIVATE":"PRIVATE"===e.toUpperCase()?"PRIVATE":"PUBLIC";f=f||function(){};var g=a(),k={type:e,parameters:b};l.post("/me/parameters?access_token="+
g,k,function(a,b){if(a)return f(a);c({parameters:k});f(null)})};this.fetchParameters=function(b){var e=a();l.get("/me/parameters?access_token="+e,function(a,d){if(a)return b(a);c({parameters:d});b(null,d)})};this.upgradeAccessToken=function(b,e){var f="/token/"+a()+"/upgrade";l.post(f,{extole_secret:b},function(a,b){a||c(b);e(a)})};this.fetchAdvocates=function(b){var c=a();l.get("/me/advocates?access_token="+c,function(a,c){if(a)return b(a);b(null,c)})}}function a(){var a=0,b=[],c=this;this.push=
function(a){b.push(a);this.next()};this.next=function(){for(;1>a&&b.length;)b.shift()(function(){a--;c.next()}),a++}}return new function(){function b(a){l.push(function(b){f(function(c){a(c,b)})})}function f(a){function b(a){k.fetchAccessToken(function(b){function c(a){k.deleteAccessToken(function(b){k.fetchAccessToken(function(b){a(b)})})}function d(a){k.fetchAttributes(function(b){b?a(b):(a(null),m.events.trigger("login",k.asReadOnly()))})}function e(a){var b=y();b?k.upgradeAccessToken(b,function(b){a(null)}):
setTimeout(function(){a(null)},0)}b?"invalid_access_token"===b.code?c(function(b){b||m.events.trigger("login",k.asReadOnly());a(b)}):a(b):d(function(b){b?a(b):e(function(){m.events.trigger("login",k.asReadOnly());a(null)})})})}Boolean(k.getAccessToken())?a(null):b(a)}var l=new a,k=new e,m=this;this.events=g.create();this.getUser=function(a){if(!a)throw Error("a callback function is a required argument");b(function(b,c){b?a(b):a(null,k.asReadOnly());c()})};this.updateMe=function(a,c){c=c||function(){};
b(function(b,d){function e(a,b){c(a,b);d()}b?e(b):a.email||a.first_name||a.last_name||a.profile_picture_url||a.partner_user_id?k.saveAttributes(a,function(a){a?e(a):e(null,k.asReadOnly())}):e(null,k.asReadOnly())})};this.updateProfile=function(a,b){c.warn("userService.updateProfile is deprecated");return this.updateMe(a,b)};this.updateParameters=function(a,c,e){"function"!==typeof c||e||(e=c,c=void 0);e=e||function(){};b(function(b,d){b?(e(b,void 0),d()):k.saveParameters(a,c,function(a){a?e(a,void 0):
(a=k.asReadOnly(),e(null,a));d()})})};this.fetchParameters=function(a){a=a||function(){};b(function(b,c){b?(a(b,void 0),c()):k.fetchParameters(function(b,d){b?a(b,void 0):a(null,d);c()})})};this.fetchAdvocates=function(a){a=a||function(){};b(function(b,c){b?(a(b,void 0),c()):k.fetchAdvocates(function(b,d){b?a(b,void 0):a(null,d);c()})})};this.logout=function(a){a=a||function(){};b(function(b,c){b?(a(b),c()):k.deleteAccessToken(function(b){a(null);m.events.trigger("logout",k.asReadOnly());c();m.getUser(function(){})})})};
var y=function(){var a=r.deserialize(window.location.search).extole_secret;return function(){var b=a;b&&(a=null);return b}}()}});
extole.define("https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/api.js",["https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/collection.js","https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/logger.js","sites","https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/ajax.js","https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/JSON.js"],
function(m,r,c,g,f){function l(a){a=a.getDefault();if(!a||!a.program_domain)throw new b("No program domain is configured for hostname: "+location.hostname,"SITE_CONFIGURATION_ERROR");return a.program_domain}function b(a,b){var c=Error.call(this,a);this.name="ExtoleError";this.message=c.message;this.stack=c.stack;this.code=b}function e(){var a,b,c,e;this.withRequestSummary=function(a){c=a;return this};this.withResponseSummary=function(a){e=a;return this};this.asDebug=function(){b="Completed api request";
a="debug";return this};this.asError=function(){b="Failed api request";a="error";return this};this.log=function(){if(-1===c.url.indexOf(r.LOGGING_ENDPOINT))r[a](b,{request:c,response:e})}}b.prototype=Error();b.prototype.constructor=b;return new function(){function a(a,c,k,l){3===arguments.length&&(l=k,k={});var r="https://"+b+"/api/v4"+c;m.merge({},k);g({timeout:5E3,url:r,type:a,complete:function(a){var b=null;try{a=f.parse(a)}catch(c){a=null,b=Error("Couldn't parse as JSON response from request, response: "+
a)}l&&l(b,a);a=m.merge({},a);a.timestamp=String((new Date).getTime());(new e).withRequestSummary(p).withResponseSummary(a).asDebug().log()},error:function(a,b){var c;try{c=f.parse(this.response)}catch(d){c={statusText:this.statusText,status:b}}l&&l(c);c=m.merge({},c);c.timestamp=String((new Date).getTime());(new e).withRequestSummary(p).withResponseSummary(c).asError().log()},data:k,headers:{"Content-Type":"application/json"},xhrFields:{withCredentials:!0}});var p={url:r,type:a,data:k,timestamp:String((new Date).getTime())}}
var b=l(c);this.get=function(b,c){a("get",b,c)};this.post=function(b,c,d){a("post",b,c,d)};this.del=function(b,c){a("delete",b,c)};this["delete"]=this.del}});extole.define("https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/shared/js/user-service.js",[],function(){var m=this.async();extole.require(["https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/user-service.js"],function(r){m(r)})});
extole.define("https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/shared/js/api.js",[],function(){var m=this.async();extole.require(["https://origin.extole.io/type=core:clientId=160484:coreAssetsVersion=1481046984915/common/api.js"],function(r){m(r)})});